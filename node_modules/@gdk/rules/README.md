# @gdk/tools

This module include:

- @gdk/commit
- @gdk/eslint-config
- @gdk/prettier-config
- @gdk/tsconfig

## How to use?

### Requirements

This package needs node.js version 14.17.0 or above.

### Install

With `npm`:

```sh
npm i -D @gdk/rules
```

With `yarn`:

```sh
yarn add -D @gdk/rules
```

### Configure

Create `.eslintrc.js`, add `@gdk/eslint-config/recommended` in `extends` and configure the `parserOptions`:

```js
/** @type {import('eslint').Linter.Config} */
module.exports = {
  root: true,
  extends: ["@gdk/eslint-config/recommended"],
  ignorePatterns: ["build"],
  parserOptions: {
    tsconfigRootDir: __dirname,
    project: ["./tsconfig.json"],
    createDefaultProgram: true,
  },
};
```

Complete the `ignorePatterns` array with all files/folder that you want to ignore.

Do the same with `.prettierrc.js`:

```js
/** @type {import('prettier').Config} */
module.exports = require("@gdk/prettier-config");
```

Be careful not to have multiple configuration files as they can conflict.
You should delete all prior `.prettierrc.*`, `.prettier.config.*`, `.eslintrc.*`, `.eslintrc.config.*` and check if there is no prettier/eslint field in your `package.json`.
You can also remove `.editorconfig` as it is handle by the prettier extension (see below).

### Scripts

In `package.json`, add the following scripts commands:

```json
{
  "scripts": {
    "format": "prettier . --write",
    "lint": "eslint ."
  }
}
```

Use `npm run lint -- --fix` or `yarn lint --fix` to automatically fix problems.
Use `npx commit` or `yarn commit` to use Commitizen configured by `@gdk/commit`.

### Continuous integration

All rules trigger warnings.
To force the CI to fail, you need to add the `--max-warnings=0` argument in the script.
For instance, with `.gitlab-ci.yml`, you can have

```yml
lint:
  script:
    - npm run lint -- --max-warnings=0
```

### Disable rules

Eslint: <https://eslint.org/docs/latest/user-guide/configuring/rules#disabling-rules>

```ts
/* eslint-disable */
// eslint is disable here
/* eslint-enable */
```

Prettier: <https://prettier.io/docs/en/ignore.html>

```ts
// prettier-ignore
{
  // this scope is ignored y prettier
}
```

### Ignore files

- `.eslintignore` for eslint: <https://eslint.org/docs/latest/user-guide/configuring/ignoring-code#the-eslintignore-file> or complete `ignorePatterns` in `.eslintrc.js`.
- `.prettierignore` for prettier: <https://prettier.io/docs/en/ignore.html#ignoring-files-prettierignore>.

`.prettierignore` example:

```sh
*/*.min.js
package-lock.json
build
```

Ignore patterns behave according to the `.gitignore` [specification](https://git-scm.com/docs/gitignore).

## VS Code

### Extensions

These VS Code extensions are highly recommended:

- [ESLint](vscode:extension/dbaeumer.vscode-eslint) for code linting
- [Prettier](vscode:extension/esbenp.prettier-vscode) for code formatting

### Settings

The command `Preferences: Open Settings (JSON)` will open your VS Code settings as a `json` file.
These settings will format on save. Only `editor.defaultFormatter` is mandatory.

```json
{
  "editor.codeActionsOnSave": {
    "source.fixAll": true
  },
  "editor.defaultFormatter": "esbenp.prettier-vscode",
  "editor.formatOnSave": true
}
```

### Keybindings

The command `Preferences: Keyboard Shortcuts (JSON)` will open your VS Code keyboard shortcuts as a `json` file.
Quick fix typescript files and format other files with one keybinding:

```json
[
  {
    "key": "ctrl+shift+i",
    "command": "eslint.executeAutofix",
    "when": "editorLangId =~ /javascript|javascriptreact|typescript|typescriptreact/"
  },
  {
    "key": "ctrl+shift+i",
    "command": "editor.action.formatDocument",
    "when": "editorLangId != javascript && editorLangId != javascriptreact && editorLangId != typescript && editorLangId != typescriptreact"
  }
]
```
