/*! gamekit 3.6.4 Wed May 31 2023 13:11:04 GMT+0000 (Coordinated Universal Time) */
module.exports =
/******/ (function(modules) { // webpackBootstrap
/******/ 	// install a JSONP callback for chunk loading
/******/ 	function webpackJsonpCallback(data) {
/******/ 		var chunkIds = data[0];
/******/ 		var moreModules = data[1];
/******/
/******/
/******/ 		// add "moreModules" to the modules object,
/******/ 		// then flag all "chunkIds" as loaded and fire callback
/******/ 		var moduleId, chunkId, i = 0, resolves = [];
/******/ 		for(;i < chunkIds.length; i++) {
/******/ 			chunkId = chunkIds[i];
/******/ 			if(Object.prototype.hasOwnProperty.call(installedChunks, chunkId) && installedChunks[chunkId]) {
/******/ 				resolves.push(installedChunks[chunkId][0]);
/******/ 			}
/******/ 			installedChunks[chunkId] = 0;
/******/ 		}
/******/ 		for(moduleId in moreModules) {
/******/ 			if(Object.prototype.hasOwnProperty.call(moreModules, moduleId)) {
/******/ 				modules[moduleId] = moreModules[moduleId];
/******/ 			}
/******/ 		}
/******/ 		if(parentJsonpFunction) parentJsonpFunction(data);
/******/
/******/ 		while(resolves.length) {
/******/ 			resolves.shift()();
/******/ 		}
/******/
/******/ 	};
/******/
/******/
/******/ 	// The module cache
/******/ 	var installedModules = {};
/******/
/******/ 	// object to store loaded and loading chunks
/******/ 	// undefined = chunk not loaded, null = chunk preloaded/prefetched
/******/ 	// Promise = chunk loading, 0 = chunk loaded
/******/ 	var installedChunks = {
/******/ 		"bundle": 0
/******/ 	};
/******/
/******/
/******/
/******/ 	// script path function
/******/ 	function jsonpScriptSrc(chunkId) {
/******/ 		return __webpack_require__.p + "gamekit." + ({"ds":"ds","fdj":"fdj","fdj_wizz":"fdj_wizz","fgs":"fgs","fgs_ds":"fgs_ds","fgs_ees":"fgs_ees","fgs_nt":"fgs_nt","fgs_szk":"fgs_szk","lor":"lor","nt":"nt","svs":"svs","vks":"vks"}[chunkId]||chunkId) + ".js"
/******/ 	}
/******/
/******/ 	// The require function
/******/ 	function __webpack_require__(moduleId) {
/******/
/******/ 		// Check if module is in cache
/******/ 		if(installedModules[moduleId]) {
/******/ 			return installedModules[moduleId].exports;
/******/ 		}
/******/ 		// Create a new module (and put it into the cache)
/******/ 		var module = installedModules[moduleId] = {
/******/ 			i: moduleId,
/******/ 			l: false,
/******/ 			exports: {}
/******/ 		};
/******/
/******/ 		// Execute the module function
/******/ 		modules[moduleId].call(module.exports, module, module.exports, __webpack_require__);
/******/
/******/ 		// Flag the module as loaded
/******/ 		module.l = true;
/******/
/******/ 		// Return the exports of the module
/******/ 		return module.exports;
/******/ 	}
/******/
/******/ 	// This file contains only the entry chunk.
/******/ 	// The chunk loading function for additional chunks
/******/ 	__webpack_require__.e = function requireEnsure(chunkId) {
/******/ 		var promises = [];
/******/
/******/
/******/ 		// JSONP chunk loading for javascript
/******/
/******/ 		var installedChunkData = installedChunks[chunkId];
/******/ 		if(installedChunkData !== 0) { // 0 means "already installed".
/******/
/******/ 			// a Promise means "currently loading".
/******/ 			if(installedChunkData) {
/******/ 				promises.push(installedChunkData[2]);
/******/ 			} else {
/******/ 				// setup Promise in chunk cache
/******/ 				var promise = new Promise(function(resolve, reject) {
/******/ 					installedChunkData = installedChunks[chunkId] = [resolve, reject];
/******/ 				});
/******/ 				promises.push(installedChunkData[2] = promise);
/******/
/******/ 				// start chunk loading
/******/ 				var script = document.createElement('script');
/******/ 				var onScriptComplete;
/******/
/******/ 				script.charset = 'utf-8';
/******/ 				script.timeout = 120;
/******/ 				if (__webpack_require__.nc) {
/******/ 					script.setAttribute("nonce", __webpack_require__.nc);
/******/ 				}
/******/ 				script.src = jsonpScriptSrc(chunkId);
/******/
/******/ 				// create error before stack unwound to get useful stacktrace later
/******/ 				var error = new Error();
/******/ 				onScriptComplete = function (event) {
/******/ 					// avoid mem leaks in IE.
/******/ 					script.onerror = script.onload = null;
/******/ 					clearTimeout(timeout);
/******/ 					var chunk = installedChunks[chunkId];
/******/ 					if(chunk !== 0) {
/******/ 						if(chunk) {
/******/ 							var errorType = event && (event.type === 'load' ? 'missing' : event.type);
/******/ 							var realSrc = event && event.target && event.target.src;
/******/ 							error.message = 'Loading chunk ' + chunkId + ' failed.\n(' + errorType + ': ' + realSrc + ')';
/******/ 							error.name = 'ChunkLoadError';
/******/ 							error.type = errorType;
/******/ 							error.request = realSrc;
/******/ 							chunk[1](error);
/******/ 						}
/******/ 						installedChunks[chunkId] = undefined;
/******/ 					}
/******/ 				};
/******/ 				var timeout = setTimeout(function(){
/******/ 					onScriptComplete({ type: 'timeout', target: script });
/******/ 				}, 120000);
/******/ 				script.onerror = script.onload = onScriptComplete;
/******/ 				document.head.appendChild(script);
/******/ 			}
/******/ 		}
/******/ 		return Promise.all(promises);
/******/ 	};
/******/
/******/ 	// expose the modules object (__webpack_modules__)
/******/ 	__webpack_require__.m = modules;
/******/
/******/ 	// expose the module cache
/******/ 	__webpack_require__.c = installedModules;
/******/
/******/ 	// define getter function for harmony exports
/******/ 	__webpack_require__.d = function(exports, name, getter) {
/******/ 		if(!__webpack_require__.o(exports, name)) {
/******/ 			Object.defineProperty(exports, name, { enumerable: true, get: getter });
/******/ 		}
/******/ 	};
/******/
/******/ 	// define __esModule on exports
/******/ 	__webpack_require__.r = function(exports) {
/******/ 		if(typeof Symbol !== 'undefined' && Symbol.toStringTag) {
/******/ 			Object.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });
/******/ 		}
/******/ 		Object.defineProperty(exports, '__esModule', { value: true });
/******/ 	};
/******/
/******/ 	// create a fake namespace object
/******/ 	// mode & 1: value is a module id, require it
/******/ 	// mode & 2: merge all properties of value into the ns
/******/ 	// mode & 4: return value when already ns object
/******/ 	// mode & 8|1: behave like require
/******/ 	__webpack_require__.t = function(value, mode) {
/******/ 		if(mode & 1) value = __webpack_require__(value);
/******/ 		if(mode & 8) return value;
/******/ 		if((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;
/******/ 		var ns = Object.create(null);
/******/ 		__webpack_require__.r(ns);
/******/ 		Object.defineProperty(ns, 'default', { enumerable: true, value: value });
/******/ 		if(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));
/******/ 		return ns;
/******/ 	};
/******/
/******/ 	// getDefaultExport function for compatibility with non-harmony modules
/******/ 	__webpack_require__.n = function(module) {
/******/ 		var getter = module && module.__esModule ?
/******/ 			function getDefault() { return module['default']; } :
/******/ 			function getModuleExports() { return module; };
/******/ 		__webpack_require__.d(getter, 'a', getter);
/******/ 		return getter;
/******/ 	};
/******/
/******/ 	// Object.prototype.hasOwnProperty.call
/******/ 	__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };
/******/
/******/ 	// __webpack_public_path__
/******/ 	__webpack_require__.p = "";
/******/
/******/ 	// on error function for async loading
/******/ 	__webpack_require__.oe = function(err) { console.error(err); throw err; };
/******/
/******/ 	var jsonpArray = window["webpackJsonp_gdk_gamekit"] = window["webpackJsonp_gdk_gamekit"] || [];
/******/ 	var oldJsonpFunction = jsonpArray.push.bind(jsonpArray);
/******/ 	jsonpArray.push = webpackJsonpCallback;
/******/ 	jsonpArray = jsonpArray.slice();
/******/ 	for(var i = 0; i < jsonpArray.length; i++) webpackJsonpCallback(jsonpArray[i]);
/******/ 	var parentJsonpFunction = oldJsonpFunction;
/******/
/******/
/******/ 	// Load entry module and return exports
/******/ 	return __webpack_require__(__webpack_require__.s = "./src/index.ts");
/******/ })
/************************************************************************/
/******/ ({

/***/ "../../node_modules/css-loader/index.js!../../node_modules/less-loader/dist/cjs.js!./src/com/popin/style.less":
/*!*******************************************************************************************************************************************!*\
  !*** /builds/gdk/framework/node_modules/css-loader!/builds/gdk/framework/node_modules/less-loader/dist/cjs.js!./src/com/popin/style.less ***!
  \*******************************************************************************************************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

exports = module.exports = __webpack_require__(/*! ../../../../../node_modules/css-loader/lib/css-base.js */ "../../node_modules/css-loader/lib/css-base.js")(false);
// imports


// module
exports.push([module.i, ".gdk-popin-background {\n  position: fixed;\n  left: 0;\n  top: 0;\n  right: 0;\n  bottom: 0;\n  cursor: default;\n  opacity: 0;\n  z-index: 999999;\n  transition-duration: 0.15s;\n  transition-timing-function: ease-in-out;\n  transition-property: opacity;\n}\n.gdk-popin-background.gdk-popin-background-overlay {\n  background-color: rgba(0, 0, 0, 0.6);\n}\n.gdk-popin-background.show {\n  opacity: 1;\n}\n@media screen and (orientation: portrait) {\n  .gdk-popin-background .gdk-popin.landscape {\n    transform: translate(-50%, -50%) rotate(-90deg);\n  }\n}\n@media screen and (orientation: landscape) {\n  .gdk-popin-background .gdk-popin.portrait {\n    transform: translate(-50%, -50%) rotate(-90deg);\n  }\n}\n.gdk-popin-background .gdk-popin {\n  background-color: whitesmoke;\n  box-shadow: 0 0 5px rgba(51, 51, 51, 0.5);\n  border-radius: 15px;\n  color: black;\n  font-family: Helvetica;\n  text-align: center;\n  display: inline-block;\n  left: 50%;\n  position: fixed;\n  top: 50%;\n  z-index: 10;\n  min-width: 230px;\n  max-width: 450px;\n  -webkit-transform: translate(-50%, -50%);\n  -ms-transform: translate(-50%, -50%);\n  transform: translate(-50%, -50%);\n  padding: 3px 15px;\n}\n.gdk-popin-background .gdk-popin > div {\n  padding: 5px 20px;\n}\n.gdk-popin-background .gdk-popin .gdk-popin-close {\n  position: absolute;\n  right: 12px;\n  top: 10px;\n  width: 8px;\n  height: 8px;\n  opacity: 1;\n}\n.gdk-popin-background .gdk-popin .gdk-popin-close:hover {\n  opacity: 0.6;\n}\n.gdk-popin-background .gdk-popin .gdk-popin-close:before,\n.gdk-popin-background .gdk-popin .gdk-popin-close:after {\n  position: absolute;\n  right: 3px;\n  content: \" \";\n  height: 14px;\n  width: 3px;\n  background-color: #1187c7;\n}\n.gdk-popin-background .gdk-popin .gdk-popin-close:before {\n  transform: rotate(45deg);\n}\n.gdk-popin-background .gdk-popin .gdk-popin-close:after {\n  transform: rotate(-45deg);\n}\n.gdk-popin-background .gdk-popin .gdk-popin-title {\n  font-weight: bold;\n  font-size: 1em;\n  color: #ec0b5e;\n}\n.gdk-popin-background .gdk-popin .gdk-popin-text {\n  font-size: 0.9em;\n}\n.gdk-popin-background .gdk-popin .gdk-popin-buttons {\n  font-size: 0;\n  margin-top: 15px;\n  padding: 0;\n}\n.gdk-popin-background .gdk-popin .gdk-popin-buttons .gdk-popin-button-wrapper {\n  font-size: 1rem;\n  display: inline-block;\n}\n.gdk-popin-background .gdk-popin .gdk-popin-buttons .gdk-popin-button-wrapper .gdk-popin-button {\n  line-height: 1em;\n  padding: 8px;\n  margin: 0 16px 10px;\n  cursor: pointer;\n  font-size: 0.8em;\n  font-family: inherit;\n  font-weight: bold;\n  text-transform: uppercase;\n  user-select: none;\n  border-radius: 15px;\n  background: #1187c7;\n  color: white;\n}\n.gdk-popin-background .gdk-popin .gdk-popin-buttons .gdk-popin-button-wrapper .gdk-popin-button:hover,\n.gdk-popin-background .gdk-popin .gdk-popin-buttons .gdk-popin-button-wrapper .gdk-popin-button:active,\n.gdk-popin-background .gdk-popin .gdk-popin-buttons .gdk-popin-button-wrapper .gdk-popin-button:focus {\n  opacity: 0.8;\n}\n.gdk-popin-background .gdk-popin-click-layer {\n  position: fixed;\n  top: 0;\n  bottom: 0;\n  left: 0;\n  right: 0;\n}\n", ""]);

// exports


/***/ }),

/***/ "../../node_modules/css-loader/lib/css-base.js":
/*!*********************************************************************!*\
  !*** /builds/gdk/framework/node_modules/css-loader/lib/css-base.js ***!
  \*********************************************************************/
/*! no static exports found */
/***/ (function(module, exports) {

/*
	MIT License http://www.opensource.org/licenses/mit-license.php
	Author Tobias Koppers @sokra
*/
// css base code, injected by the css-loader
module.exports = function(useSourceMap) {
	var list = [];

	// return the list of modules as css string
	list.toString = function toString() {
		return this.map(function (item) {
			var content = cssWithMappingToString(item, useSourceMap);
			if(item[2]) {
				return "@media " + item[2] + "{" + content + "}";
			} else {
				return content;
			}
		}).join("");
	};

	// import a list of modules into the list
	list.i = function(modules, mediaQuery) {
		if(typeof modules === "string")
			modules = [[null, modules, ""]];
		var alreadyImportedModules = {};
		for(var i = 0; i < this.length; i++) {
			var id = this[i][0];
			if(typeof id === "number")
				alreadyImportedModules[id] = true;
		}
		for(i = 0; i < modules.length; i++) {
			var item = modules[i];
			// skip already imported module
			// this implementation is not 100% perfect for weird media query combinations
			//  when a module is imported multiple times with different media queries.
			//  I hope this will never occur (Hey this way we have smaller bundles)
			if(typeof item[0] !== "number" || !alreadyImportedModules[item[0]]) {
				if(mediaQuery && !item[2]) {
					item[2] = mediaQuery;
				} else if(mediaQuery) {
					item[2] = "(" + item[2] + ") and (" + mediaQuery + ")";
				}
				list.push(item);
			}
		}
	};
	return list;
};

function cssWithMappingToString(item, useSourceMap) {
	var content = item[1] || '';
	var cssMapping = item[3];
	if (!cssMapping) {
		return content;
	}

	if (useSourceMap && typeof btoa === 'function') {
		var sourceMapping = toComment(cssMapping);
		var sourceURLs = cssMapping.sources.map(function (source) {
			return '/*# sourceURL=' + cssMapping.sourceRoot + source + ' */'
		});

		return [content].concat(sourceURLs).concat([sourceMapping]).join('\n');
	}

	return [content].join('\n');
}

// Adapted from convert-source-map (MIT)
function toComment(sourceMap) {
	// eslint-disable-next-line no-undef
	var base64 = btoa(unescape(encodeURIComponent(JSON.stringify(sourceMap))));
	var data = 'sourceMappingURL=data:application/json;charset=utf-8;base64,' + base64;

	return '/*# ' + data + ' */';
}


/***/ }),

/***/ "../../node_modules/style-loader/lib/addStyles.js":
/*!************************************************************************!*\
  !*** /builds/gdk/framework/node_modules/style-loader/lib/addStyles.js ***!
  \************************************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

/*
	MIT License http://www.opensource.org/licenses/mit-license.php
	Author Tobias Koppers @sokra
*/

var stylesInDom = {};

var	memoize = function (fn) {
	var memo;

	return function () {
		if (typeof memo === "undefined") memo = fn.apply(this, arguments);
		return memo;
	};
};

var isOldIE = memoize(function () {
	// Test for IE <= 9 as proposed by Browserhacks
	// @see http://browserhacks.com/#hack-e71d8692f65334173fee715c222cb805
	// Tests for existence of standard globals is to allow style-loader
	// to operate correctly into non-standard environments
	// @see https://github.com/webpack-contrib/style-loader/issues/177
	return window && document && document.all && !window.atob;
});

var getTarget = function (target) {
  return document.querySelector(target);
};

var getElement = (function (fn) {
	var memo = {};

	return function(target) {
                // If passing function in options, then use it for resolve "head" element.
                // Useful for Shadow Root style i.e
                // {
                //   insertInto: function () { return document.querySelector("#foo").shadowRoot }
                // }
                if (typeof target === 'function') {
                        return target();
                }
                if (typeof memo[target] === "undefined") {
			var styleTarget = getTarget.call(this, target);
			// Special case to return head of iframe instead of iframe itself
			if (window.HTMLIFrameElement && styleTarget instanceof window.HTMLIFrameElement) {
				try {
					// This will throw an exception if access to iframe is blocked
					// due to cross-origin restrictions
					styleTarget = styleTarget.contentDocument.head;
				} catch(e) {
					styleTarget = null;
				}
			}
			memo[target] = styleTarget;
		}
		return memo[target]
	};
})();

var singleton = null;
var	singletonCounter = 0;
var	stylesInsertedAtTop = [];

var	fixUrls = __webpack_require__(/*! ./urls */ "../../node_modules/style-loader/lib/urls.js");

module.exports = function(list, options) {
	if (typeof DEBUG !== "undefined" && DEBUG) {
		if (typeof document !== "object") throw new Error("The style-loader cannot be used in a non-browser environment");
	}

	options = options || {};

	options.attrs = typeof options.attrs === "object" ? options.attrs : {};

	// Force single-tag solution on IE6-9, which has a hard limit on the # of <style>
	// tags it will allow on a page
	if (!options.singleton && typeof options.singleton !== "boolean") options.singleton = isOldIE();

	// By default, add <style> tags to the <head> element
        if (!options.insertInto) options.insertInto = "head";

	// By default, add <style> tags to the bottom of the target
	if (!options.insertAt) options.insertAt = "bottom";

	var styles = listToStyles(list, options);

	addStylesToDom(styles, options);

	return function update (newList) {
		var mayRemove = [];

		for (var i = 0; i < styles.length; i++) {
			var item = styles[i];
			var domStyle = stylesInDom[item.id];

			domStyle.refs--;
			mayRemove.push(domStyle);
		}

		if(newList) {
			var newStyles = listToStyles(newList, options);
			addStylesToDom(newStyles, options);
		}

		for (var i = 0; i < mayRemove.length; i++) {
			var domStyle = mayRemove[i];

			if(domStyle.refs === 0) {
				for (var j = 0; j < domStyle.parts.length; j++) domStyle.parts[j]();

				delete stylesInDom[domStyle.id];
			}
		}
	};
};

function addStylesToDom (styles, options) {
	for (var i = 0; i < styles.length; i++) {
		var item = styles[i];
		var domStyle = stylesInDom[item.id];

		if(domStyle) {
			domStyle.refs++;

			for(var j = 0; j < domStyle.parts.length; j++) {
				domStyle.parts[j](item.parts[j]);
			}

			for(; j < item.parts.length; j++) {
				domStyle.parts.push(addStyle(item.parts[j], options));
			}
		} else {
			var parts = [];

			for(var j = 0; j < item.parts.length; j++) {
				parts.push(addStyle(item.parts[j], options));
			}

			stylesInDom[item.id] = {id: item.id, refs: 1, parts: parts};
		}
	}
}

function listToStyles (list, options) {
	var styles = [];
	var newStyles = {};

	for (var i = 0; i < list.length; i++) {
		var item = list[i];
		var id = options.base ? item[0] + options.base : item[0];
		var css = item[1];
		var media = item[2];
		var sourceMap = item[3];
		var part = {css: css, media: media, sourceMap: sourceMap};

		if(!newStyles[id]) styles.push(newStyles[id] = {id: id, parts: [part]});
		else newStyles[id].parts.push(part);
	}

	return styles;
}

function insertStyleElement (options, style) {
	var target = getElement(options.insertInto)

	if (!target) {
		throw new Error("Couldn't find a style target. This probably means that the value for the 'insertInto' parameter is invalid.");
	}

	var lastStyleElementInsertedAtTop = stylesInsertedAtTop[stylesInsertedAtTop.length - 1];

	if (options.insertAt === "top") {
		if (!lastStyleElementInsertedAtTop) {
			target.insertBefore(style, target.firstChild);
		} else if (lastStyleElementInsertedAtTop.nextSibling) {
			target.insertBefore(style, lastStyleElementInsertedAtTop.nextSibling);
		} else {
			target.appendChild(style);
		}
		stylesInsertedAtTop.push(style);
	} else if (options.insertAt === "bottom") {
		target.appendChild(style);
	} else if (typeof options.insertAt === "object" && options.insertAt.before) {
		var nextSibling = getElement(options.insertInto + " " + options.insertAt.before);
		target.insertBefore(style, nextSibling);
	} else {
		throw new Error("[Style Loader]\n\n Invalid value for parameter 'insertAt' ('options.insertAt') found.\n Must be 'top', 'bottom', or Object.\n (https://github.com/webpack-contrib/style-loader#insertat)\n");
	}
}

function removeStyleElement (style) {
	if (style.parentNode === null) return false;
	style.parentNode.removeChild(style);

	var idx = stylesInsertedAtTop.indexOf(style);
	if(idx >= 0) {
		stylesInsertedAtTop.splice(idx, 1);
	}
}

function createStyleElement (options) {
	var style = document.createElement("style");

	if(options.attrs.type === undefined) {
		options.attrs.type = "text/css";
	}

	addAttrs(style, options.attrs);
	insertStyleElement(options, style);

	return style;
}

function createLinkElement (options) {
	var link = document.createElement("link");

	if(options.attrs.type === undefined) {
		options.attrs.type = "text/css";
	}
	options.attrs.rel = "stylesheet";

	addAttrs(link, options.attrs);
	insertStyleElement(options, link);

	return link;
}

function addAttrs (el, attrs) {
	Object.keys(attrs).forEach(function (key) {
		el.setAttribute(key, attrs[key]);
	});
}

function addStyle (obj, options) {
	var style, update, remove, result;

	// If a transform function was defined, run it on the css
	if (options.transform && obj.css) {
	    result = options.transform(obj.css);

	    if (result) {
	    	// If transform returns a value, use that instead of the original css.
	    	// This allows running runtime transformations on the css.
	    	obj.css = result;
	    } else {
	    	// If the transform function returns a falsy value, don't add this css.
	    	// This allows conditional loading of css
	    	return function() {
	    		// noop
	    	};
	    }
	}

	if (options.singleton) {
		var styleIndex = singletonCounter++;

		style = singleton || (singleton = createStyleElement(options));

		update = applyToSingletonTag.bind(null, style, styleIndex, false);
		remove = applyToSingletonTag.bind(null, style, styleIndex, true);

	} else if (
		obj.sourceMap &&
		typeof URL === "function" &&
		typeof URL.createObjectURL === "function" &&
		typeof URL.revokeObjectURL === "function" &&
		typeof Blob === "function" &&
		typeof btoa === "function"
	) {
		style = createLinkElement(options);
		update = updateLink.bind(null, style, options);
		remove = function () {
			removeStyleElement(style);

			if(style.href) URL.revokeObjectURL(style.href);
		};
	} else {
		style = createStyleElement(options);
		update = applyToTag.bind(null, style);
		remove = function () {
			removeStyleElement(style);
		};
	}

	update(obj);

	return function updateStyle (newObj) {
		if (newObj) {
			if (
				newObj.css === obj.css &&
				newObj.media === obj.media &&
				newObj.sourceMap === obj.sourceMap
			) {
				return;
			}

			update(obj = newObj);
		} else {
			remove();
		}
	};
}

var replaceText = (function () {
	var textStore = [];

	return function (index, replacement) {
		textStore[index] = replacement;

		return textStore.filter(Boolean).join('\n');
	};
})();

function applyToSingletonTag (style, index, remove, obj) {
	var css = remove ? "" : obj.css;

	if (style.styleSheet) {
		style.styleSheet.cssText = replaceText(index, css);
	} else {
		var cssNode = document.createTextNode(css);
		var childNodes = style.childNodes;

		if (childNodes[index]) style.removeChild(childNodes[index]);

		if (childNodes.length) {
			style.insertBefore(cssNode, childNodes[index]);
		} else {
			style.appendChild(cssNode);
		}
	}
}

function applyToTag (style, obj) {
	var css = obj.css;
	var media = obj.media;

	if(media) {
		style.setAttribute("media", media)
	}

	if(style.styleSheet) {
		style.styleSheet.cssText = css;
	} else {
		while(style.firstChild) {
			style.removeChild(style.firstChild);
		}

		style.appendChild(document.createTextNode(css));
	}
}

function updateLink (link, options, obj) {
	var css = obj.css;
	var sourceMap = obj.sourceMap;

	/*
		If convertToAbsoluteUrls isn't defined, but sourcemaps are enabled
		and there is no publicPath defined then lets turn convertToAbsoluteUrls
		on by default.  Otherwise default to the convertToAbsoluteUrls option
		directly
	*/
	var autoFixUrls = options.convertToAbsoluteUrls === undefined && sourceMap;

	if (options.convertToAbsoluteUrls || autoFixUrls) {
		css = fixUrls(css);
	}

	if (sourceMap) {
		// http://stackoverflow.com/a/26603875
		css += "\n/*# sourceMappingURL=data:application/json;base64," + btoa(unescape(encodeURIComponent(JSON.stringify(sourceMap)))) + " */";
	}

	var blob = new Blob([css], { type: "text/css" });

	var oldSrc = link.href;

	link.href = URL.createObjectURL(blob);

	if(oldSrc) URL.revokeObjectURL(oldSrc);
}


/***/ }),

/***/ "../../node_modules/style-loader/lib/urls.js":
/*!*******************************************************************!*\
  !*** /builds/gdk/framework/node_modules/style-loader/lib/urls.js ***!
  \*******************************************************************/
/*! no static exports found */
/***/ (function(module, exports) {


/**
 * When source maps are enabled, `style-loader` uses a link element with a data-uri to
 * embed the css on the page. This breaks all relative urls because now they are relative to a
 * bundle instead of the current page.
 *
 * One solution is to only use full urls, but that may be impossible.
 *
 * Instead, this function "fixes" the relative urls to be absolute according to the current page location.
 *
 * A rudimentary test suite is located at `test/fixUrls.js` and can be run via the `npm test` command.
 *
 */

module.exports = function (css) {
  // get current location
  var location = typeof window !== "undefined" && window.location;

  if (!location) {
    throw new Error("fixUrls requires window.location");
  }

	// blank or null?
	if (!css || typeof css !== "string") {
	  return css;
  }

  var baseUrl = location.protocol + "//" + location.host;
  var currentDir = baseUrl + location.pathname.replace(/\/[^\/]*$/, "/");

	// convert each url(...)
	/*
	This regular expression is just a way to recursively match brackets within
	a string.

	 /url\s*\(  = Match on the word "url" with any whitespace after it and then a parens
	   (  = Start a capturing group
	     (?:  = Start a non-capturing group
	         [^)(]  = Match anything that isn't a parentheses
	         |  = OR
	         \(  = Match a start parentheses
	             (?:  = Start another non-capturing groups
	                 [^)(]+  = Match anything that isn't a parentheses
	                 |  = OR
	                 \(  = Match a start parentheses
	                     [^)(]*  = Match anything that isn't a parentheses
	                 \)  = Match a end parentheses
	             )  = End Group
              *\) = Match anything and then a close parens
          )  = Close non-capturing group
          *  = Match anything
       )  = Close capturing group
	 \)  = Match a close parens

	 /gi  = Get all matches, not the first.  Be case insensitive.
	 */
	var fixedCss = css.replace(/url\s*\(((?:[^)(]|\((?:[^)(]+|\([^)(]*\))*\))*)\)/gi, function(fullMatch, origUrl) {
		// strip quotes (if they exist)
		var unquotedOrigUrl = origUrl
			.trim()
			.replace(/^"(.*)"$/, function(o, $1){ return $1; })
			.replace(/^'(.*)'$/, function(o, $1){ return $1; });

		// already a full url? no change
		if (/^(#|data:|http:\/\/|https:\/\/|file:\/\/\/|\s*$)/i.test(unquotedOrigUrl)) {
		  return fullMatch;
		}

		// convert the url to a full url
		var newUrl;

		if (unquotedOrigUrl.indexOf("//") === 0) {
		  	//TODO: should we add protocol?
			newUrl = unquotedOrigUrl;
		} else if (unquotedOrigUrl.indexOf("/") === 0) {
			// path should be relative to the base url
			newUrl = baseUrl + unquotedOrigUrl; // already starts with '/'
		} else {
			// path should be relative to current directory
			newUrl = currentDir + unquotedOrigUrl.replace(/^\.\//, ""); // Strip leading './'
		}

		// send back the fixed url(...)
		return "url(" + JSON.stringify(newUrl) + ")";
	});

	// send back the fixed css
	return fixedCss;
};


/***/ }),

/***/ "../../node_modules/webpack/buildin/global.js":
/*!***********************************!*\
  !*** (webpack)/buildin/global.js ***!
  \***********************************/
/*! no static exports found */
/***/ (function(module, exports) {

var g;

// This works in non-strict mode
g = (function() {
	return this;
})();

try {
	// This works if eval is allowed (see CSP)
	g = g || new Function("return this")();
} catch (e) {
	// This works if the window reference is available
	if (typeof window === "object") g = window;
}

// g can still be undefined, but nothing to do about it...
// We return undefined, instead of nothing here, so it's
// easier to handle this case. if(!global) { ...}

module.exports = g;


/***/ }),

/***/ "./src/adaptativeVisualIdentity/adaptativeVisualIdentity.ts":
/*!******************************************************************!*\
  !*** ./src/adaptativeVisualIdentity/adaptativeVisualIdentity.ts ***!
  \******************************************************************/
/*! exports provided: AdaptativeVisualIdentity */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "AdaptativeVisualIdentity", function() { return AdaptativeVisualIdentity; });
/* harmony import */ var pixi_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! pixi.js */ "pixi.js");
/* harmony import */ var pixi_js__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(pixi_js__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var i18next__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! i18next */ "i18next");
/* harmony import */ var i18next__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(i18next__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var _gdk_core__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @gdk/core */ "@gdk/core");
/* harmony import */ var _gdk_core__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(_gdk_core__WEBPACK_IMPORTED_MODULE_2__);
/* harmony import */ var _gdk_core_pixi__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @gdk/core-pixi */ "@gdk/core-pixi");
/* harmony import */ var _gdk_core_pixi__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(_gdk_core_pixi__WEBPACK_IMPORTED_MODULE_3__);
/* harmony import */ var _loading__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../loading */ "./src/loading/index.ts");
/* harmony import */ var _events__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./events */ "./src/adaptativeVisualIdentity/events.ts");
var __extends = (undefined && undefined.__extends) || (function () {
    var extendStatics = function (d, b) {
        extendStatics = Object.setPrototypeOf ||
            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||
            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };
        return extendStatics(d, b);
    };
    return function (d, b) {
        if (typeof b !== "function" && b !== null)
            throw new TypeError("Class extends value " + String(b) + " is not a constructor or null");
        extendStatics(d, b);
        function __() { this.constructor = d; }
        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
    };
})();
var __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};
var __generator = (undefined && undefined.__generator) || function (thisArg, body) {
    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;
    return g = { next: verb(0), "throw": verb(1), "return": verb(2) }, typeof Symbol === "function" && (g[Symbol.iterator] = function() { return this; }), g;
    function verb(n) { return function (v) { return step([n, v]); }; }
    function step(op) {
        if (f) throw new TypeError("Generator is already executing.");
        while (g && (g = 0, op[0] && (_ = 0)), _) try {
            if (f = 1, y && (t = op[0] & 2 ? y["return"] : op[0] ? y["throw"] || ((t = y["return"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;
            if (y = 0, t) op = [op[0] & 2, t.value];
            switch (op[0]) {
                case 0: case 1: t = op; break;
                case 4: _.label++; return { value: op[1], done: false };
                case 5: _.label++; y = op[1]; op = [0]; continue;
                case 7: op = _.ops.pop(); _.trys.pop(); continue;
                default:
                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }
                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }
                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }
                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }
                    if (t[2]) _.ops.pop();
                    _.trys.pop(); continue;
            }
            op = body.call(thisArg, _);
        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }
        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };
    }
};
var __values = (undefined && undefined.__values) || function(o) {
    var s = typeof Symbol === "function" && Symbol.iterator, m = s && o[s], i = 0;
    if (m) return m.call(o);
    if (o && typeof o.length === "number") return {
        next: function () {
            if (o && i >= o.length) o = void 0;
            return { value: o && o[i++], done: !o };
        }
    };
    throw new TypeError(s ? "Object is not iterable." : "Symbol.iterator is not defined.");
};






var AdaptativeVisualIdentity = /** @class */ (function (_super) {
    __extends(AdaptativeVisualIdentity, _super);
    /**
     * Constructor
     * @param game the game reference containing the VI
     */
    function AdaptativeVisualIdentity(game, config) {
        var _this = 
        // Game Core
        _super.call(this, null, null, false) || this;
        /**
         * Defines the main emitter listened by the views
         */
        _this.emitter = new pixi_js__WEBPACK_IMPORTED_MODULE_0__["utils"].EventEmitter();
        /**
         * Defines the background used as an overlay when player shows the settings.
         * Anyway it can be used for other needs. The background is added into the stage
         * and has a Cover resize method.
         */
        _this.background = null;
        /**
         * Defines the loading view instance created after importing the lottery identity
         */
        _this.loadingView = null;
        /**
         * Defines the introduction view instance created after importing the lottery identity
         */
        _this.introductionView = null;
        /**
         * Defines the in-game view instance created after importing the lottery identity
         */
        _this.inGameView = null;
        /**
         * Defines the lock view instance created after importing the lottery identity
         */
        _this.lockView = null;
        _this._files = {};
        // false if sound was disabled from VI
        _this._soundEnabled = true;
        // Misc.
        _this.game = game;
        _this._config = config;
        _this.parameters = _this._config.parameters || {};
        pixi_js__WEBPACK_IMPORTED_MODULE_0__["ticker"].shared.autoStart = false;
        // Register needed loaders
        _gdk_core__WEBPACK_IMPORTED_MODULE_2__["Loader"].register(new _gdk_core_pixi__WEBPACK_IMPORTED_MODULE_3__["FontLoader"]());
        // Background
        _this.background = new pixi_js__WEBPACK_IMPORTED_MODULE_0__["Graphics"]();
        _this.background.resize = new _gdk_core_pixi__WEBPACK_IMPORTED_MODULE_3__["Resize"](_gdk_core_pixi__WEBPACK_IMPORTED_MODULE_3__["Resize"].cover);
        _this.background.interactive = true;
        // Events
        _this._bindEvents();
        return _this;
    }
    /**
     * Loads the given lottery identity exposing the required views
     * @param lottery the lottery identifier to know what identity to load
     */
    AdaptativeVisualIdentity.prototype.getIdentity = function (lottery) {
        return __awaiter(this, void 0, void 0, function () {
            var _a;
            return __generator(this, function (_b) {
                switch (_b.label) {
                    case 0:
                        __webpack_require__.p = "".concat(this.game.gameConfig.frameworkPath || ".").concat(_gdk_core__WEBPACK_IMPORTED_MODULE_2__["Tools"].getFolder(this.game.gameConfig.modules.paths["@gdk/gamekit"]), "/");
                        _a = lottery;
                        switch (_a) {
                            case "fdj": return [3 /*break*/, 1];
                            case "fdj_wizz": return [3 /*break*/, 3];
                            case "ds": return [3 /*break*/, 5];
                            case "nt": return [3 /*break*/, 7];
                            case "svs": return [3 /*break*/, 9];
                            case "lor": return [3 /*break*/, 11];
                            case "fgs": return [3 /*break*/, 13];
                            case "fgs_nt": return [3 /*break*/, 15];
                            case "fgs_ds": return [3 /*break*/, 17];
                            case "fgs_szk": return [3 /*break*/, 19];
                            case "fgs_ees": return [3 /*break*/, 21];
                            case "vks": return [3 /*break*/, 23];
                        }
                        return [3 /*break*/, 25];
                    case 1: return [4 /*yield*/, __webpack_require__.e(/*! import() | fdj */ "fdj").then(__webpack_require__.bind(null, /*! ./identities/fdj */ "./src/adaptativeVisualIdentity/identities/fdj/index.ts"))];
                    case 2: return [2 /*return*/, _b.sent()];
                    case 3:
                        this.background.visible = false;
                        return [4 /*yield*/, __webpack_require__.e(/*! import() | fdj_wizz */ "fdj_wizz").then(__webpack_require__.bind(null, /*! ./identities/fdj_wizz */ "./src/adaptativeVisualIdentity/identities/fdj_wizz/index.ts"))];
                    case 4: return [2 /*return*/, _b.sent()];
                    case 5: return [4 /*yield*/, __webpack_require__.e(/*! import() | ds */ "ds").then(__webpack_require__.bind(null, /*! ./identities/danskeSpil */ "./src/adaptativeVisualIdentity/identities/danskeSpil/index.ts"))];
                    case 6: return [2 /*return*/, _b.sent()];
                    case 7: return [4 /*yield*/, __webpack_require__.e(/*! import() | nt */ "nt").then(__webpack_require__.bind(null, /*! ./identities/norskTipping */ "./src/adaptativeVisualIdentity/identities/norskTipping/index.ts"))];
                    case 8: return [2 /*return*/, _b.sent()];
                    case 9: return [4 /*yield*/, __webpack_require__.e(/*! import() | svs */ "svs").then(__webpack_require__.bind(null, /*! ./identities/svenskaSpel */ "./src/adaptativeVisualIdentity/identities/svenskaSpel/index.ts"))];
                    case 10: return [2 /*return*/, _b.sent()];
                    case 11: return [4 /*yield*/, __webpack_require__.e(/*! import() | lor */ "lor").then(__webpack_require__.bind(null, /*! ./identities/lor */ "./src/adaptativeVisualIdentity/identities/lor/index.ts"))];
                    case 12: return [2 /*return*/, _b.sent()];
                    case 13: return [4 /*yield*/, __webpack_require__.e(/*! import() | fgs */ "fgs").then(__webpack_require__.bind(null, /*! ./identities/fgs */ "./src/adaptativeVisualIdentity/identities/fgs/index.ts"))];
                    case 14: return [2 /*return*/, _b.sent()];
                    case 15: return [4 /*yield*/, Promise.all(/*! import() | fgs_nt */[__webpack_require__.e("fgs"), __webpack_require__.e("fgs_nt")]).then(__webpack_require__.bind(null, /*! ./identities/fgs_nt */ "./src/adaptativeVisualIdentity/identities/fgs_nt/index.ts"))];
                    case 16: return [2 /*return*/, _b.sent()];
                    case 17: return [4 /*yield*/, Promise.all(/*! import() | fgs_ds */[__webpack_require__.e("fgs"), __webpack_require__.e("fgs_ds")]).then(__webpack_require__.bind(null, /*! ./identities/fgs_ds */ "./src/adaptativeVisualIdentity/identities/fgs_ds/index.ts"))];
                    case 18: return [2 /*return*/, _b.sent()];
                    case 19: return [4 /*yield*/, Promise.all(/*! import() | fgs_szk */[__webpack_require__.e("fgs"), __webpack_require__.e("fgs_szk")]).then(__webpack_require__.bind(null, /*! ./identities/fgs_szk */ "./src/adaptativeVisualIdentity/identities/fgs_szk/index.ts"))];
                    case 20: return [2 /*return*/, _b.sent()];
                    case 21: return [4 /*yield*/, Promise.all(/*! import() | fgs_ees */[__webpack_require__.e("fgs"), __webpack_require__.e("fgs_ees")]).then(__webpack_require__.bind(null, /*! ./identities/fgs_ees */ "./src/adaptativeVisualIdentity/identities/fgs_ees/index.ts"))];
                    case 22: return [2 /*return*/, _b.sent()];
                    case 23: return [4 /*yield*/, __webpack_require__.e(/*! import() | vks */ "vks").then(__webpack_require__.bind(null, /*! ./identities/veikkaus */ "./src/adaptativeVisualIdentity/identities/veikkaus/index.ts"))];
                    case 24: return [2 /*return*/, _b.sent()];
                    case 25: return [2 /*return*/, null];
                }
            });
        });
    };
    /**
     * Inits the VI by loading the assets and creating the state
     */
    AdaptativeVisualIdentity.prototype.init = function (done) {
        return __awaiter(this, void 0, void 0, function () {
            var locales, overridenLocales, identity, project, _a, _b, loader;
            var e_1, _c;
            var _this = this;
            return __generator(this, function (_d) {
                switch (_d.label) {
                    case 0: 
                    // Load theme files
                    return [4 /*yield*/, this.loader.configureFromTheme("vi", this.game.settings.language, "".concat(this._config.lottery, "/").concat(this._config.theme, "/"))];
                    case 1:
                        // Load theme files
                        _d.sent();
                        return [4 /*yield*/, this.loader.load()];
                    case 2:
                        _d.sent();
                        locales = this.loader.get("vi-i18n-base");
                        if (locales) {
                            i18next__WEBPACK_IMPORTED_MODULE_1___default.a.addResourceBundle(this.game.settings.language, "game", locales, true, true);
                        }
                        overridenLocales = this.loader.get("vi-i18n");
                        if (overridenLocales) {
                            i18next__WEBPACK_IMPORTED_MODULE_1___default.a.addResourceBundle(this.game.settings.language, "game", overridenLocales, true, true);
                        }
                        return [4 /*yield*/, this.getIdentity(this._config.lottery)];
                    case 3:
                        identity = _d.sent();
                        this.loadingView = new identity.LoadingView(this);
                        this.introductionView = new identity.IntroductionView(this);
                        this.inGameView = new identity.InGameView(this);
                        this.lockView = new identity.LockView(this);
                        // State
                        this.state = new _gdk_core__WEBPACK_IMPORTED_MODULE_2__["State"]({
                            loading: { view: this.loadingView },
                            introduction: { view: this.introductionView },
                            game: { view: this.inGameView },
                            lock: { view: this.lockView },
                        });
                        project = this.loader.get("project");
                        this.skin = project.skin;
                        this.loader.remove("project");
                        _gdk_core_pixi__WEBPACK_IMPORTED_MODULE_3__["ContainerImporter"].customContainerCreator = function (config, container) {
                            return _loading__WEBPACK_IMPORTED_MODULE_4__["ProjectLoader"].customContainerLoader(config, _this.loader.baseUrl, container, project);
                        };
                        _gdk_core_pixi__WEBPACK_IMPORTED_MODULE_3__["AssetStore"].parse(project.assets, this.loader.baseUrl);
                        project.views.forEach(function (v) {
                            return _gdk_core_pixi__WEBPACK_IMPORTED_MODULE_3__["StateImporter"].importView(_this.state.states[v.stateName].view, v, _this.loader.baseUrl, project);
                        });
                        // Start First as VI assets are still accessible.
                        _super.prototype.start.call(this);
                        // Then Clear loader as VI assets are now useless.
                        // excepted HowlerLoader that optionally loaded sound files than are often loaded
                        // during the game
                        if (this.game.gameConfig.gameParameters.overrideOnMultipleLoads) {
                            this.game.pixiLoader.overrideOnMultipleLoads = true;
                        }
                        else {
                            try {
                                for (_a = __values(this.loader.loaders), _b = _a.next(); !_b.done; _b = _a.next()) {
                                    loader = _b.value;
                                    if (!(loader instanceof _gdk_core__WEBPACK_IMPORTED_MODULE_2__["HowlerLoader"])) {
                                        loader.clear();
                                    }
                                }
                            }
                            catch (e_1_1) { e_1 = { error: e_1_1 }; }
                            finally {
                                try {
                                    if (_b && !_b.done && (_c = _a.return)) _c.call(_a);
                                }
                                finally { if (e_1) throw e_1.error; }
                            }
                        }
                        // Configure the GamePixi lock view
                        this.game.lockStage.addChild(this.lockView);
                        this.lockView.orientation = this.game.settings.orientation;
                        // Resize game
                        this.game.resize();
                        // VI has been initialized
                        if (this.onInitialized) {
                            this.onInitialized();
                        }
                        // Hide the environment "loading" image
                        this.game.com.bridge.executeAction("GAME_LOADING");
                        if (done) {
                            done();
                        }
                        return [2 /*return*/];
                }
            });
        });
    };
    /**
     * Shows the loading view
     */
    AdaptativeVisualIdentity.prototype.showLoadingView = function () {
        var _this = this;
        // Add view in front of all other views
        this.game.stage.addChild(this.loadingView);
        // Configure loader
        this.game.loader.onProgress = function (percentage) { return _this.loadingView.onProgress(percentage); };
    };
    /**
     * Shows the introduction
     * @param done callback once the animation is done
     */
    AdaptativeVisualIdentity.prototype.showIntroduction = function (done) {
        return __awaiter(this, void 0, void 0, function () {
            var _this = this;
            return __generator(this, function (_a) {
                switch (_a.label) {
                    case 0:
                        // Always set on top
                        this.game.stage.addChild(this.introductionView);
                        // Go to introduction view
                        return [4 /*yield*/, this.state.to("introduction")];
                    case 1:
                        // Go to introduction view
                        _a.sent();
                        // Play introduction sprite
                        return [2 /*return*/, new Promise(function (resolve) {
                                _this.introductionView.animate(function () {
                                    _this.emitter.emit(_events__WEBPACK_IMPORTED_MODULE_5__["EVisualIdentityEvent"].IntroductionShown);
                                    if (done) {
                                        done();
                                    }
                                    resolve();
                                });
                            })];
                }
            });
        });
    };
    /**
     * Shows the VI in game (logo, settings, purse etc.)
     */
    AdaptativeVisualIdentity.prototype.showInGame = function () {
        // Always set on top
        this.game.stage.addChild(this.inGameView);
        this.game.stage.addChild(this.introductionView);
        // Go to game view
        this.state.to("game");
    };
    /**
     * Hides the visual identity views
     */
    AdaptativeVisualIdentity.prototype.hide = function () {
        var _this = this;
        this.game.stage.removeChild(this.background);
        Object.keys(this.state.states).forEach(function (s) {
            var view = _this.state.states[s].view;
            view.visible = false;
        });
    };
    /**
     * Emit a VisualIdentity action event
     * @param event the action type to emit to intentities
     * @param parameters the parameters to send to the identity on the given action
     */
    AdaptativeVisualIdentity.prototype.emit = function (event, parameters) {
        return this.emitter.emit(event, parameters);
    };
    // Fills the background according to the given color / alpha
    AdaptativeVisualIdentity.prototype._fillBackground = function (color, alpha) {
        if (!(this.background instanceof pixi_js__WEBPACK_IMPORTED_MODULE_0__["Graphics"])) {
            return;
        }
        // set default values
        if (alpha === undefined) {
            alpha = 0.4;
        }
        this.background.beginFill(color, alpha);
        this.background.clear();
        this.background.drawRect(0, 0, 1, 1);
        this.background.endFill();
        // We have to manually set hit area on PIXI.Graphics
        this.background.hitArea = new pixi_js__WEBPACK_IMPORTED_MODULE_0__["Rectangle"](0, 0, this.game.renderer.width, this.game.renderer.height);
    };
    // Binds the events
    AdaptativeVisualIdentity.prototype._bindEvents = function () {
        var _this = this;
        // Resize
        window.addEventListener("resize", function () { return _this.emitter.emit("resize"); });
        // Settings
        this.emitter.on(_events__WEBPACK_IMPORTED_MODULE_5__["EVisualIdentityEvent"].ShowSettings, function () {
            // the loro lottery use a clickable transparent background for settings
            var behaviourParameter = _this.game.gameConfig.behavioursParameters[_this.game.gameConfig.selectedBehaviour];
            _this._fillBackground(0x0, behaviourParameter.settingsBackgroundOpacity);
            _this.game.stage.addChild(_this.background);
            _this.game.stage.addChild(_this.inGameView);
            // Hack: need to render stage to update transforms according to
            // vertex datas of settings component and its children...
            // this.game.renderer.render(this.game.stage);
        });
        this.emitter.on(_events__WEBPACK_IMPORTED_MODULE_5__["EVisualIdentityEvent"].HideSettings, function () {
            _this.game.stage.removeChild(_this.background);
        });
        // Scratch
        this.emitter.on(_events__WEBPACK_IMPORTED_MODULE_5__["EVisualIdentityAction"].ShowScratchSettings, function (visible) {
            if (visible) {
                _this._fillBackground(0x0, 0.4);
                _this.game.stage.addChild(_this.background);
            }
            else {
                _this.game.stage.removeChild(_this.background);
            }
            _this.game.stage.addChild(_this.inGameView);
        });
        this.emitter.on(_events__WEBPACK_IMPORTED_MODULE_5__["EVisualIdentityEvent"].SetScratchConfiguration, function (params) {
            _gdk_core_pixi__WEBPACK_IMPORTED_MODULE_3__["ScratchSolver"].scratchs.forEach(function (scratch) {
                // TODO: change this addTarget interface for a scratchComponent.setTool(IScratchConfig)
                scratch.emitterDatas = params.emitterDatas;
                scratch.revealEmitterDatas = params.revealEmitterDatas;
                params.pointer.addTarget(scratch);
            });
        });
        this.emitter.on(_events__WEBPACK_IMPORTED_MODULE_5__["EVisualIdentityAction"].SoundEnabled, function (enabled) {
            _this._soundEnabled = enabled;
        });
        // Backward compatibility
        this.emitter.on(_events__WEBPACK_IMPORTED_MODULE_5__["EVisualIdentityEvent"].ShowRules, function () { return _this.onShowRules && _this.onShowRules(); });
        this.emitter.on(_events__WEBPACK_IMPORTED_MODULE_5__["EVisualIdentityEvent"].ShowMainRules, function () { return _this.onShowMainRules && _this.onShowMainRules(); });
    };
    Object.defineProperty(AdaptativeVisualIdentity.prototype, "settingsEnabled", {
        /**
         * For backward compatibility, keep setter to know if settings are enabled
         * @deprecated
         */
        set: function (enabled) {
            this.emitter.emit(_events__WEBPACK_IMPORTED_MODULE_5__["EVisualIdentityAction"].SettingsEnabled, enabled);
        },
        enumerable: false,
        configurable: true
    });
    Object.defineProperty(AdaptativeVisualIdentity.prototype, "soundEnabled", {
        /**
         * Return true if sound is enabled in VI, false otherwise.
         * @returns boolean
         */
        get: function () {
            return this._soundEnabled;
        },
        /**
         * Enabled / disable sound
         * @param enabled: boolean
         */
        set: function (enabled) {
            this._soundEnabled = enabled;
            this.emitter.emit(_events__WEBPACK_IMPORTED_MODULE_5__["EVisualIdentityAction"].SoundEnabled, enabled);
        },
        enumerable: false,
        configurable: true
    });
    return AdaptativeVisualIdentity;
}(_gdk_core__WEBPACK_IMPORTED_MODULE_2__["GameCore"]));



/***/ }),

/***/ "./src/adaptativeVisualIdentity/events.ts":
/*!************************************************!*\
  !*** ./src/adaptativeVisualIdentity/events.ts ***!
  \************************************************/
/*! exports provided: EVisualIdentityEvent, EVisualIdentityAction */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "EVisualIdentityEvent", function() { return EVisualIdentityEvent; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "EVisualIdentityAction", function() { return EVisualIdentityAction; });
var EVisualIdentityEvent;
(function (EVisualIdentityEvent) {
    /**
     * Event sent by the VI once the introduction has been shown
     */
    EVisualIdentityEvent["IntroductionShown"] = "introductionShown";
    /**
     * Event sent by the VI once the introduction finished
     */
    EVisualIdentityEvent["IntroductionComplete"] = "introductionComplete";
    /**
     * Event sent by the VI on the user wants to see the settings
     */
    EVisualIdentityEvent["ShowSettings"] = "showsettings";
    /**
     * Event sent by the VI on the user wants to hide the settings
     */
    EVisualIdentityEvent["HideSettings"] = "hidesettings";
    /**
     * Event sent by the VI on the user wants to see the rules
     */
    EVisualIdentityEvent["ShowRules"] = "showrules";
    /**
     * Event sent by the VI on the user wants to hide the rules
     * (from Norsk Tipping)
     */
    EVisualIdentityEvent["HideRules"] = "hiderules";
    /**
     * Event sent by the VI on the user wants to see the main rules
     */
    EVisualIdentityEvent["ShowMainRules"] = "showmainrules";
    /**
     * Event sent by the VI on the sound status changed
     */
    EVisualIdentityEvent["SoundStatusChanged"] = "soundstatuschanged";
    /**
     * Event sent by the VI on the user wants to quit the game
     */
    EVisualIdentityEvent["QuitGame"] = "quitgame";
    /**
     * Event sent by the VI on the user wanted to quit the game and the confirm popup is appearing
     */
    EVisualIdentityEvent["ConfirmQuitGame"] = "confirmQuitGame";
    /**
     * Event sent by the VI on the user wants to see the winning table
     * (from Danske Spil)
     */
    EVisualIdentityEvent["ShowWinningTable"] = "showwinningtable";
    /**
     * Event sent by the VI on the user wants to see the informations about the current game
     * (from Danske Spil)
     */
    EVisualIdentityEvent["AboutGame"] = "aboutGame";
    /**
     * Event sent by the VI to notify that scratch configuration has to be modified
     * Sent with params as {pointer:CustomPointer, emitterDatas:any}
     */
    EVisualIdentityEvent["SetScratchConfiguration"] = "setscratchconfiguration";
    /**
     * Event sent by the VI on the user wanted to go to the game tutorial
     * (from FDJ)
     */
    EVisualIdentityEvent["Tutorial"] = "tutorial";
    /**
     * Event sent by the VI when the user want to switch game mode between normal and demo
     */
    EVisualIdentityEvent["SwitchGameMode"] = "switchgamemode";
    /**
     * Event sent when the webpage lose focus and become blurred
     */
    EVisualIdentityEvent["GameBlurred"] = "gameblurred";
    /**
     * Event sent when the webpage regain focus
     */
    EVisualIdentityEvent["GameFocused"] = "gamefocused";
    /**
     * Event sent by the LORO VI when a user use the built in auto button
     */
    EVisualIdentityEvent["AutoButton"] = "autobutton";
})(EVisualIdentityEvent || (EVisualIdentityEvent = {}));
var EVisualIdentityAction;
(function (EVisualIdentityAction) {
    /**
     * Action that sets if the settings are enabled or not
     * @example vi.emitter.emit(EVisualIdentityAction.SettingsEnabled, true); // To enable settings
     * @example vi.emitter.emit(EVisualIdentityAction.SettingsEnabled, false); // To disable settings
     */
    EVisualIdentityAction["SettingsEnabled"] = "settingsEnabled";
    /**
     * Action that sets the new purse to display
     * @example vi.emitter.emit(EVisualIdentityAction.SetPurse, new Amount(0)); // Set a purse of 0€ for example
     */
    EVisualIdentityAction["SetPurse"] = "setPurse";
    /**
     * Action that sets if the rules are enabled or not
     * @example vi.emitter.emit(EVisualIdentityAction.RulesEnabled, true); // To enable rules
     * @example vi.emitter.emit(EVisualIdentityAction.RulesEnabled, false); // To disable rules
     */
    EVisualIdentityAction["RulesEnabled"] = "rulesEnabled";
    /**
     * Action that sets that the game is ready so the Visual Identity can perform
     * some actions that require the game to be ready
     */
    EVisualIdentityAction["SetGameReady"] = "setGameReady";
    /**
     * Action that sets the scratch settings component visible
     * @example vi.emitter.emit(EVisualIdentityAction.ShowScratchSettings, true); // To show scratch settings
     * @example vi.emitter.emit(EVisualIdentityAction.ShowScratchSettings, false); // To hide scratch settings
     */
    EVisualIdentityAction["ShowScratchSettings"] = "showScratchSettings";
    /**
     * Tells the Visual Identity to update its design according to the newly loaded assets in the game
     * @example vi.emitter.emit(EVisualIdentityAction.UpadteDesign); // Tells to update the design
     */
    EVisualIdentityAction["UpdateDesign"] = "updateDesign";
    /**
     * Tells the VI to add the given buttons to the controls buton
     */
    EVisualIdentityAction["AddControlButton"] = "addControlButton";
    /**
     * Give the WIZZ VI the rules to add
     * @example vi.emitter.emit(EVisualIdentityAction.WizzSetRules, [ContainerRules1, ContainerRules2]); // To add two rules slide
     */
    EVisualIdentityAction["WizzSetRules"] = "wizzSetRules";
    /**
     * Set wizz game specific textures
     * @example vi.emitter.emit(EVisualIdentityAction.WizzSetConfig, {
     * 		bottom?: {
     * 			title?: Texture,
     * 			background?: Texture,
     * 		},
     * 		bet?: {
     * 			idle?: Texture,
     * 			over?: Texture,
     * 			click?: Texture,
     * 			disabled?: Texture,
     * 		},
     * 		onBet: () => Promise<void>,
     * 		onReconnect: () => Promise<void>,
     * 		amount: Amount,
     * 	});
     */
    EVisualIdentityAction["WizzSetConfig"] = "wizzSetConfig";
    /**
     * Wizz get purse containers
     * @example vi.emitter.emit(EVisualIdentityAction.WizzGetPursesContainers, (containers) => {
     * 		containers.gift // promo token
     * 		containers.token // token
     * 		containers.gameWin // game win
     * 		containers.standard // real purse
     * });
     */
    EVisualIdentityAction["WizzGetPursesContainers"] = "wizzGetPursesContainer";
    /**
     * Wizz get bottom container
     * @example vi.emitter.emit(EVisualIdentityAction.WizzGetBottomContainer, (container) => {
     * 		container
     * });
     */
    EVisualIdentityAction["WizzGetBottomContainer"] = "wizzGetBottomContainer";
    /**
     * Wizz get waiting container
     * @example vi.emitter.emit(EVisualIdentityAction.WizzGetWaitingContainer, (container) => {
     * 		container
     * });
     */
    EVisualIdentityAction["WizzGetWaitingContainer"] = "wizzGetWaitingContainer";
    /**
     * Wizz open canceled popup
     * @example vi.emitter.emit(EVisualIdentityAction.WizzOpenCanceled);
     */
    EVisualIdentityAction["WizzOpenCanceled"] = "wizzOpenCanceled";
    /**
     * Wizz open canceled popup
     * @example vi.emitter.emit(EVisualIdentityAction.WizzOpenStopped);
     */
    EVisualIdentityAction["WizzOpenStopped"] = "wizzOpenStopped";
    /**
     * Wizz open reconnection popup
     * @example vi.emitter.emit(EVisualIdentityAction.WizzOpenReconnection);
     */
    EVisualIdentityAction["WizzOpenReconnection"] = "wizzOpenReconnection";
    /**
     * Wizz close reconnection popup
     * @example vi.emitter.emit(EVisualIdentityAction.WizzCloseReconnection);
     */
    EVisualIdentityAction["WizzCloseReconnection"] = "wizzCloseReconnection";
    /**
     * Wizz open bet popup
     * @example vi.emitter.emit(EVisualIdentityAction.WizzOpenBet);
     */
    EVisualIdentityAction["WizzOpenBet"] = "wizzOpenBet";
    /**
     * Wizz open waiting room
     * @example vi.emitter.emit(EVisualIdentityAction.WizzOpenWaitingRoom);
     */
    EVisualIdentityAction["WizzOpenWaitingRoom"] = "wizzOpenWaitingRoom";
    /**
     * Wizz close waiting room
     * @example vi.emitter.emit(EVisualIdentityAction.WizzCloseWaitingRoom);
     */
    EVisualIdentityAction["WizzCloseWaitingRoom"] = "wizzCloseWaitingRoom";
    /**
     * Wizz close reconnection popup
     * @example vi.emitter.emit(EVisualIdentityAction.WizzCloseReconnection);
     */
    EVisualIdentityAction["WizzCloseAllPopups"] = "wizzCloseAllPopups";
    /**
     * Wizz update token purses
     * @example vi.emitter.emit(EVisualIdentityAction.WizzUpdatePurse);
     */
    EVisualIdentityAction["WizzUpdatePurse"] = "wizzUpdatePurse";
    /**
     * Wizz update game gain
     * @example vi.emitter.emit(EVisualIdentityAction.WizzUpdateGain, amount);
     */
    EVisualIdentityAction["WizzUpdateGain"] = "wizzUpdateGain";
    /**
     * @deprecated  use wizzGetAvatarslots instead
     * Wizz get Avatars from avatar ids
     * @example vi.emitter.emit(EVisualIdentityAction.WizzUpdateGain, ids, (avatars) => void);
     */
    EVisualIdentityAction["WizzGetAvatars"] = "wizzGetAvatars";
    /**
     * Wizz Add VI Player
     * @example vi.emitter.emit(EVisualIdentityAction.WizzAddLobbyPlayer, AvatarSlot, isClientPlayer);
     */
    EVisualIdentityAction["WizzAddLobbyPlayer"] = "wizzAddLobbyPlayer";
    /**
     * get the avatar with truncated pseudo and positioning
     * @example	this.game.vi.emitter.emit(EVisualIdentityAction.WizzGetAvatarSlots, playerInfo, this.clientPlayerID, (avatarSlots: IAvatarSlot[]) => {clback here});
     */
    EVisualIdentityAction["WizzGetAvatarSlots"] = "wizzGetAvatarSlots";
    /**
     * Hide or show tutorial button
     * @example vi.emitter.emit(EVisualIdentityAction.TutorialVisible, true, true)
     */
    EVisualIdentityAction["TutorialVisible"] = "tutorialVisible";
    /**
     * Enable or disable the sound
     * @example vi.emitter.emit(EVisualIdentityAction.SoundEnabled, true)
     */
    EVisualIdentityAction["SoundEnabled"] = "soundEnabled";
    /**
     * Enable or disable the auto button on the VI
     * @exemple vi.emmiter.emit(EVisualIdentityAction.AutoEnabled, true)
     */
    EVisualIdentityAction["AutoEnabled"] = "autoEnabled";
})(EVisualIdentityAction || (EVisualIdentityAction = {}));


/***/ }),

/***/ "./src/adaptativeVisualIdentity/identities/danskeSpil/components/time.ts":
/*!*******************************************************************************!*\
  !*** ./src/adaptativeVisualIdentity/identities/danskeSpil/components/time.ts ***!
  \*******************************************************************************/
/*! exports provided: Time */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Time", function() { return Time; });
/* harmony import */ var pixi_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! pixi.js */ "pixi.js");
/* harmony import */ var pixi_js__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(pixi_js__WEBPACK_IMPORTED_MODULE_0__);
var __extends = (undefined && undefined.__extends) || (function () {
    var extendStatics = function (d, b) {
        extendStatics = Object.setPrototypeOf ||
            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||
            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };
        return extendStatics(d, b);
    };
    return function (d, b) {
        if (typeof b !== "function" && b !== null)
            throw new TypeError("Class extends value " + String(b) + " is not a constructor or null");
        extendStatics(d, b);
        function __() { this.constructor = d; }
        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
    };
})();

var Time = /** @class */ (function (_super) {
    __extends(Time, _super);
    /**
     * Constructor
     */
    function Time() {
        var _this = _super.call(this) || this;
        /**
         * Label textfield used to draw the purse value (from the editor)
         */
        _this.label = null;
        _this.iconBlack = null;
        _this.iconWhite = null;
        _this._hours = -1;
        _this._minutes = -1;
        return _this;
    }
    Object.defineProperty(Time.prototype, "color", {
        /**
         * sets the clock color to black or white
         */
        set: function (value) {
            this.iconBlack.visible = value === "black" || value === "#000000" || value === "#000";
            this.iconWhite.visible = !this.iconBlack.visible;
            this.label.styles.default.fill = value;
            this.label.text = this.label.text;
        },
        enumerable: false,
        configurable: true
    });
    /**
     * Sets the current time
     * @param ms ellapsed milliseconds
     */
    Time.prototype.setTime = function (ms) {
        // apply time text
        var d = new Date(ms);
        var hours = d.getHours();
        var minutes = d.getMinutes();
        if (hours === this._hours && minutes === this._minutes) {
            return;
        }
        // Update text
        this.label.text = "".concat((hours < 10 ? "0" : "") + hours, ":").concat((minutes < 10 ? "0" : "") + minutes);
        // Update cache
        this._hours = hours;
        this._minutes = minutes;
    };
    /**
     * Render text with WebGL
     * @param renderer the pixi.js renderer (WebGLRenderer)
     * @override PIXI.Sprite.renderWebGL
     */
    Time.prototype.renderWebGL = function (renderer) {
        this.setTime(Date.now());
        _super.prototype.renderWebGL.call(this, renderer);
    };
    /**
     * Render text with Canvas renderer
     * @param renderer the pixi.js renderer (CanvasRenderer)
     * @override PIXI.Sprite._renderCanvas
     */
    Time.prototype._renderCanvas = function (renderer) {
        this.setTime(Date.now());
        _super.prototype._renderCanvas.call(this, renderer);
    };
    return Time;
}(pixi_js__WEBPACK_IMPORTED_MODULE_0__["Container"]));



/***/ }),

/***/ "./src/adaptativeVisualIdentity/identities/danskeSpil/views/bottomBar.ts":
/*!*******************************************************************************!*\
  !*** ./src/adaptativeVisualIdentity/identities/danskeSpil/views/bottomBar.ts ***!
  \*******************************************************************************/
/*! exports provided: BottomBar */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "BottomBar", function() { return BottomBar; });
/* harmony import */ var pixi_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! pixi.js */ "pixi.js");
/* harmony import */ var pixi_js__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(pixi_js__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var _components_time__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../components/time */ "./src/adaptativeVisualIdentity/identities/danskeSpil/components/time.ts");
var __extends = (undefined && undefined.__extends) || (function () {
    var extendStatics = function (d, b) {
        extendStatics = Object.setPrototypeOf ||
            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||
            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };
        return extendStatics(d, b);
    };
    return function (d, b) {
        if (typeof b !== "function" && b !== null)
            throw new TypeError("Class extends value " + String(b) + " is not a constructor or null");
        extendStatics(d, b);
        function __() { this.constructor = d; }
        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
    };
})();


var BottomBar = /** @class */ (function (_super) {
    __extends(BottomBar, _super);
    /**
     * Constructor
     * @param vi the adaptative visual identity reference
     */
    function BottomBar(vi, inGameView) {
        var _this = _super.call(this) || this;
        _this.vi = vi;
        _this.inGameView = inGameView;
        /**
         * Bottom overlay used to draw time and menu button
         */
        _this.bottomOverlay = null;
        /**
         * Quick button used to show DS Quick settings (from the editor)
         */
        _this.settingsButton = null;
        /**
         * Textfield used to draw the current time (from the editor)
         */
        _this.time = new _components_time__WEBPACK_IMPORTED_MODULE_1__["Time"]();
        _this._buttons = [];
        _this._buttonsLeft = [];
        _this._buttonsRight = [];
        return _this;
    }
    /**
     * handle bottom bar resize
     */
    BottomBar.prototype.onResize = function () {
        var rendererWidth = this.vi.game.renderer.width / this.vi.game.renderer.resolution;
        var reverseParentScaleRatio = 1 / this.inGameView.scaleXY;
        this.dockingBounds.width = Math.max(this.inGameView.dockingBounds.width, rendererWidth * reverseParentScaleRatio);
        var maxButtonsWidth = 0;
        var maxLeftButtonsWidth = 0;
        var maxRightButtonsWidth = 0;
        this._buttonsLeft.forEach(function (leftButton) {
            maxLeftButtonsWidth = Math.max(maxLeftButtonsWidth, leftButton.width);
        });
        this._buttonsRight.forEach(function (rightBUtton) {
            maxRightButtonsWidth = Math.max(maxRightButtonsWidth, rightBUtton.width);
        });
        maxButtonsWidth = Math.max(maxLeftButtonsWidth, maxRightButtonsWidth);
        var spacing = -10;
        this._buttonsLeft.forEach(function (leftButton) {
            leftButton.docking.x = (maxRightButtonsWidth + spacing) * -0.5;
        });
        this._buttonsRight.forEach(function (rightButton) {
            rightButton.docking.x = (maxLeftButtonsWidth + spacing) * 0.5;
        });
    };
    /**
     * adds a button to the buttom bar
     * @param button
     */
    BottomBar.prototype.addButton = function (button) {
        this._buttons.push(button);
        if (button.docking.x < 0) {
            this._buttonsLeft.push(button);
        }
        else if (button.docking.x > 0) {
            this._buttonsRight.push(button);
        }
        this.addChild(button);
    };
    BottomBar.height = 90;
    return BottomBar;
}(pixi_js__WEBPACK_IMPORTED_MODULE_0__["Container"]));



/***/ }),

/***/ "./src/adaptativeVisualIdentity/identities/fgs/components/messagePopin.ts":
/*!********************************************************************************!*\
  !*** ./src/adaptativeVisualIdentity/identities/fgs/components/messagePopin.ts ***!
  \********************************************************************************/
/*! exports provided: MessagePopin */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "MessagePopin", function() { return MessagePopin; });
/* harmony import */ var pixi_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! pixi.js */ "pixi.js");
/* harmony import */ var pixi_js__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(pixi_js__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var gsap__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! gsap */ "gsap");
/* harmony import */ var gsap__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(gsap__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var i18next__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! i18next */ "i18next");
/* harmony import */ var i18next__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(i18next__WEBPACK_IMPORTED_MODULE_2__);
var __extends = (undefined && undefined.__extends) || (function () {
    var extendStatics = function (d, b) {
        extendStatics = Object.setPrototypeOf ||
            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||
            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };
        return extendStatics(d, b);
    };
    return function (d, b) {
        if (typeof b !== "function" && b !== null)
            throw new TypeError("Class extends value " + String(b) + " is not a constructor or null");
        extendStatics(d, b);
        function __() { this.constructor = d; }
        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
    };
})();
var __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};
var __generator = (undefined && undefined.__generator) || function (thisArg, body) {
    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;
    return g = { next: verb(0), "throw": verb(1), "return": verb(2) }, typeof Symbol === "function" && (g[Symbol.iterator] = function() { return this; }), g;
    function verb(n) { return function (v) { return step([n, v]); }; }
    function step(op) {
        if (f) throw new TypeError("Generator is already executing.");
        while (g && (g = 0, op[0] && (_ = 0)), _) try {
            if (f = 1, y && (t = op[0] & 2 ? y["return"] : op[0] ? y["throw"] || ((t = y["return"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;
            if (y = 0, t) op = [op[0] & 2, t.value];
            switch (op[0]) {
                case 0: case 1: t = op; break;
                case 4: _.label++; return { value: op[1], done: false };
                case 5: _.label++; y = op[1]; op = [0]; continue;
                case 7: op = _.ops.pop(); _.trys.pop(); continue;
                default:
                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }
                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }
                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }
                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }
                    if (t[2]) _.ops.pop();
                    _.trys.pop(); continue;
            }
            op = body.call(thisArg, _);
        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }
        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };
    }
};



var MessagePopin = /** @class */ (function (_super) {
    __extends(MessagePopin, _super);
    function MessagePopin() {
        var _this = _super !== null && _super.apply(this, arguments) || this;
        /**
         * the padding (rectangle) between popin borders and it's content
         */
        _this.padding = new pixi_js__WEBPACK_IMPORTED_MODULE_0__["Rectangle"](35, 20, 35, 30);
        /**
         * the spacing (Point) between popin contents
         */
        _this.spacing = new pixi_js__WEBPACK_IMPORTED_MODULE_0__["Point"](15, 30);
        _this.background = null;
        _this.title = null;
        _this.body = null;
        _this.overlay = null;
        _this._hidden = false;
        _this._buttonsStack = [];
        _this._buttons = [];
        _this._buttonsByName = []; // Button[] = [];
        _this._buttonsStackMinSize = 0;
        _this._primary = null;
        _this._secondary = null;
        _this._cancel = null;
        _this._close = null;
        return _this;
    }
    /**
     * called once when loaded, init editor components
     */
    MessagePopin.prototype.onLoaded = function () {
        var _this = this;
        var buttonsTemplates = [this._primary, this._secondary, this._cancel, this._close];
        buttonsTemplates.forEach(function (button) {
            _this._buttonsStackMinSize = Math.max(_this._buttonsStackMinSize, button.nineSliceMinSize.x);
            button.visible = false;
            _this.removeChild(button);
        });
        // Force invisible
        this.hide(0);
    };
    /**
     * will open a popin based on i18n object
     * @param key the i18n key
     */
    MessagePopin.prototype.openFromi18n = function (key, options) {
        if (options === void 0) { options = {}; }
        return __awaiter(this, void 0, void 0, function () {
            var popinSettings;
            return __generator(this, function (_a) {
                popinSettings = this.getFromi18n(key, options);
                if (popinSettings) {
                    return [2 /*return*/, this.open(popinSettings)];
                }
                else {
                    return [2 /*return*/, { error: MessagePopin.ERROR_NO_POPIN }];
                }
                return [2 /*return*/];
            });
        });
    };
    /**
     * open a message popin (text + optionnal buttons)
     * will get the popin settings based on an object from i18n
     * @param key the object key in i18n
     * @param options i18n options like replacement properties.
     */
    MessagePopin.prototype.getFromi18n = function (key, options) {
        if (options === void 0) { options = {}; }
        return i18next__WEBPACK_IMPORTED_MODULE_2___default.a.t(key, Object.assign(options, { returnObjects: true, defaultValue: null }));
    };
    /**
     * open a message popin (text + optionnal buttons)
     * will get the popin settings based on an object
     * @param options the popin options
     */
    MessagePopin.prototype.open = function (options) {
        return __awaiter(this, void 0, void 0, function () {
            var _this = this;
            return __generator(this, function (_a) {
                switch (_a.label) {
                    case 0:
                        this._pending = options;
                        if (!this.parent) {
                            return [2 /*return*/, Promise.reject({
                                    error: "popin isn't in the display list (it doesn't have a parent)",
                                })];
                        }
                        this.addOverlay();
                        this.removeButtons();
                        // const primary = this.primaryButton.clone();
                        this._pending.buttons.forEach(function (datas) {
                            // get a new button from the prefabs
                            var button = _this["_".concat(datas.type)].clone();
                            if (button) {
                                // for the tracking :
                                button.setName("".concat(options.name, ":").concat(datas.name));
                                // configure the button
                                button.visible = true;
                                _this.addChild(button);
                                if (datas.type !== "close") {
                                    button.label = datas.label;
                                    _this._buttonsStack.push(button);
                                }
                                _this._buttons.push(button);
                                _this._buttonsByName[datas.name] = button;
                                button.on("pointertap", function () { return __awaiter(_this, void 0, void 0, function () {
                                    return __generator(this, function (_a) {
                                        switch (_a.label) {
                                            case 0: return [4 /*yield*/, this.hide()];
                                            case 1:
                                                _a.sent();
                                                if (datas.exit || datas.type === "close") {
                                                    this._pendingReject(datas.value);
                                                }
                                                else {
                                                    this._pendingResolve(datas.value);
                                                }
                                                return [2 /*return*/];
                                        }
                                    });
                                }); });
                            }
                        });
                        // Resize the settings background
                        this._resizeBackground();
                        return [4 /*yield*/, this.show()];
                    case 1:
                        _a.sent();
                        return [4 /*yield*/, new Promise(function (resolve, reject) {
                                _this._pendingResolve = resolve;
                                _this._pendingReject = reject;
                            }).then(function (result) {
                                return { result: result };
                            }, function (error) {
                                return { error: error };
                            })];
                    case 2: return [2 /*return*/, _a.sent()];
                }
            });
        });
    };
    /**
     * will show the popin
     * @param duration the transition duration
     */
    MessagePopin.prototype.show = function (duration) {
        if (duration === void 0) { duration = 0.2; }
        return __awaiter(this, void 0, void 0, function () {
            var _this = this;
            return __generator(this, function (_a) {
                return [2 /*return*/, new Promise(function (resolve) {
                        if (_this._hidden) {
                            _this.visible = true;
                            gsap__WEBPACK_IMPORTED_MODULE_1__["TweenMax"].fromTo(_this, duration, { scaleXY: 0.85, alpha: 0 }, {
                                scaleXY: 1,
                                alpha: 1,
                                ease: gsap__WEBPACK_IMPORTED_MODULE_1__["Cubic"].easeOut,
                                onComplete: function () {
                                    _this.buttonsSetEnabled(true);
                                    resolve();
                                },
                            });
                        }
                        else {
                            resolve();
                        }
                        _this._hidden = false;
                    })];
            });
        });
    };
    /**
     * will hide the popin
     * @param duration the transition duration
     */
    MessagePopin.prototype.hide = function (duration) {
        if (duration === void 0) { duration = 0.2; }
        return __awaiter(this, void 0, void 0, function () {
            var _this = this;
            return __generator(this, function (_a) {
                return [2 /*return*/, new Promise(function (resolve) {
                        _this.buttonsSetEnabled(false);
                        gsap__WEBPACK_IMPORTED_MODULE_1__["TweenMax"].fromTo(_this, duration, { scaleXY: 1, alpha: 1 }, {
                            scaleXY: 1.075,
                            alpha: 0,
                            ease: gsap__WEBPACK_IMPORTED_MODULE_1__["Cubic"].easeOut,
                            onComplete: function () {
                                _this.visible = false;
                                _this.removeOverlay();
                                resolve();
                                _this.removeButtons();
                            },
                        });
                        _this._hidden = true;
                    })];
            });
        });
    };
    Object.defineProperty(MessagePopin.prototype, "buttons", {
        /**
         * give read only access to the popin buttons list (just in case)
         */
        get: function () {
            return this._buttonsByName;
        },
        enumerable: false,
        configurable: true
    });
    MessagePopin.prototype._resizeBackground = function () {
        var _this = this;
        this.title.docking.y = this.padding.top;
        this.title.height = 0;
        this.title.text = "";
        this.title.width = 0;
        this.body.height = 0;
        this.body.text = "";
        this.body.width = 0;
        var buttons = this._buttonsStack.filter(function (button) { return button.visible; });
        var maxButtonHeight = 0;
        var maxButtonWidth = 0;
        buttons.forEach(function (button) {
            // resize button at min size
            button.nineSliceMinSize.x = _this._buttonsStackMinSize;
            button.label = button.label;
            maxButtonHeight = Math.max(maxButtonHeight, button.height);
            maxButtonWidth = Math.max(maxButtonWidth, button.width);
        });
        var buttonsWidth = buttons.length * maxButtonWidth + this.spacing.x * (buttons.length - 1);
        this.title.width = Math.max(buttonsWidth, this.title.width);
        this.title.text = this._pending.title;
        this.body.width = Math.max(this.title.width, this.body.width);
        this.body.docking.y = this.title.docking.y + this.title.height + this.spacing.y;
        this.body.text = this._pending.body;
        // there is an error in case body text is empty
        if (this.body.text === "") {
            this.body.text = ".";
            this.body.visible = false;
        }
        else {
            this.body.visible = true;
        }
        var totalWidth = Math.max(buttonsWidth, this.title.width, this.body.width);
        var totalHeight = this.title.height + this.body.height + maxButtonHeight + this.spacing.y * 2;
        buttons.forEach(function (button, index) {
            // resize button
            button.nineSliceMinSize.x = maxButtonWidth;
            button.label = button.label;
            // position button
            button.docking.x =
                (totalWidth - buttonsWidth) * 0.5 +
                    (maxButtonWidth + _this.spacing.x) * index +
                    _this.padding.x;
            button.docking.y = -_this.padding.height;
            // enable button
            button.enabled = true;
        });
        this.background.width = totalWidth + this.padding.x + this.padding.width;
        this.background.height = totalHeight + this.padding.y + this.padding.height;
        this.dockingBounds.setBounds(this.background.width, this.background.height);
    };
    MessagePopin.prototype.addOverlay = function () {
        if (this.parent) {
            this.parent.addChild(this.overlay);
            // move to foreground
            this.parent.addChild(this);
        }
    };
    MessagePopin.prototype.removeOverlay = function () {
        if (this.parent && this.overlay.parent) {
            this.parent.removeChild(this.overlay);
        }
    };
    MessagePopin.prototype.buttonsSetEnabled = function (value) {
        // this.closeButton.interactive = value;
        this._buttons.forEach(function (button) { return (button.enabled = value); });
    };
    MessagePopin.prototype.buttonsSetInteractive = function (value) {
        // this.closeButton.interactive = value;
        this._buttons.forEach(function (button) { return (button.interactive = value); });
    };
    MessagePopin.prototype.removeButtons = function () {
        var _this = this;
        this._buttons.forEach(function (button) {
            if (button.parent) {
                _this.removeChild(button);
                button.interactive = false;
                button.removeAllListeners();
                button.destroy();
            }
        });
        this._buttonsStack = [];
        this._buttons = [];
    };
    MessagePopin.ERROR_NO_POPIN = "Error: requested popin doesn't exist in i18n";
    return MessagePopin;
}(pixi_js__WEBPACK_IMPORTED_MODULE_0__["Container"]));



/***/ }),

/***/ "./src/adaptativeVisualIdentity/identity.ts":
/*!**************************************************!*\
  !*** ./src/adaptativeVisualIdentity/identity.ts ***!
  \**************************************************/
/*! no exports provided */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);



/***/ }),

/***/ "./src/adaptativeVisualIdentity/index.ts":
/*!***********************************************!*\
  !*** ./src/adaptativeVisualIdentity/index.ts ***!
  \***********************************************/
/*! exports provided: AdaptativeVisualIdentity, EVisualIdentityEvent, EVisualIdentityAction, MessagePopin */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _adaptativeVisualIdentity__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./adaptativeVisualIdentity */ "./src/adaptativeVisualIdentity/adaptativeVisualIdentity.ts");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "AdaptativeVisualIdentity", function() { return _adaptativeVisualIdentity__WEBPACK_IMPORTED_MODULE_0__["AdaptativeVisualIdentity"]; });

/* harmony import */ var _events__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./events */ "./src/adaptativeVisualIdentity/events.ts");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "EVisualIdentityEvent", function() { return _events__WEBPACK_IMPORTED_MODULE_1__["EVisualIdentityEvent"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "EVisualIdentityAction", function() { return _events__WEBPACK_IMPORTED_MODULE_1__["EVisualIdentityAction"]; });

/* harmony import */ var _identity__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./identity */ "./src/adaptativeVisualIdentity/identity.ts");
/* empty/unused harmony star reexport *//* harmony import */ var _identities_fgs_components_messagePopin__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./identities/fgs/components/messagePopin */ "./src/adaptativeVisualIdentity/identities/fgs/components/messagePopin.ts");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "MessagePopin", function() { return _identities_fgs_components_messagePopin__WEBPACK_IMPORTED_MODULE_3__["MessagePopin"]; });







/***/ }),

/***/ "./src/com/com.ts":
/*!************************!*\
  !*** ./src/com/com.ts ***!
  \************************/
/*! exports provided: Com */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Com", function() { return Com; });
/* harmony import */ var _falcon_bridge__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @falcon/bridge */ "@falcon/bridge");
/* harmony import */ var _falcon_bridge__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_falcon_bridge__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var i18next__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! i18next */ "i18next");
/* harmony import */ var i18next__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(i18next__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var _gdk_core__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @gdk/core */ "@gdk/core");
/* harmony import */ var _gdk_core__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(_gdk_core__WEBPACK_IMPORTED_MODULE_2__);
/* harmony import */ var _messageManager__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./messageManager */ "./src/com/messageManager/index.ts");
/* harmony import */ var _popin__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./popin */ "./src/com/popin/index.ts");
var __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};
var __generator = (undefined && undefined.__generator) || function (thisArg, body) {
    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;
    return g = { next: verb(0), "throw": verb(1), "return": verb(2) }, typeof Symbol === "function" && (g[Symbol.iterator] = function() { return this; }), g;
    function verb(n) { return function (v) { return step([n, v]); }; }
    function step(op) {
        if (f) throw new TypeError("Generator is already executing.");
        while (g && (g = 0, op[0] && (_ = 0)), _) try {
            if (f = 1, y && (t = op[0] & 2 ? y["return"] : op[0] ? y["throw"] || ((t = y["return"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;
            if (y = 0, t) op = [op[0] & 2, t.value];
            switch (op[0]) {
                case 0: case 1: t = op; break;
                case 4: _.label++; return { value: op[1], done: false };
                case 5: _.label++; y = op[1]; op = [0]; continue;
                case 7: op = _.ops.pop(); _.trys.pop(); continue;
                default:
                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }
                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }
                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }
                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }
                    if (t[2]) _.ops.pop();
                    _.trys.pop(); continue;
            }
            op = body.call(thisArg, _);
        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }
        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };
    }
};





var Com = /** @class */ (function () {
    function Com(game) {
        /**
         * Bridge reference used to communicate with the host and request platforms.
         */
        this.bridge = null;
        /**
         * Array of notifications populated once a request has been finished.
         */
        this.notifications = [];
        /**
         * The active language used by the game.
         */
        this.activeLanguage = "fr";
        /**
         * Message manager
         */
        this.messageManager = new _messageManager__WEBPACK_IMPORTED_MODULE_3__["MessageManager"](this);
        /**
         * User information object got in the .init function to keep user's informations.
         */
        this.userInformation = null;
        this.game = game;
    }
    /**
     * It initiates the communication between the host and the game using the
     * proxy channel and load the file that load the game.
     *
     * In prod it is used like this: `<body onload="falcon.game.bridge.initialize()">`.
     */
    Com.initialize = function () {
        return _falcon_bridge__WEBPACK_IMPORTED_MODULE_0__["Bridge"].initialize();
    };
    /**
     * After being load the game should get a BridgeImpl instance that merge `platform` and
     * `channel` implementation (ie: createBet, ..., getLocaleInformations, ...)
     */
    Com.prototype.init = function () {
        return __awaiter(this, void 0, void 0, function () {
            var _a, e_1;
            return __generator(this, function (_b) {
                switch (_b.label) {
                    case 0:
                        _b.trys.push([0, 2, , 3]);
                        // Get bridge
                        this.bridge = _falcon_bridge__WEBPACK_IMPORTED_MODULE_0__["Bridge"].getBridge();
                        // Active language @TODO remove as any when bridge is up to date in typings
                        _a = this;
                        return [4 /*yield*/, this.bridge.getCurrentGameConfiguration()];
                    case 1:
                        // Active language @TODO remove as any when bridge is up to date in typings
                        _a.activeLanguage = (_b.sent()).selectedLocale;
                        return [3 /*break*/, 3];
                    case 2:
                        e_1 = _b.sent();
                        this.onError(e_1);
                        throw e_1;
                    case 3: return [2 /*return*/];
                }
            });
        });
    };
    /**
     * Inits the com (bridge) locales containing the server errors etc.
     */
    Com.prototype.initI18n = function () {
        return __awaiter(this, void 0, void 0, function () {
            var locales;
            return __generator(this, function (_a) {
                switch (_a.label) {
                    case 0: return [4 /*yield*/, this.bridge.loadLocales(this.activeLanguage)];
                    case 1:
                        locales = _a.sent();
                        i18next__WEBPACK_IMPORTED_MODULE_1___default.a.addResourceBundle(this.activeLanguage, "game", locales, true, false);
                        return [2 /*return*/];
                }
            });
        });
    };
    /**
     * Returns the current player's purse.
     */
    Com.prototype.getPurse = function () {
        return __awaiter(this, void 0, void 0, function () {
            var e_2;
            return __generator(this, function (_a) {
                switch (_a.label) {
                    case 0:
                        _a.trys.push([0, 2, , 3]);
                        return [4 /*yield*/, this.bridge.channel.getPurseInformation()];
                    case 1: return [2 /*return*/, (_a.sent()).displayedAmount];
                    case 2:
                        e_2 = _a.sent();
                        return [2 /*return*/, null];
                    case 3: return [2 /*return*/];
                }
            });
        });
    };
    /**
     * Get avatar url for id
     * @param id
     */
    Com.prototype.getAvatarUrl = function (id) {
        return this.bridge.platform.getAvatarUrl(id);
    };
    /**
     * Get player currency
     * @param currencyCode
     * @param playerId
     * @param serviceName
     */
    Com.prototype.getPlayerCurrency = function (currencyCode, playerId, serviceName) {
        return __awaiter(this, void 0, void 0, function () {
            var e_3;
            return __generator(this, function (_a) {
                switch (_a.label) {
                    case 0:
                        _a.trys.push([0, 2, , 3]);
                        return [4 /*yield*/, this.bridge.platform.getPlayerCurrency(currencyCode, playerId, serviceName, this.bridge.channel.lotteryCode)];
                    case 1: return [2 /*return*/, _a.sent()];
                    case 2:
                        e_3 = _a.sent();
                        return [2 /*return*/, null];
                    case 3: return [2 /*return*/];
                }
            });
        });
    };
    /**
     * Returns the current player's information.
     * null if the player is not authenticated
     */
    Com.prototype.getUserInformation = function () {
        return __awaiter(this, void 0, void 0, function () {
            return __generator(this, function (_a) {
                return [2 /*return*/, this.bridge.getUserInformation()];
            });
        });
    };
    /**
     * Has to be called before buying a ticket in real money
     * @returns promise
     * The lottery must resolve whenever it wants the player to continuer with his bet
     * The lottery must reject if ever it wants to cancel the player's bet process
     */
    Com.prototype.preBet = function (betRequest) {
        return __awaiter(this, void 0, void 0, function () {
            return __generator(this, function (_a) {
                return [2 /*return*/, this.bridge.preBet(betRequest)];
            });
        });
    };
    /**
     * Request a new game mode
     *  - if current game mode is already the one, it will do nothing
     *  - otherwise creates the dedicated IF session
     * Resolves when done, with the new current GameMode
     * @param mode: one of the two EGameMode
     */
    Com.prototype.updateGameMode = function (mode) {
        return __awaiter(this, void 0, void 0, function () {
            return __generator(this, function (_a) {
                switch (_a.label) {
                    case 0: return [4 /*yield*/, this.bridge.updateGameMode(mode)];
                    case 1: return [2 /*return*/, _a.sent()];
                }
            });
        });
    };
    /**
     * Return the current game mode
     * Resolves when done, with the new current GameMode
     */
    Com.prototype.getGameMode = function () {
        return this.bridge.getGameMode();
    };
    /**
     * Retrieve open game parameters
     */
    Com.prototype.getOpenGameParameters = function () {
        return this.bridge.getOpenGameParameters();
    };
    /**
     * Retrieve ticket for replay if any
     */
    Com.prototype.getTicketToReplay = function (demo) {
        if (demo === void 0) { demo = false; }
        return __awaiter(this, void 0, void 0, function () {
            var ticketId, response, e_4;
            return __generator(this, function (_a) {
                switch (_a.label) {
                    case 0:
                        ticketId = this.bridge.getTicketIdToReplay();
                        if (ticketId === null || demo) {
                            return [2 /*return*/, null];
                        }
                        _a.label = 1;
                    case 1:
                        _a.trys.push([1, 3, , 4]);
                        return [4 /*yield*/, this.bridge.platform.getItgTicket(ticketId)];
                    case 2:
                        response = _a.sent();
                        if (response) {
                            this.populateNotifications(response);
                        }
                        return [2 /*return*/, response];
                    case 3:
                        e_4 = _a.sent();
                        this.onError(e_4);
                        throw e_4;
                    case 4: return [2 /*return*/];
                }
            });
        });
    };
    /**
     * Creates an ITG bet request.
     * @param options the options object to send in the ITG bet request.
     */
    Com.prototype.createItgBet = function (options) {
        return __awaiter(this, void 0, void 0, function () {
            var response, e_5;
            return __generator(this, function (_a) {
                switch (_a.label) {
                    case 0:
                        _a.trys.push([0, 2, , 3]);
                        return [4 /*yield*/, this.bridge.platform.createITGBet(options)];
                    case 1:
                        response = _a.sent();
                        this.populateNotifications(response);
                        return [2 /*return*/, response];
                    case 2:
                        e_5 = _a.sent();
                        this.onError(e_5);
                        throw e_5;
                    case 3: return [2 /*return*/];
                }
            });
        });
    };
    /**
     * Gets all the available tickets from the current user.
     * @param serviceName the service name associated to the ticket.
     */
    Com.prototype.getItgTickets = function (serviceName, demo) {
        if (demo === void 0) { demo = false; }
        return __awaiter(this, void 0, void 0, function () {
            var response, e_6;
            return __generator(this, function (_a) {
                switch (_a.label) {
                    case 0:
                        if (demo) {
                            return [2 /*return*/, []];
                        }
                        _a.label = 1;
                    case 1:
                        _a.trys.push([1, 3, , 4]);
                        return [4 /*yield*/, this.bridge.platform.getItgTickets(serviceName)];
                    case 2:
                        response = _a.sent();
                        this.populateNotifications(response);
                        return [2 /*return*/, response];
                    case 3:
                        e_6 = _a.sent();
                        this.onError(e_6);
                        throw e_6;
                    case 4: return [2 /*return*/];
                }
            });
        });
    };
    /**
     * Gets the existing ticket identified by the given ticket id.
     * @param ticketId the id the opened ticket to get.
     */
    Com.prototype.getItgTicket = function (ticketId) {
        return __awaiter(this, void 0, void 0, function () {
            var response, e_7;
            return __generator(this, function (_a) {
                switch (_a.label) {
                    case 0:
                        _a.trys.push([0, 2, , 3]);
                        return [4 /*yield*/, this.bridge.platform.getItgTicket(ticketId)];
                    case 1:
                        response = _a.sent();
                        this.populateNotifications(response);
                        return [2 /*return*/, response];
                    case 2:
                        e_7 = _a.sent();
                        this.onError(e_7);
                        throw e_7;
                    case 3: return [2 /*return*/];
                }
            });
        });
    };
    /**
     * Updates the existing ticket according to the given bet request.
     * @param options the options object to send in the ITG bet request.
     * @param ticketId the id of the ticket to update
     * @param showError display an error message on request failure
     */
    Com.prototype.updateItgTicket = function (options, ticketId, showError) {
        if (showError === void 0) { showError = true; }
        return __awaiter(this, void 0, void 0, function () {
            var response, e_8;
            return __generator(this, function (_a) {
                switch (_a.label) {
                    case 0:
                        _a.trys.push([0, 2, , 3]);
                        return [4 /*yield*/, this.bridge.platform.updateItgBet(options, ticketId)];
                    case 1:
                        response = _a.sent();
                        this.populateNotifications(response);
                        return [2 /*return*/, response];
                    case 2:
                        e_8 = _a.sent();
                        if (showError) {
                            this.onError(e_8);
                        }
                        throw e_8;
                    case 3: return [2 /*return*/];
                }
            });
        });
    };
    /**
     * Claims an ITG ticket.
     * @param options the options object to send in the ITG claim request
     * @param ticketId the id of the ticket to claim.
     */
    Com.prototype.claimItgBet = function (options, ticketId) {
        return __awaiter(this, void 0, void 0, function () {
            var response, e_9;
            return __generator(this, function (_a) {
                switch (_a.label) {
                    case 0:
                        _a.trys.push([0, 2, , 3]);
                        return [4 /*yield*/, this.bridge.platform.claimItgBet(options, ticketId)];
                    case 1:
                        response = _a.sent();
                        this.populateNotifications(response);
                        return [2 /*return*/, response];
                    case 2:
                        e_9 = _a.sent();
                        this.onError(e_9);
                        throw e_9;
                    case 3: return [2 /*return*/];
                }
            });
        });
    };
    /**
     * Creates a MOTORS bet request (start).
     * @param options the options object to send in the MOTORS bet request.
     */
    Com.prototype.createMtrBet = function (options) {
        return __awaiter(this, void 0, void 0, function () {
            var response, e_10;
            return __generator(this, function (_a) {
                switch (_a.label) {
                    case 0:
                        _a.trys.push([0, 2, , 3]);
                        return [4 /*yield*/, this.bridge.platform.createMtrBet(options)];
                    case 1:
                        response = _a.sent();
                        this.populateNotifications(response);
                        return [2 /*return*/, response];
                    case 2:
                        e_10 = _a.sent();
                        this.onError(e_10);
                        return [3 /*break*/, 3];
                    case 3: return [2 /*return*/];
                }
            });
        });
    };
    /**
     * Returns the gamif context associated to the given service name.
     * @param serviceName the service name to request.
     */
    Com.prototype.getContext = function (serviceName) {
        return __awaiter(this, void 0, void 0, function () {
            var response, e_11;
            return __generator(this, function (_a) {
                switch (_a.label) {
                    case 0:
                        _a.trys.push([0, 2, , 3]);
                        return [4 /*yield*/, this.bridge.platform.getGamifContext({
                                applicationId: "GAM",
                                serviceName: serviceName,
                            })];
                    case 1:
                        response = _a.sent();
                        this.populateNotifications(response);
                        return [2 /*return*/, response];
                    case 2:
                        e_11 = _a.sent();
                        this.onError(e_11);
                        return [3 /*break*/, 3];
                    case 3: return [2 /*return*/];
                }
            });
        });
    };
    /**
     * Get model of the given Motors game informations (service name and application Id)
     * @param options
     */
    Com.prototype.getModel = function (options, demoMode) {
        return __awaiter(this, void 0, void 0, function () {
            var response, e_12;
            return __generator(this, function (_a) {
                switch (_a.label) {
                    case 0:
                        _a.trys.push([0, 2, , 3]);
                        return [4 /*yield*/, this.bridge.platform.getMtrModel(options, demoMode)];
                    case 1:
                        response = _a.sent();
                        this.populateNotifications(response);
                        return [2 /*return*/, response];
                    case 2:
                        e_12 = _a.sent();
                        this.onError(e_12);
                        return [3 /*break*/, 3];
                    case 3: return [2 /*return*/];
                }
            });
        });
    };
    /**
     * Get information about presto ticket
     */
    Com.prototype.getPrsTicketInfos = function () {
        return __awaiter(this, void 0, void 0, function () {
            var response, e_13;
            return __generator(this, function (_a) {
                switch (_a.label) {
                    case 0:
                        _a.trys.push([0, 2, , 3]);
                        return [4 /*yield*/, this.bridge.platform.getPrsTicketInfos()];
                    case 1:
                        response = _a.sent();
                        this.populateNotifications(response);
                        return [2 /*return*/, response];
                    case 2:
                        e_13 = _a.sent();
                        this.onError(e_13);
                        return [3 /*break*/, 3];
                    case 3: return [2 /*return*/];
                }
            });
        });
    };
    /**
     * Retrieve ticket for replay if any
     */
    Com.prototype.getMtrSessionToReplay = function (service, demoMode) {
        if (demoMode === void 0) { demoMode = false; }
        return __awaiter(this, void 0, void 0, function () {
            var sessionId, session, e_14;
            return __generator(this, function (_a) {
                switch (_a.label) {
                    case 0:
                        sessionId = this.bridge.getTicketIdToReplay();
                        if (typeof sessionId !== "number" && typeof sessionId !== "string") {
                            return [2 /*return*/, undefined];
                        }
                        _a.label = 1;
                    case 1:
                        _a.trys.push([1, 3, , 4]);
                        return [4 /*yield*/, this.bridge.platform.getMtrSession(service, demoMode, sessionId.toString())];
                    case 2:
                        session = _a.sent();
                        return [2 /*return*/, session];
                    case 3:
                        e_14 = _a.sent();
                        this.onError(e_14);
                        throw e_14;
                    case 4: return [2 /*return*/];
                }
            });
        });
    };
    /**
     * Get active sessions for the given service name and application Id.
     * @template TGameData Response game data.
     * @param service
     * @param _showError
     * @param demoMode
     */
    Com.prototype.getMtrSession = function (service, _showError, demoMode) {
        if (_showError === void 0) { _showError = true; }
        if (demoMode === void 0) { demoMode = false; }
        return __awaiter(this, void 0, void 0, function () {
            var session, e_15;
            return __generator(this, function (_a) {
                switch (_a.label) {
                    case 0:
                        _a.trys.push([0, 2, , 3]);
                        return [4 /*yield*/, this.bridge.platform.getMtrSession(service, demoMode)];
                    case 1:
                        session = _a.sent();
                        return [2 /*return*/, session];
                    case 2:
                        e_15 = _a.sent();
                        this.onError(e_15);
                        return [3 /*break*/, 3];
                    case 3: return [2 /*return*/];
                }
            });
        });
    };
    /**
     * Perform an execute request (update bet).
     * @template TEventResponse Response event response
     * @template TEventParameters Event parameters
     * @param updateBetRequest the request options (service name, application id)
     * @param showError determines if the com module should show a popin when the response is an error or failed
     */
    Com.prototype.updateMtrBet = function (updateBetRequest, showError) {
        if (showError === void 0) { showError = true; }
        return __awaiter(this, void 0, void 0, function () {
            var response, e_16, text;
            return __generator(this, function (_a) {
                switch (_a.label) {
                    case 0:
                        _a.trys.push([0, 2, , 3]);
                        return [4 /*yield*/, this.bridge.platform.updateMtrBet(updateBetRequest)];
                    case 1:
                        response = _a.sent();
                        this.populateNotifications(response);
                        return [2 /*return*/, response];
                    case 2:
                        e_16 = _a.sent();
                        if (!showError) {
                            throw e_16;
                        }
                        text = this.t("refresh-motors", "error");
                        _gdk_core__WEBPACK_IMPORTED_MODULE_2__["tracker"].track(new _gdk_core__WEBPACK_IMPORTED_MODULE_2__["ErrorEvent"](text));
                        this.messageManager
                            .display({
                            code: undefined,
                            type: _messageManager__WEBPACK_IMPORTED_MODULE_3__["EMessageType"].Immediate,
                            popup: {
                                level: _popin__WEBPACK_IMPORTED_MODULE_4__["EPopinLevel"].Error,
                                text: text,
                                closable: false,
                                buttons: [
                                    {
                                        label: this.t("refresh", "ui"),
                                        action: _popin__WEBPACK_IMPORTED_MODULE_4__["PopinButtonAction"].RefreshGame,
                                    },
                                ],
                            },
                        })
                            .finally();
                        return [3 /*break*/, 3];
                    case 3: return [2 /*return*/];
                }
            });
        });
    };
    /**
     *  Gets the current variant settings of the given MTP game (service name).
     * @param options the options containing the applicationId and the service name.
     */
    Com.prototype.getMtpParameters = function (options) {
        return __awaiter(this, void 0, void 0, function () {
            var response, e_17;
            return __generator(this, function (_a) {
                switch (_a.label) {
                    case 0:
                        _a.trys.push([0, 2, , 3]);
                        return [4 /*yield*/, this.bridge.platform.getMtpModel(options)];
                    case 1:
                        response = _a.sent();
                        this.populateNotifications(response);
                        return [2 /*return*/, response];
                    case 2:
                        e_17 = _a.sent();
                        this.onError(e_17);
                        throw e_17;
                    case 3: return [2 /*return*/];
                }
            });
        });
    };
    /**
     * Gets the current list of active rooms for the player according to the given service name.
     * @param options the options containing the applicationId and the serivce name.
     */
    Com.prototype.getMtpRooms = function (options) {
        return __awaiter(this, void 0, void 0, function () {
            var response, e_18;
            return __generator(this, function (_a) {
                switch (_a.label) {
                    case 0:
                        _a.trys.push([0, 2, , 3]);
                        return [4 /*yield*/, this.bridge.platform.getMtpRooms(options)];
                    case 1:
                        response = _a.sent();
                        this.populateNotifications(response);
                        return [2 /*return*/, response];
                    case 2:
                        e_18 = _a.sent();
                        this.onError(e_18);
                        throw e_18;
                    case 3: return [2 /*return*/];
                }
            });
        });
    };
    /**
     * Enters to a room and bets according to the given bet informations.
     * @param options the options containing the room informations to enter and the bet informations.
     */
    Com.prototype.enterMtpRoomAndBet = function (options) {
        return __awaiter(this, void 0, void 0, function () {
            var response, e_19;
            return __generator(this, function (_a) {
                switch (_a.label) {
                    case 0:
                        _a.trys.push([0, 2, , 3]);
                        return [4 /*yield*/, this.bridge.platform.enterMtpRoomAndBet(options)];
                    case 1:
                        response = _a.sent();
                        this.populateNotifications(response);
                        return [2 /*return*/, response];
                    case 2:
                        e_19 = _a.sent();
                        this.onError(e_19);
                        throw e_19;
                    case 3: return [2 /*return*/];
                }
            });
        });
    };
    /**
     * Creates a MTP bet on the user entered the room.
     * @param options the options containing the bet informations.
     */
    Com.prototype.createMtpBet = function (options) {
        return __awaiter(this, void 0, void 0, function () {
            var response, e_20;
            return __generator(this, function (_a) {
                switch (_a.label) {
                    case 0:
                        _a.trys.push([0, 2, , 3]);
                        return [4 /*yield*/, this.bridge.platform.createMtpBet(options)];
                    case 1:
                        response = _a.sent();
                        this.populateNotifications(response);
                        return [2 /*return*/, response];
                    case 2:
                        e_20 = _a.sent();
                        this.onError(e_20);
                        throw e_20;
                    case 3: return [2 /*return*/];
                }
            });
        });
    };
    /**
     * Gets the current session object of the given MTP game at the given roomId.
     * @param options the options containing the service name.
     * @param roomId the id of the room containing the session to retrieve.
     */
    Com.prototype.getMtpSession = function (options, roomId) {
        return __awaiter(this, void 0, void 0, function () {
            var response, e_21;
            return __generator(this, function (_a) {
                switch (_a.label) {
                    case 0:
                        _a.trys.push([0, 2, , 3]);
                        return [4 /*yield*/, this.bridge.platform.getMtpSession(options, roomId)];
                    case 1:
                        response = _a.sent();
                        this.populateNotifications(response);
                        return [2 /*return*/, response];
                    case 2:
                        e_21 = _a.sent();
                        this.onError(e_21);
                        throw e_21;
                    case 3: return [2 /*return*/];
                }
            });
        });
    };
    /**
     * Updates the MTP bet request (typically a new choice by the player in the game).
     * @param options the informations containing the data to update for the given MTP game.
     */
    Com.prototype.updateMtpBet = function (options) {
        return __awaiter(this, void 0, void 0, function () {
            var response, e_22;
            return __generator(this, function (_a) {
                switch (_a.label) {
                    case 0:
                        _a.trys.push([0, 2, , 3]);
                        return [4 /*yield*/, this.bridge.platform.updateMtpBet(options)];
                    case 1:
                        response = _a.sent();
                        this.populateNotifications(response);
                        return [2 /*return*/, response];
                    case 2:
                        e_22 = _a.sent();
                        this.onError(e_22);
                        throw e_22;
                    case 3: return [2 /*return*/];
                }
            });
        });
    };
    /**
     * Creates and returns an initialized channel for SSE or WebSocket connection
     * @param settings the push settings (host, port, etc.)
     */
    Com.prototype.getNotificationsChannel = function (settings) {
        return __awaiter(this, void 0, void 0, function () {
            return __generator(this, function (_a) {
                try {
                    return [2 /*return*/, this.bridge.platform.createNotificationsChannel(settings)];
                }
                catch (e) {
                    this.onError(e);
                    throw e;
                }
                return [2 /*return*/];
            });
        });
    };
    /**
     * Enter to a room identified in the options parameter.
     * @param options the request parameters (service name, variant etc.)
     */
    Com.prototype.enterMtpRoom = function (options) {
        return __awaiter(this, void 0, void 0, function () {
            var response, e_23;
            return __generator(this, function (_a) {
                switch (_a.label) {
                    case 0:
                        _a.trys.push([0, 2, , 3]);
                        return [4 /*yield*/, this.bridge.platform.enterMtpRoom(options)];
                    case 1:
                        response = _a.sent();
                        this.populateNotifications(response);
                        return [2 /*return*/, response];
                    case 2:
                        e_23 = _a.sent();
                        this.onError(e_23);
                        throw e_23;
                    case 3: return [2 /*return*/];
                }
            });
        });
    };
    /**
     * Returns the informations (avatar, pseudo, etc.) of the current player
     */
    Com.prototype.getCurrentPlayerInformations = function () {
        return __awaiter(this, void 0, void 0, function () {
            var response, e_24;
            return __generator(this, function (_a) {
                switch (_a.label) {
                    case 0:
                        _a.trys.push([0, 2, , 3]);
                        return [4 /*yield*/, this.bridge.platform.getCurrentPlayerInfo()];
                    case 1:
                        response = _a.sent();
                        this.populateNotifications(response);
                        return [2 /*return*/, response];
                    case 2:
                        e_24 = _a.sent();
                        this.onError(e_24);
                        throw e_24;
                    case 3: return [2 /*return*/];
                }
            });
        });
    };
    /**
     * Returns the informations (avatar, pseudo, etc.) of the given players identified by their Ids.
     * @param playersIds the ids of the player to retrieve the informations.
     */
    Com.prototype.getPlayersInformations = function (playersIds) {
        return __awaiter(this, void 0, void 0, function () {
            var response, e_25;
            return __generator(this, function (_a) {
                switch (_a.label) {
                    case 0:
                        _a.trys.push([0, 2, , 3]);
                        return [4 /*yield*/, this.bridge.platform.getPlayersInfo(playersIds)];
                    case 1:
                        response = _a.sent();
                        this.populateNotifications(response);
                        return [2 /*return*/, response];
                    case 2:
                        e_25 = _a.sent();
                        this.onError(e_25);
                        throw e_25;
                    case 3: return [2 /*return*/];
                }
            });
        });
    };
    /**
     * Trigger action on bridge
     * @param action the action's name
     * @param params parameters to send to the action
     */
    Com.prototype.trigger = function (action, params) {
        var _this = this;
        var result = this.bridge.executeAction(action, params);
        // executeAction returns a Promise or nothing
        if (result) {
            result.catch(function (e) {
                _this.onError(e);
            });
        }
    };
    /**
     * Helper to access getLocalizedString
     * @param key in the bridge configuration
     * @param scope of the key it may be server, error or ui
     */
    Com.prototype.t = function (key, scope) {
        if (!this.activeLanguage) {
            throw new Error("no active language sets");
        }
        var path = "bridge__".concat(scope, "__").concat(key);
        if (i18next__WEBPACK_IMPORTED_MODULE_1___default.a.exists(path, { keySeparator: "__" })) {
            return i18next__WEBPACK_IMPORTED_MODULE_1___default.a.t(path, { keySeparator: "__" });
        }
        else {
            return i18next__WEBPACK_IMPORTED_MODULE_1___default.a.t("bridge.error.default");
        }
    };
    /**
     * Shows the notifications from server
     * For example: AUTOWITHDRAWAL or SUSPENSION_TRIGGERED
     */
    Com.prototype.showNotification = function (callback) {
        return __awaiter(this, void 0, void 0, function () {
            var id;
            return __generator(this, function (_a) {
                switch (_a.label) {
                    case 0:
                        if (this.notifications.length === 0) {
                            if (callback) {
                                return [2 /*return*/, callback()];
                            }
                            return [2 /*return*/];
                        }
                        id = this.notifications.shift().id;
                        return [4 /*yield*/, this.messageManager.display({
                                code: id,
                                type: _messageManager__WEBPACK_IMPORTED_MODULE_3__["EMessageType"].Immediate,
                                popup: {
                                    level: _popin__WEBPACK_IMPORTED_MODULE_4__["EPopinLevel"].Info,
                                    text: this.t(id, "server"),
                                    buttons: [
                                        {
                                            label: this.t("close", "ui") || " Close",
                                            action: _popin__WEBPACK_IMPORTED_MODULE_4__["PopinButtonAction"].ClosePopin,
                                        },
                                    ],
                                },
                            })];
                    case 1:
                        _a.sent();
                        return [4 /*yield*/, this.showNotification(callback)];
                    case 2: return [2 /*return*/, _a.sent()];
                }
            });
        });
    };
    /**
     * Send the sounds status through the channel
     * @param soundStatus
     */
    Com.prototype.sendSoundStatus = function (soundStatus) {
        this.bridge.emitEvent("SOUND_STATUS", soundStatus);
    };
    /**
     * Show and track error message.
     * @param error Error catch when promise is rejected.
     */
    Com.prototype.onError = function (error) {
        var text = this.t("default", "error") || "Unknown error";
        if (error.code) {
            text = this.t(error.code, "error");
        }
        _gdk_core__WEBPACK_IMPORTED_MODULE_2__["tracker"].track(new _gdk_core__WEBPACK_IMPORTED_MODULE_2__["ErrorEvent"](text));
        this.messageManager
            .display({
            code: error ? error.code : "default",
            type: _messageManager__WEBPACK_IMPORTED_MODULE_3__["EMessageType"].Immediate,
            popup: {
                level: _popin__WEBPACK_IMPORTED_MODULE_4__["EPopinLevel"].Error,
                text: text,
                closable: false,
                buttons: [
                    {
                        label: this.t("close", "ui") || "Close game",
                        action: _popin__WEBPACK_IMPORTED_MODULE_4__["PopinButtonAction"].CloseGame,
                    },
                ],
            },
            context: error.context,
        })
            .catch(function () {
            // nothing to do in this case
        });
    };
    /**
     * populate Notifications.
     * @param response the response containing the notifications to draw later
     */
    Com.prototype.populateNotifications = function (response) {
        var messages = response.serverMessage;
        if (Array.isArray(messages) && messages.length > 0) {
            this.notifications = [];
            messages = messages.filter(function (m) { return m.id !== "NO_ACTION"; });
            if (messages.length > 0) {
                // legacy
                this.notifications.push(messages[0]);
            }
        }
        // handle inGameMessaging
        if (response.message) {
            this.messageManager.push(response.message).finally();
        }
    };
    return Com;
}());



/***/ }),

/***/ "./src/com/index.ts":
/*!**************************!*\
  !*** ./src/com/index.ts ***!
  \**************************/
/*! exports provided: Com, Popin, EPopinLevel, PopinButtonAction, PopinLinkTarget, EMessageType, MessageManager */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _com__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./com */ "./src/com/com.ts");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "Com", function() { return _com__WEBPACK_IMPORTED_MODULE_0__["Com"]; });

/* harmony import */ var _popin_index__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./popin/index */ "./src/com/popin/index.ts");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "Popin", function() { return _popin_index__WEBPACK_IMPORTED_MODULE_1__["Popin"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "EPopinLevel", function() { return _popin_index__WEBPACK_IMPORTED_MODULE_1__["EPopinLevel"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "PopinButtonAction", function() { return _popin_index__WEBPACK_IMPORTED_MODULE_1__["PopinButtonAction"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "PopinLinkTarget", function() { return _popin_index__WEBPACK_IMPORTED_MODULE_1__["PopinLinkTarget"]; });

/* harmony import */ var _messageManager_index__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./messageManager/index */ "./src/com/messageManager/index.ts");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "EMessageType", function() { return _messageManager_index__WEBPACK_IMPORTED_MODULE_2__["EMessageType"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "MessageManager", function() { return _messageManager_index__WEBPACK_IMPORTED_MODULE_2__["MessageManager"]; });







/***/ }),

/***/ "./src/com/messageManager/definitions.ts":
/*!***********************************************!*\
  !*** ./src/com/messageManager/definitions.ts ***!
  \***********************************************/
/*! exports provided: EMessageType */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "EMessageType", function() { return EMessageType; });
/**
 * When to display the message.
 */
var EMessageType;
(function (EMessageType) {
    /**
     * Immediatly after the call of the message manager.
     */
    EMessageType["Immediate"] = "immediate";
    /**
     * At the end of a game.
     */
    EMessageType["End"] = "end";
})(EMessageType || (EMessageType = {}));


/***/ }),

/***/ "./src/com/messageManager/index.ts":
/*!*****************************************!*\
  !*** ./src/com/messageManager/index.ts ***!
  \*****************************************/
/*! exports provided: EMessageType, MessageManager */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _definitions__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./definitions */ "./src/com/messageManager/definitions.ts");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "EMessageType", function() { return _definitions__WEBPACK_IMPORTED_MODULE_0__["EMessageType"]; });

/* harmony import */ var _messageManager__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./messageManager */ "./src/com/messageManager/messageManager.ts");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "MessageManager", function() { return _messageManager__WEBPACK_IMPORTED_MODULE_1__["MessageManager"]; });





/***/ }),

/***/ "./src/com/messageManager/messageManager.ts":
/*!**************************************************!*\
  !*** ./src/com/messageManager/messageManager.ts ***!
  \**************************************************/
/*! exports provided: MessageManager */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "MessageManager", function() { return MessageManager; });
/* harmony import */ var _definitions__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./definitions */ "./src/com/messageManager/definitions.ts");
/* harmony import */ var _popin_index__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../popin/index */ "./src/com/popin/index.ts");
var __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};
var __generator = (undefined && undefined.__generator) || function (thisArg, body) {
    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;
    return g = { next: verb(0), "throw": verb(1), "return": verb(2) }, typeof Symbol === "function" && (g[Symbol.iterator] = function() { return this; }), g;
    function verb(n) { return function (v) { return step([n, v]); }; }
    function step(op) {
        if (f) throw new TypeError("Generator is already executing.");
        while (g && (g = 0, op[0] && (_ = 0)), _) try {
            if (f = 1, y && (t = op[0] & 2 ? y["return"] : op[0] ? y["throw"] || ((t = y["return"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;
            if (y = 0, t) op = [op[0] & 2, t.value];
            switch (op[0]) {
                case 0: case 1: t = op; break;
                case 4: _.label++; return { value: op[1], done: false };
                case 5: _.label++; y = op[1]; op = [0]; continue;
                case 7: op = _.ops.pop(); _.trys.pop(); continue;
                default:
                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }
                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }
                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }
                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }
                    if (t[2]) _.ops.pop();
                    _.trys.pop(); continue;
            }
            op = body.call(thisArg, _);
        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }
        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };
    }
};


/**
 * InGame message manager. Displays popins.
 */
var MessageManager = /** @class */ (function () {
    function MessageManager(com) {
        this._messages = [];
        this._messageDisplayStack = Promise.resolve();
        this._com = com;
    }
    /**
     * Push one or multiples messages to be displayed immediatly or at the end of the game
     * regarding the provided configuration
     * @param message message.s to display
     */
    MessageManager.prototype.push = function (message) {
        return __awaiter(this, void 0, void 0, function () {
            var _this = this;
            return __generator(this, function (_a) {
                switch (_a.label) {
                    case 0:
                        if (!Array.isArray(message)) return [3 /*break*/, 2];
                        return [4 /*yield*/, Promise.all(message.map(function (each) { return _this._pushOne(each); }))];
                    case 1:
                        _a.sent();
                        return [3 /*break*/, 4];
                    case 2: return [4 /*yield*/, this._pushOne(message)];
                    case 3:
                        _a.sent();
                        _a.label = 4;
                    case 4: return [2 /*return*/];
                }
            });
        });
    };
    /**
     * Remove all messages waiting to be displayed.
     */
    MessageManager.prototype.reset = function () {
        this._messages.length = 0;
    };
    /**
     * Display all messages waiting for GameEnd event
     */
    MessageManager.prototype.onGameEnd = function () {
        return __awaiter(this, void 0, void 0, function () {
            var _this = this;
            return __generator(this, function (_a) {
                switch (_a.label) {
                    case 0: return [4 /*yield*/, Promise.all(this._messages.map(function (message) { return _this.display(message); }))];
                    case 1:
                        _a.sent();
                        this.reset();
                        return [2 /*return*/];
                }
            });
        });
    };
    /**
     * Display a popin message
     * We first ask the lottery frontsite to display the message
     * without positive response we handle the popin ourself
     * @param message message to display
     */
    MessageManager.prototype.display = function (message) {
        return __awaiter(this, void 0, void 0, function () {
            var _this = this;
            return __generator(this, function (_a) {
                switch (_a.label) {
                    case 0:
                        this._messageDisplayStack = this._messageDisplayStack.then(function () { return __awaiter(_this, void 0, void 0, function () {
                            var up_1;
                            var _this = this;
                            return __generator(this, function (_a) {
                                switch (_a.label) {
                                    case 0:
                                        this._com.game.pause("messagemanager");
                                        _a.label = 1;
                                    case 1:
                                        _a.trys.push([1, 3, , 5]);
                                        return [4 /*yield*/, new Promise(function (resolve, reject) {
                                                // bridge promises are shitty, so we have to wrap them to be able to await them
                                                _this._com.bridge.executeAction("OPEN_POPUP", message)
                                                    .then(resolve)
                                                    .catch(reject);
                                            })];
                                    case 2:
                                        _a.sent();
                                        return [3 /*break*/, 5];
                                    case 3:
                                        up_1 = _a.sent();
                                        this._com.game.showInteractivityOverlay();
                                        return [4 /*yield*/, _popin_index__WEBPACK_IMPORTED_MODULE_1__["Popin"].display(message.popup, {
                                                closeGame: function () {
                                                    _this._com.bridge.executeAction("CLOSE_GAME");
                                                },
                                                refreshGame: function () {
                                                    window.location.reload();
                                                },
                                            })];
                                    case 4:
                                        _a.sent();
                                        this._com.game.removeInteractivityOverlay();
                                        return [3 /*break*/, 5];
                                    case 5:
                                        this._com.game.unpause("messagemanager");
                                        return [2 /*return*/];
                                }
                            });
                        }); });
                        return [4 /*yield*/, this._messageDisplayStack];
                    case 1:
                        _a.sent();
                        return [2 /*return*/];
                }
            });
        });
    };
    MessageManager.prototype._pushOne = function (message) {
        return __awaiter(this, void 0, void 0, function () {
            return __generator(this, function (_a) {
                switch (_a.label) {
                    case 0:
                        if (!(message.type === _definitions__WEBPACK_IMPORTED_MODULE_0__["EMessageType"].Immediate)) return [3 /*break*/, 2];
                        return [4 /*yield*/, this.display(message)];
                    case 1:
                        _a.sent();
                        return [2 /*return*/];
                    case 2:
                        this._messages.push(message);
                        return [2 /*return*/];
                }
            });
        });
    };
    return MessageManager;
}());



/***/ }),

/***/ "./src/com/popin/definitions.ts":
/*!**************************************!*\
  !*** ./src/com/popin/definitions.ts ***!
  \**************************************/
/*! exports provided: EPopinLevel, PopinButtonAction, PopinLinkTarget */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "EPopinLevel", function() { return EPopinLevel; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "PopinButtonAction", function() { return PopinButtonAction; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "PopinLinkTarget", function() { return PopinLinkTarget; });
/**
 * Log level
 */
var EPopinLevel;
(function (EPopinLevel) {
    EPopinLevel["Info"] = "info";
    EPopinLevel["Warning"] = "warning";
    EPopinLevel["Error"] = "error";
})(EPopinLevel || (EPopinLevel = {}));
/**
 * List of actions available for a popin button.
 */
var PopinButtonAction;
(function (PopinButtonAction) {
    /**
     * Open a link.
     */
    PopinButtonAction["Link"] = "link";
    /**
     * Close the popin.
     */
    PopinButtonAction["ClosePopin"] = "closePopup";
    /**
     * Close the game through the bridge.
     */
    PopinButtonAction["CloseGame"] = "closeGame";
    /**
     * Refresh the game.
     */
    PopinButtonAction["RefreshGame"] = "refreshGame";
    /**
     * Call a callback with the popin as argument.
     */
    PopinButtonAction["Callback"] = "callback";
})(PopinButtonAction || (PopinButtonAction = {}));
/**
 * Set type of link.
 */
var PopinLinkTarget;
(function (PopinLinkTarget) {
    /**
     * Open the link in an another page.
     */
    PopinLinkTarget["Blank"] = "blank";
    /**
     * Open the link in the current page.
     */
    PopinLinkTarget["Self"] = "self";
})(PopinLinkTarget || (PopinLinkTarget = {}));


/***/ }),

/***/ "./src/com/popin/index.ts":
/*!********************************!*\
  !*** ./src/com/popin/index.ts ***!
  \********************************/
/*! exports provided: Popin, EPopinLevel, PopinButtonAction, PopinLinkTarget */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _popin__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./popin */ "./src/com/popin/popin.ts");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "Popin", function() { return _popin__WEBPACK_IMPORTED_MODULE_0__["Popin"]; });

/* harmony import */ var _definitions__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./definitions */ "./src/com/popin/definitions.ts");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "EPopinLevel", function() { return _definitions__WEBPACK_IMPORTED_MODULE_1__["EPopinLevel"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "PopinButtonAction", function() { return _definitions__WEBPACK_IMPORTED_MODULE_1__["PopinButtonAction"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "PopinLinkTarget", function() { return _definitions__WEBPACK_IMPORTED_MODULE_1__["PopinLinkTarget"]; });





/***/ }),

/***/ "./src/com/popin/popin.ts":
/*!********************************!*\
  !*** ./src/com/popin/popin.ts ***!
  \********************************/
/*! exports provided: Popin */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Popin", function() { return Popin; });
/* harmony import */ var _gdk_core__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @gdk/core */ "@gdk/core");
/* harmony import */ var _gdk_core__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_gdk_core__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var _definitions__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./definitions */ "./src/com/popin/definitions.ts");
/* harmony import */ var _style_less__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./style.less */ "./src/com/popin/style.less");
/* harmony import */ var _style_less__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(_style_less__WEBPACK_IMPORTED_MODULE_2__);
var __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};
var __generator = (undefined && undefined.__generator) || function (thisArg, body) {
    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;
    return g = { next: verb(0), "throw": verb(1), "return": verb(2) }, typeof Symbol === "function" && (g[Symbol.iterator] = function() { return this; }), g;
    function verb(n) { return function (v) { return step([n, v]); }; }
    function step(op) {
        if (f) throw new TypeError("Generator is already executing.");
        while (g && (g = 0, op[0] && (_ = 0)), _) try {
            if (f = 1, y && (t = op[0] & 2 ? y["return"] : op[0] ? y["throw"] || ((t = y["return"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;
            if (y = 0, t) op = [op[0] & 2, t.value];
            switch (op[0]) {
                case 0: case 1: t = op; break;
                case 4: _.label++; return { value: op[1], done: false };
                case 5: _.label++; y = op[1]; op = [0]; continue;
                case 7: op = _.ops.pop(); _.trys.pop(); continue;
                default:
                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }
                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }
                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }
                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }
                    if (t[2]) _.ops.pop();
                    _.trys.pop(); continue;
            }
            op = body.call(thisArg, _);
        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }
        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };
    }
};
var __values = (undefined && undefined.__values) || function(o) {
    var s = typeof Symbol === "function" && Symbol.iterator, m = s && o[s], i = 0;
    if (m) return m.call(o);
    if (o && typeof o.length === "number") return {
        next: function () {
            if (o && i >= o.length) o = void 0;
            return { value: o && o[i++], done: !o };
        }
    };
    throw new TypeError(s ? "Object is not iterable." : "Symbol.iterator is not defined.");
};



/**
 * InGame HTML Popin
 */
var Popin = /** @class */ (function () {
    function Popin(definition, actions) {
        this._definition = definition;
        this._actions = actions;
        this._configure();
        Popin.instances.push(this);
    }
    Object.defineProperty(Popin, "defaultOrientation", {
        /**
         * Define popin orientation. If not set, popin will follow natural page orientation.
         * If specified, and if it does not match page orientation, popups will be rotated
         * to fit with the new orientation.
         * This is useful when game orientation differs from device orientation.
         */
        set: function (orientation) {
            var e_1, _a;
            this._defaultOrientation = orientation;
            try {
                // update existing popins
                for (var _b = __values(Popin.instances), _c = _b.next(); !_c.done; _c = _b.next()) {
                    var instance = _c.value;
                    instance.orientation = orientation;
                }
            }
            catch (e_1_1) { e_1 = { error: e_1_1 }; }
            finally {
                try {
                    if (_c && !_c.done && (_a = _b.return)) _a.call(_b);
                }
                finally { if (e_1) throw e_1.error; }
            }
        },
        enumerable: false,
        configurable: true
    });
    /**
     * Instantiate and display a popin
     * @param definition popin definition
     * @param actions callback actions
     */
    Popin.display = function (definition, actions) {
        return __awaiter(this, void 0, void 0, function () {
            var popin;
            return __generator(this, function (_a) {
                switch (_a.label) {
                    case 0:
                        popin = new Popin(definition, actions);
                        return [4 /*yield*/, popin.display()];
                    case 1:
                        _a.sent();
                        return [2 /*return*/];
                }
            });
        });
    };
    Popin.prototype.dispose = function () {
        var index = Popin.instances.indexOf(this);
        if (index >= 0) {
            Popin.instances.splice(index, 1);
        }
    };
    Object.defineProperty(Popin.prototype, "orientation", {
        /**
         * Change popin orientation, rotate it if orientation is not the same as device
         * orientation (rotation is applied through css tranform, thanks to classes "portrait"
         * and "landscape").
         */
        set: function (orientation) {
            var popin = this._domElement.querySelector(".gdk-popin");
            if (popin !== null) {
                popin.classList.remove("portrait", "landscape");
                popin.classList.add(orientation);
            }
        },
        enumerable: false,
        configurable: true
    });
    /**
     * Display the popin
     */
    Popin.prototype.display = function () {
        return __awaiter(this, void 0, void 0, function () {
            var closed;
            var _this = this;
            return __generator(this, function (_a) {
                switch (_a.label) {
                    case 0:
                        closed = new Promise(function (resolve) {
                            _this._notifyClosed = resolve;
                        });
                        Popin.wrapper.appendChild(this._domElement);
                        // you have to wait some ticks to be able to trigger the fade-in animation
                        return [4 /*yield*/, new Promise(function (resolve) { return setTimeout(resolve, 10); })];
                    case 1:
                        // you have to wait some ticks to be able to trigger the fade-in animation
                        _a.sent();
                        this._domElement.classList.add("show");
                        return [4 /*yield*/, closed];
                    case 2:
                        _a.sent();
                        return [2 /*return*/];
                }
            });
        });
    };
    /**
     * Close the popin
     */
    Popin.prototype.close = function () {
        return __awaiter(this, void 0, void 0, function () {
            return __generator(this, function (_a) {
                switch (_a.label) {
                    case 0:
                        if (!this._domElement.classList.contains("show")) {
                            return [2 /*return*/];
                        }
                        // remove the show animation to trigger de fade-out animation
                        this._domElement.classList.remove("show");
                        this._notifyClosed();
                        return [4 /*yield*/, new Promise(function (resolve) { return setTimeout(resolve, 200); })];
                    case 1:
                        _a.sent();
                        Popin.wrapper.removeChild(this._domElement);
                        this.dispose();
                        return [2 /*return*/];
                }
            });
        });
    };
    Popin.prototype._configure = function () {
        var _a;
        this._domElement = document.createElement("div");
        this._domElement.setAttribute("class", "gdk-popin-background");
        var popin = document.createElement("div");
        popin.setAttribute("class", [
            "gdk-popin",
            "gdk-popin-" + this._definition.level.toString(),
            (_a = Popin._defaultOrientation) !== null && _a !== void 0 ? _a : "",
        ]
            .join(" ")
            .trim());
        popin.innerHTML += "<div class=\"gdk-popin-title\">".concat(this._definition.title || "&nbsp", "</div>");
        if (this._definition.titleStyle) {
            var title = popin.getElementsByClassName("gdk-popin-title")[0];
            _gdk_core__WEBPACK_IMPORTED_MODULE_0__["Tools"].assign(title.style, this._definition.titleStyle);
        }
        popin.innerHTML += "<div class=\"gdk-popin-text\">".concat(this._definition.content || this._definition.text || "&nbsp", "</div>");
        if (this._definition.textStyle) {
            var text = popin.getElementsByClassName("gdk-popin-text")[0];
            _gdk_core__WEBPACK_IMPORTED_MODULE_0__["Tools"].assign(text.style, this._definition.textStyle);
        }
        if (this._definition.buttons && this._definition.buttons.length) {
            var buttons = this._getButtons();
            popin.appendChild(buttons);
        }
        if (this._definition.closable !== false) {
            var closeCross = this._getCloseCross();
            popin.appendChild(closeCross);
        }
        if (this._definition.style) {
            _gdk_core__WEBPACK_IMPORTED_MODULE_0__["Tools"].assign(popin.style, this._definition.style);
        }
        this._domElement.appendChild(popin);
        if (this._definition.clickOutsideToClose) {
            var closeLayer = this._getCloseLayer();
            this._domElement.appendChild(closeLayer);
        }
    };
    Popin.prototype._getButtons = function () {
        var e_2, _a;
        var buttons = document.createElement("div");
        buttons.setAttribute("class", "gdk-popin-buttons");
        try {
            for (var _b = __values(this._definition.buttons), _c = _b.next(); !_c.done; _c = _b.next()) {
                var buttonDefinition = _c.value;
                buttons.appendChild(this._getButton(buttonDefinition));
            }
        }
        catch (e_2_1) { e_2 = { error: e_2_1 }; }
        finally {
            try {
                if (_c && !_c.done && (_a = _b.return)) _a.call(_b);
            }
            finally { if (e_2) throw e_2.error; }
        }
        return buttons;
    };
    Popin.prototype._getButton = function (definition) {
        var wrapper = document.createElement("div");
        wrapper.setAttribute("class", "gdk-popin-button-wrapper");
        wrapper.innerHTML = "<div class=\"gdk-popin-button gdk-popin-button-".concat(definition.action, "\">").concat(definition.label, "</div>");
        if (definition.style) {
            var button = wrapper.firstChild;
            _gdk_core__WEBPACK_IMPORTED_MODULE_0__["Tools"].assign(button.style, definition.style);
        }
        wrapper.firstChild.addEventListener("click", this._getButtonAction(definition));
        return wrapper;
    };
    Popin.prototype._getButtonAction = function (definition) {
        switch (definition.action) {
            case _definitions__WEBPACK_IMPORTED_MODULE_1__["PopinButtonAction"].ClosePopin: {
                return this.close.bind(this);
            }
            case _definitions__WEBPACK_IMPORTED_MODULE_1__["PopinButtonAction"].CloseGame: {
                return this._actions.closeGame;
            }
            case _definitions__WEBPACK_IMPORTED_MODULE_1__["PopinButtonAction"].RefreshGame: {
                return this._actions.refreshGame;
            }
            case _definitions__WEBPACK_IMPORTED_MODULE_1__["PopinButtonAction"].Callback: {
                return definition.callback.bind({}, this);
            }
            case _definitions__WEBPACK_IMPORTED_MODULE_1__["PopinButtonAction"].Link: {
                if (!definition.link) {
                    return function () { return undefined; };
                }
                if (definition.link.target === _definitions__WEBPACK_IMPORTED_MODULE_1__["PopinLinkTarget"].Self) {
                    return function () {
                        window.location.href = definition.link.url;
                    };
                }
                else {
                    return function () {
                        window.open(definition.link.url);
                    };
                }
            }
            default: {
                return function () { return undefined; };
            }
        }
    };
    Popin.prototype._getCloseCross = function () {
        var closeCross = document.createElement("a");
        closeCross.setAttribute("class", "gdk-popin-close");
        closeCross.addEventListener("click", this.close.bind(this));
        return closeCross;
    };
    Popin.prototype._getCloseLayer = function () {
        var closeLayer = document.createElement("div");
        closeLayer.setAttribute("class", "gdk-popin-click-layer");
        closeLayer.addEventListener("click", this.close.bind(this));
        return closeLayer;
    };
    Popin.instances = [];
    return Popin;
}());



/***/ }),

/***/ "./src/com/popin/style.less":
/*!**********************************!*\
  !*** ./src/com/popin/style.less ***!
  \**********************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {


var content = __webpack_require__(/*! !../../../../../node_modules/css-loader!../../../../../node_modules/less-loader/dist/cjs.js!./style.less */ "../../node_modules/css-loader/index.js!../../node_modules/less-loader/dist/cjs.js!./src/com/popin/style.less");

if(typeof content === 'string') content = [[module.i, content, '']];

var transform;
var insertInto;



var options = {"hmr":true}

options.transform = transform
options.insertInto = undefined;

var update = __webpack_require__(/*! ../../../../../node_modules/style-loader/lib/addStyles.js */ "../../node_modules/style-loader/lib/addStyles.js")(content, options);

if(content.locals) module.exports = content.locals;

if(false) {}

/***/ }),

/***/ "./src/ds/index.ts":
/*!*************************!*\
  !*** ./src/ds/index.ts ***!
  \*************************/
/*! exports provided: EGameStates, DSPopinsContainer */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _popinsContainer__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./popinsContainer */ "./src/ds/popinsContainer.ts");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "EGameStates", function() { return _popinsContainer__WEBPACK_IMPORTED_MODULE_0__["EGameStates"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "DSPopinsContainer", function() { return _popinsContainer__WEBPACK_IMPORTED_MODULE_0__["DSPopinsContainer"]; });





/***/ }),

/***/ "./src/ds/paginatedPopin.ts":
/*!**********************************!*\
  !*** ./src/ds/paginatedPopin.ts ***!
  \**********************************/
/*! exports provided: DSPaginatedPopin */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "DSPaginatedPopin", function() { return DSPaginatedPopin; });
/* harmony import */ var pixi_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! pixi.js */ "pixi.js");
/* harmony import */ var pixi_js__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(pixi_js__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var _gdk_core_pixi__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @gdk/core-pixi */ "@gdk/core-pixi");
/* harmony import */ var _gdk_core_pixi__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(_gdk_core_pixi__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var _popin__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./popin */ "./src/ds/popin.ts");
var __extends = (undefined && undefined.__extends) || (function () {
    var extendStatics = function (d, b) {
        extendStatics = Object.setPrototypeOf ||
            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||
            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };
        return extendStatics(d, b);
    };
    return function (d, b) {
        if (typeof b !== "function" && b !== null)
            throw new TypeError("Class extends value " + String(b) + " is not a constructor or null");
        extendStatics(d, b);
        function __() { this.constructor = d; }
        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
    };
})();
var __values = (undefined && undefined.__values) || function(o) {
    var s = typeof Symbol === "function" && Symbol.iterator, m = s && o[s], i = 0;
    if (m) return m.call(o);
    if (o && typeof o.length === "number") return {
        next: function () {
            if (o && i >= o.length) o = void 0;
            return { value: o && o[i++], done: !o };
        }
    };
    throw new TypeError(s ? "Object is not iterable." : "Symbol.iterator is not defined.");
};



var BUTTON_IDLE = "buttons/primary/idle";
var BUTTON_OVER = "buttons/primary/over";
var BUTTON_DISABLED = "buttons/primary/idle";
var LEFT_TOP_RIGHT = 30;
var BOTTOM = 40;
var BUTTONS_SPACE = 80;
var BULLETS_SPACE = 60;
var DEFAULT_COLOR = "#000000";
var BULLET_BUTTONS_HEIGHT = -150;
var BULLET_HEIGHT = -40;
var BULLET = "icons/color/bullet-";
var BULLET_ON = "".concat(BULLET, "on");
var BULLET_OFF = "".concat(BULLET, "off");
var CIRCLE = "backgrounds/white/circle";
var ARROW = "icons/color/arrow";
var DSPaginatedPopin = /** @class */ (function (_super) {
    __extends(DSPaginatedPopin, _super);
    function DSPaginatedPopin(options) {
        var _this = _super.call(this, options) || this;
        _this.bullets = [];
        _this.slides = [];
        _this.content.dockingBounds = new _gdk_core_pixi__WEBPACK_IMPORTED_MODULE_1__["DockingBounds"](_popin__WEBPACK_IMPORTED_MODULE_2__["DSPopin"].minWidth, BUTTONS_SPACE);
        if (options.leftButtonLabel && options.rightButtonLabel) {
            _this.addButtons(options);
        }
        if (options.slides.length > 1) {
            _this.setSlides(options);
        }
        else {
            _this.setContent(options);
        }
        return _this;
    }
    DSPaginatedPopin.prototype.setContent = function (options) {
        this.slideContainer = new pixi_js__WEBPACK_IMPORTED_MODULE_0__["Container"]();
        this.slideContainer.dockingBounds = new _gdk_core_pixi__WEBPACK_IMPORTED_MODULE_1__["DockingBounds"](0, 0);
        this.content.addChild(this.slideContainer);
        this.bulletContainer = new pixi_js__WEBPACK_IMPORTED_MODULE_0__["Container"]();
        var slide = options.slides[0];
        if (slide.parent) {
            slide.parent.removeChild(slide);
        }
        this.slides.push(slide);
        this.slideContainer.addChild(slide);
        if (slide.dockingBounds.width > this.slideContainer.dockingBounds.width) {
            this.slideContainer.dockingBounds.width = slide.dockingBounds.width;
        }
        if (slide.dockingBounds.height > this.slideContainer.dockingBounds.height) {
            this.slideContainer.dockingBounds.height = slide.dockingBounds.height;
        }
    };
    DSPaginatedPopin.prototype.setSlides = function (options) {
        var e_1, _a;
        this.slideContainer = new pixi_js__WEBPACK_IMPORTED_MODULE_0__["Container"]();
        this.slideContainer.dockingBounds = new _gdk_core_pixi__WEBPACK_IMPORTED_MODULE_1__["DockingBounds"](0, 0);
        this.content.addChild(this.slideContainer);
        this.bulletContainer = new pixi_js__WEBPACK_IMPORTED_MODULE_0__["Container"]();
        try {
            for (var _b = __values(options.slides), _c = _b.next(); !_c.done; _c = _b.next()) {
                var slide = _c.value;
                if (slide.parent) {
                    slide.parent.removeChild(slide);
                }
                this.slides.push(slide);
                if (slide.dockingBounds.width > this.slideContainer.dockingBounds.width) {
                    this.slideContainer.dockingBounds.width = slide.dockingBounds.width;
                }
                if (slide.dockingBounds.height > this.slideContainer.dockingBounds.height) {
                    this.slideContainer.dockingBounds.height = slide.dockingBounds.height;
                }
                var bullet = new pixi_js__WEBPACK_IMPORTED_MODULE_0__["extras"].AnimatedSprite([
                    pixi_js__WEBPACK_IMPORTED_MODULE_0__["Texture"].fromImage(BULLET_OFF),
                    pixi_js__WEBPACK_IMPORTED_MODULE_0__["Texture"].fromImage(BULLET_ON),
                ]);
                bullet.anchor.x = 0;
                bullet.anchor.y = 0;
                bullet.x = this.bullets.length * bullet.width;
                this.bulletContainer.addChild(bullet);
                this.bullets.push(bullet);
            }
        }
        catch (e_1_1) { e_1 = { error: e_1_1 }; }
        finally {
            try {
                if (_c && !_c.done && (_a = _b.return)) _a.call(_b);
            }
            finally { if (e_1) throw e_1.error; }
        }
        this.bulletContainer.dockingBounds = new _gdk_core_pixi__WEBPACK_IMPORTED_MODULE_1__["DockingBounds"](this.bulletContainer.width, this.bulletContainer.height);
        this.bulletContainer.docking = new _gdk_core_pixi__WEBPACK_IMPORTED_MODULE_1__["Docking"](_gdk_core_pixi__WEBPACK_IMPORTED_MODULE_1__["Docking"].bottomCenterHorizontal);
        this.addChild(this.bulletContainer);
        this.setArrows();
    };
    /**
     * Show the active buttons
     *
     * @access public
     * @param {boolean} withButtons=false, Must the popup have buttons or only the close one
     */
    DSPaginatedPopin.prototype.show = function (withButtons) {
        if (withButtons === void 0) { withButtons = false; }
        if (this.leftButton && this.rightButton) {
            this.leftButton.visible = withButtons;
            this.rightButton.visible = withButtons;
        }
        this.closeButton.visible = !withButtons;
        this.currentSlide = 0;
        _super.prototype.show.call(this);
    };
    Object.defineProperty(DSPaginatedPopin.prototype, "currentSlide", {
        /**
         * Return the current slide id
         *
         * @access public
         * @returns {number} The current slide id
         */
        get: function () {
            return this._currentSlide;
        },
        /**
         * Set the current slide, it will also set the correct dot in slide progression
         *
         * @access public
         * @param {number} slide, The slide id for activation
         */
        set: function (slide) {
            if (this.slides.length > 1) {
                if (slide >= this.slides.length) {
                    slide = 0;
                }
                else if (slide < 0) {
                    slide = this.slides.length - 1;
                }
                if (this.bullets.length > 1) {
                    this.bullets[this._currentSlide].gotoAndStop(0);
                    this.bullets[slide].gotoAndStop(1);
                }
                this._currentSlide = slide;
                if (this.slideContainer.children.length) {
                    this.slideContainer.removeChildAt(0);
                }
                if (this.slides.length) {
                    this.slideContainer.addChild(this.slides[this.currentSlide]);
                }
            }
        },
        enumerable: false,
        configurable: true
    });
    /**
     * Resize the popin according to content
     *
     * @access public
     */
    DSPaginatedPopin.prototype.resizePopin = function () {
        this.content.dockingBounds.width = this.slideContainer.dockingBounds.width;
        if (this.leftButton && this.leftButton.visible) {
            this.content.dockingBounds.height = this.slideContainer.dockingBounds.height;
            if (this.bullets.length > 1) {
                this.bulletContainer.docking.y = BULLET_BUTTONS_HEIGHT;
            }
        }
        else {
            this.content.dockingBounds.height = this.slideContainer.dockingBounds.height;
            if (this.bullets.length > 1) {
                this.bulletContainer.docking.y = BULLET_HEIGHT;
            }
        }
        // this.buttonStack.y = this.content.dockingBounds.height - this.buttonStack.height * .5 + 10;
        if (this.bullets.length > 1) {
            this.content.dockingBounds.height += BULLETS_SPACE;
        }
        if (this.content.dockingBounds.width < _popin__WEBPACK_IMPORTED_MODULE_2__["DSPopin"].minWidth) {
            this.content.dockingBounds.width = _popin__WEBPACK_IMPORTED_MODULE_2__["DSPopin"].minWidth;
        }
        _super.prototype.resizePopin.call(this);
        // this.buttonStack.x = (this.content.dockingBounds.width - this.buttonStack.width) * .5;
    };
    DSPaginatedPopin.prototype.setArrows = function () {
        var e_2, _a;
        var _this = this;
        try {
            for (var _b = __values(["previousButton", "nextButton"]), _c = _b.next(); !_c.done; _c = _b.next()) {
                var key = _c.value;
                this[key] = new _gdk_core_pixi__WEBPACK_IMPORTED_MODULE_1__["Button"]({
                    idleTexture: CIRCLE,
                    overTexture: CIRCLE,
                    clickedTexture: CIRCLE,
                    disabledTexture: CIRCLE,
                });
                this[key].isNineSlice = true;
                this[key].scaleXY = 1.4;
                this[key].dockingBounds = new _gdk_core_pixi__WEBPACK_IMPORTED_MODULE_1__["DockingBounds"](this[key].width, this[key].height);
                if (key === "previousButton") {
                    this[key].docking = new _gdk_core_pixi__WEBPACK_IMPORTED_MODULE_1__["Docking"](_gdk_core_pixi__WEBPACK_IMPORTED_MODULE_1__["Docking"].centerVerticalLeft, 0, 20, false);
                }
                else {
                    this[key].docking = new _gdk_core_pixi__WEBPACK_IMPORTED_MODULE_1__["Docking"](_gdk_core_pixi__WEBPACK_IMPORTED_MODULE_1__["Docking"].centerVerticalRight, -0, 20, false);
                    this[key].scaleX *= -1;
                }
                this[key].pivot = new pixi_js__WEBPACK_IMPORTED_MODULE_0__["Point"](50, 45);
                var arrow = pixi_js__WEBPACK_IMPORTED_MODULE_0__["Sprite"].fromFrame(ARROW);
                arrow.x = 50;
                arrow.y = 45;
                this[key].addChild(arrow);
                this.addChild(this[key]);
            }
        }
        catch (e_2_1) { e_2 = { error: e_2_1 }; }
        finally {
            try {
                if (_c && !_c.done && (_a = _b.return)) _a.call(_b);
            }
            finally { if (e_2) throw e_2.error; }
        }
        this._currentSlide = 0;
        this.currentSlide = 0;
        this.previousButton.on("pointertap", function () {
            _this.currentSlide--;
        });
        this.nextButton.on("pointertap", function () {
            _this.currentSlide++;
        });
    };
    DSPaginatedPopin.prototype.addButtons = function (options) {
        var e_3, _a;
        var _this = this;
        var _loop_1 = function (key) {
            this_1[key] = new _gdk_core_pixi__WEBPACK_IMPORTED_MODULE_1__["Button"]({
                idleTexture: BUTTON_IDLE,
                overTexture: BUTTON_OVER,
                clickedTexture: BUTTON_IDLE,
                disabledTexture: BUTTON_DISABLED,
            }, {
                default: {
                    fontName: "OpenSans-SemiBold",
                    fontSize: _popin__WEBPACK_IMPORTED_MODULE_2__["DSPopin"].buttonFontSize,
                    fill: options.buttonColor ? options.buttonColor : DEFAULT_COLOR,
                },
            }, options["".concat(key, "Label")]);
            // this[key].docking = new Docking(key === "leftButton" ? Docking.bottomLeft : Docking.bottomRight);
            this_1[key].isNineSlice = true;
            this_1[key].backgroundNineSlice.leftWidth = LEFT_TOP_RIGHT;
            this_1[key].backgroundNineSlice.topHeight = LEFT_TOP_RIGHT;
            this_1[key].backgroundNineSlice.rightWidth = LEFT_TOP_RIGHT;
            this_1[key].backgroundNineSlice.bottomHeight = BOTTOM;
            this_1[key].nineSliceMinSize.x = 320;
            this_1[key].nineSliceMinSize.y = 70;
            this_1[key].nineSlicePadding.x = 20;
            this_1[key].nineSlicePadding.y = 21;
            this_1[key].nineSlicePadding.width = 20;
            this_1[key].nineSlicePadding.height = 22;
            this_1[key].on("pointertap", function () {
                _this.executeButtonCallback(key === "leftButton" ? options.onLeft : options.onRight);
            });
            this_1.buttonStack.push(this_1[key], false);
            // this.content.addChild(this[key]);
            // Useful for resizing a niceSlice Button
            this_1[key].label = this_1[key].label;
        };
        var this_1 = this;
        try {
            for (var _b = __values(["leftButton", "rightButton"]), _c = _b.next(); !_c.done; _c = _b.next()) {
                var key = _c.value;
                _loop_1(key);
            }
        }
        catch (e_3_1) { e_3 = { error: e_3_1 }; }
        finally {
            try {
                if (_c && !_c.done && (_a = _b.return)) _a.call(_b);
            }
            finally { if (e_3) throw e_3.error; }
        }
    };
    DSPaginatedPopin.prototype.activateButtons = function (activate) {
        var e_4, _a;
        try {
            for (var _b = __values(["leftButton", "rightButton", "closeButton"]), _c = _b.next(); !_c.done; _c = _b.next()) {
                var key = _c.value;
                if (this[key]) {
                    this[key].enabled = activate;
                }
            }
        }
        catch (e_4_1) { e_4 = { error: e_4_1 }; }
        finally {
            try {
                if (_c && !_c.done && (_a = _b.return)) _a.call(_b);
            }
            finally { if (e_4) throw e_4.error; }
        }
    };
    return DSPaginatedPopin;
}(_popin__WEBPACK_IMPORTED_MODULE_2__["DSPopin"]));



/***/ }),

/***/ "./src/ds/popin.ts":
/*!*************************!*\
  !*** ./src/ds/popin.ts ***!
  \*************************/
/*! exports provided: DSPopin */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "DSPopin", function() { return DSPopin; });
/* harmony import */ var pixi_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! pixi.js */ "pixi.js");
/* harmony import */ var pixi_js__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(pixi_js__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var _gdk_core_pixi__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @gdk/core-pixi */ "@gdk/core-pixi");
/* harmony import */ var _gdk_core_pixi__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(_gdk_core_pixi__WEBPACK_IMPORTED_MODULE_1__);
var __extends = (undefined && undefined.__extends) || (function () {
    var extendStatics = function (d, b) {
        extendStatics = Object.setPrototypeOf ||
            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||
            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };
        return extendStatics(d, b);
    };
    return function (d, b) {
        if (typeof b !== "function" && b !== null)
            throw new TypeError("Class extends value " + String(b) + " is not a constructor or null");
        extendStatics(d, b);
        function __() { this.constructor = d; }
        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
    };
})();
var __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};
var __generator = (undefined && undefined.__generator) || function (thisArg, body) {
    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;
    return g = { next: verb(0), "throw": verb(1), "return": verb(2) }, typeof Symbol === "function" && (g[Symbol.iterator] = function() { return this; }), g;
    function verb(n) { return function (v) { return step([n, v]); }; }
    function step(op) {
        if (f) throw new TypeError("Generator is already executing.");
        while (g && (g = 0, op[0] && (_ = 0)), _) try {
            if (f = 1, y && (t = op[0] & 2 ? y["return"] : op[0] ? y["throw"] || ((t = y["return"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;
            if (y = 0, t) op = [op[0] & 2, t.value];
            switch (op[0]) {
                case 0: case 1: t = op; break;
                case 4: _.label++; return { value: op[1], done: false };
                case 5: _.label++; y = op[1]; op = [0]; continue;
                case 7: op = _.ops.pop(); _.trys.pop(); continue;
                default:
                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }
                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }
                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }
                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }
                    if (t[2]) _.ops.pop();
                    _.trys.pop(); continue;
            }
            op = body.call(thisArg, _);
        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }
        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };
    }
};


var FILL = "card/fill";
var BORDER = "card/outline";
var CLOSE = "backgrounds/white/circle";
var CROSS = "icons/color/cross";
var RADIUS = 30;
var MARGIN = 30;
var DEFAULT_COLOR = "#000000";
var DSPopin = /** @class */ (function (_super) {
    __extends(DSPopin, _super);
    function DSPopin(options) {
        var _this = _super.call(this) || this;
        _this.content = options.content || new pixi_js__WEBPACK_IMPORTED_MODULE_0__["Container"]();
        if (!_this.content.dockingBounds) {
            _this.content.dockingBounds = new _gdk_core_pixi__WEBPACK_IMPORTED_MODULE_1__["DockingBounds"](0, 0);
        }
        _this.onClose = options.onClose;
        _this.buttonStack = new _gdk_core_pixi__WEBPACK_IMPORTED_MODULE_1__["Stackable"]({ direction: "right", spacing: 20 });
        _this.buttonStack.width = 0;
        _this.buttonStack.height = 0;
        _this.buttonStack.dockingBounds = new _gdk_core_pixi__WEBPACK_IMPORTED_MODULE_1__["DockingBounds"]();
        _this.buttonStack.docking = new _gdk_core_pixi__WEBPACK_IMPORTED_MODULE_1__["Docking"](_gdk_core_pixi__WEBPACK_IMPORTED_MODULE_1__["Docking"].bottomCenterHorizontal);
        _this.content.addChild(_this.buttonStack);
        _this.fill = new pixi_js__WEBPACK_IMPORTED_MODULE_0__["mesh"].NineSlicePlane(pixi_js__WEBPACK_IMPORTED_MODULE_0__["Texture"].fromFrame(FILL), RADIUS, RADIUS, RADIUS, RADIUS);
        _this.addChild(_this.fill);
        _this.border = new pixi_js__WEBPACK_IMPORTED_MODULE_0__["mesh"].NineSlicePlane(pixi_js__WEBPACK_IMPORTED_MODULE_0__["Texture"].fromFrame(BORDER), RADIUS, RADIUS, RADIUS, RADIUS);
        _this.addChild(_this.border);
        _this.closeButton = new _gdk_core_pixi__WEBPACK_IMPORTED_MODULE_1__["Button"]({
            idleTexture: CLOSE,
            overTexture: CLOSE,
            clickedTexture: CLOSE,
            disabledTexture: CLOSE,
        });
        _this.closeButton.isNineSlice = true;
        _this.closeButton.scaleXY = 1.1;
        _this.closeButton.dockingBounds = new _gdk_core_pixi__WEBPACK_IMPORTED_MODULE_1__["DockingBounds"](1, 1);
        _this.closeButton.docking = new _gdk_core_pixi__WEBPACK_IMPORTED_MODULE_1__["Docking"](_gdk_core_pixi__WEBPACK_IMPORTED_MODULE_1__["Docking"].topRight, -20, 20, false);
        _this.closeButton.pivot = new pixi_js__WEBPACK_IMPORTED_MODULE_0__["Point"](50, 45);
        var cross = pixi_js__WEBPACK_IMPORTED_MODULE_0__["Sprite"].fromFrame(CROSS);
        cross.x = 50;
        cross.y = 45;
        _this.closeButton.addChild(cross);
        _this.addChild(_this.closeButton);
        _this.closeButton.on("pointertap", function () {
            _this.executeButtonCallback(_this.onClose);
        });
        var titleColor = options.titleColor ? options.titleColor : DEFAULT_COLOR;
        _this.title = new _gdk_core_pixi__WEBPACK_IMPORTED_MODULE_1__["TextField"](options.title, {
            default: {
                fontName: "OpenSans-SemiBold",
                fontSize: DSPopin.titleFontSize,
                fill: titleColor,
                stroke: titleColor,
                strokeOffsetX: 0,
                strokeOffsetY: 0,
                strokeWidth: 1,
            },
        }, {
            noUpdate: true,
        });
        _this.title.freeze();
        _this.title.wordWrap = true;
        _this.title.width = DSPopin.minWidth;
        _this.title.align = _gdk_core_pixi__WEBPACK_IMPORTED_MODULE_1__["EAlign"].Center;
        _this.title.docking = new _gdk_core_pixi__WEBPACK_IMPORTED_MODULE_1__["Docking"](_gdk_core_pixi__WEBPACK_IMPORTED_MODULE_1__["Docking"].topCenterHorizontal, 0, 20);
        _this.title.unfreeze();
        _this.addChild(_this.title);
        _this.addChild(_this.content);
        _this.dockingBounds = new _gdk_core_pixi__WEBPACK_IMPORTED_MODULE_1__["DockingBounds"]();
        return _this;
    }
    /**
     * Resize the popin to fit content
     *
     * @access public
     */
    DSPopin.prototype.resizePopin = function () {
        var maxSize = Math.max(768, this.dockingBounds.width) - MARGIN * 2;
        var remainingSpace = maxSize - this.buttonStack.width - this.buttonStack.spacing;
        var spacing = Math.min(remainingSpace / 3, 30);
        this.buttonStack.spacing = spacing;
        this.buttonStack.dockingBounds.width = this.buttonStack.width;
        this.buttonStack.dockingBounds.height = this.buttonStack.docking.y = this.buttonStack.height;
        var height = this.title.y + this.title.height + MARGIN;
        var width = this.title.width + 2 * MARGIN;
        this.content.y = height;
        height += this.content.dockingBounds.height + MARGIN + this.buttonStack.height;
        if (this.content.dockingBounds.width + 2 * MARGIN > width) {
            width = this.content.dockingBounds.width + 2 * MARGIN;
        }
        this.fill.height = height;
        this.fill.width = width;
        this.border.height = height;
        this.border.width = width;
        this.dockingBounds.height = height;
        this.dockingBounds.width = width;
        this.updateTransform();
        this.content.x = (this.dockingBounds.width - this.content.dockingBounds.width) * 0.5;
        // this.buttonStack.x = (this.dockingBounds.width - this.buttonStack.width) * 0.5;
        // this.buttonStack.y = this.dockingBounds.height - this.buttonStack.height;
        // this.buttonStack.x = (this.content.dockingBounds.width - this.buttonStack.width) * .5;
    };
    /**
     * Show the popin
     *
     * @access public
     */
    DSPopin.prototype.show = function () {
        this.activateButtons(true);
        if (this.parent) {
            this.resizePopin();
        }
        this.visible = true;
    };
    DSPopin.prototype.executeButtonCallback = function (callback) {
        return __awaiter(this, void 0, void 0, function () {
            var e_1;
            return __generator(this, function (_a) {
                switch (_a.label) {
                    case 0:
                        this.activateButtons(false);
                        _a.label = 1;
                    case 1:
                        _a.trys.push([1, 4, , 5]);
                        if (!callback) return [3 /*break*/, 3];
                        return [4 /*yield*/, callback()];
                    case 2:
                        _a.sent();
                        _a.label = 3;
                    case 3:
                        this.visible = false;
                        return [3 /*break*/, 5];
                    case 4:
                        e_1 = _a.sent();
                        return [3 /*break*/, 5];
                    case 5: return [2 /*return*/];
                }
            });
        });
    };
    DSPopin.minWidth = 768;
    DSPopin.textFontSize = 36;
    DSPopin.titleFontSize = 50;
    DSPopin.buttonFontSize = 36;
    DSPopin.menuButtonFontSize = 32;
    return DSPopin;
}(pixi_js__WEBPACK_IMPORTED_MODULE_0__["Container"]));



/***/ }),

/***/ "./src/ds/popinsContainer.ts":
/*!***********************************!*\
  !*** ./src/ds/popinsContainer.ts ***!
  \***********************************/
/*! exports provided: EGameStates, DSPopinsContainer */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "EGameStates", function() { return EGameStates; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "DSPopinsContainer", function() { return DSPopinsContainer; });
/* harmony import */ var pixi_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! pixi.js */ "pixi.js");
/* harmony import */ var pixi_js__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(pixi_js__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var i18next__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! i18next */ "i18next");
/* harmony import */ var i18next__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(i18next__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var _gdk_core_pixi__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @gdk/core-pixi */ "@gdk/core-pixi");
/* harmony import */ var _gdk_core_pixi__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(_gdk_core_pixi__WEBPACK_IMPORTED_MODULE_2__);
/* harmony import */ var _falcon_bridge__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @falcon/bridge */ "@falcon/bridge");
/* harmony import */ var _falcon_bridge__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(_falcon_bridge__WEBPACK_IMPORTED_MODULE_3__);
/* harmony import */ var _twoButtonsPopin__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./twoButtonsPopin */ "./src/ds/twoButtonsPopin.ts");
/* harmony import */ var _winLosePopin__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./winLosePopin */ "./src/ds/winLosePopin.ts");
/* harmony import */ var _paginatedPopin__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./paginatedPopin */ "./src/ds/paginatedPopin.ts");
/* harmony import */ var _viButtons__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./viButtons */ "./src/ds/viButtons.ts");
/* harmony import */ var _replayPopin__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ./replayPopin */ "./src/ds/replayPopin.ts");
/* harmony import */ var _adaptativeVisualIdentity__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../adaptativeVisualIdentity */ "./src/adaptativeVisualIdentity/index.ts");
/* harmony import */ var _game__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../game */ "./src/game/index.ts");
/* harmony import */ var _popin__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ./popin */ "./src/ds/popin.ts");
/* harmony import */ var _adaptativeVisualIdentity_identities_danskeSpil_views_bottomBar__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ../adaptativeVisualIdentity/identities/danskeSpil/views/bottomBar */ "./src/adaptativeVisualIdentity/identities/danskeSpil/views/bottomBar.ts");
var __extends = (undefined && undefined.__extends) || (function () {
    var extendStatics = function (d, b) {
        extendStatics = Object.setPrototypeOf ||
            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||
            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };
        return extendStatics(d, b);
    };
    return function (d, b) {
        if (typeof b !== "function" && b !== null)
            throw new TypeError("Class extends value " + String(b) + " is not a constructor or null");
        extendStatics(d, b);
        function __() { this.constructor = d; }
        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
    };
})();
var __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};
var __generator = (undefined && undefined.__generator) || function (thisArg, body) {
    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;
    return g = { next: verb(0), "throw": verb(1), "return": verb(2) }, typeof Symbol === "function" && (g[Symbol.iterator] = function() { return this; }), g;
    function verb(n) { return function (v) { return step([n, v]); }; }
    function step(op) {
        if (f) throw new TypeError("Generator is already executing.");
        while (g && (g = 0, op[0] && (_ = 0)), _) try {
            if (f = 1, y && (t = op[0] & 2 ? y["return"] : op[0] ? y["throw"] || ((t = y["return"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;
            if (y = 0, t) op = [op[0] & 2, t.value];
            switch (op[0]) {
                case 0: case 1: t = op; break;
                case 4: _.label++; return { value: op[1], done: false };
                case 5: _.label++; y = op[1]; op = [0]; continue;
                case 7: op = _.ops.pop(); _.trys.pop(); continue;
                default:
                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }
                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }
                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }
                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }
                    if (t[2]) _.ops.pop();
                    _.trys.pop(); continue;
            }
            op = body.call(thisArg, _);
        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }
        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };
    }
};
var __values = (undefined && undefined.__values) || function(o) {
    var s = typeof Symbol === "function" && Symbol.iterator, m = s && o[s], i = 0;
    if (m) return m.call(o);
    if (o && typeof o.length === "number") return {
        next: function () {
            if (o && i >= o.length) o = void 0;
            return { value: o && o[i++], done: !o };
        }
    };
    throw new TypeError(s ? "Object is not iterable." : "Symbol.iterator is not defined.");
};
var __read = (undefined && undefined.__read) || function (o, n) {
    var m = typeof Symbol === "function" && o[Symbol.iterator];
    if (!m) return o;
    var i = m.call(o), r, ar = [], e;
    try {
        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);
    }
    catch (error) { e = { error: error }; }
    finally {
        try {
            if (r && !r.done && (m = i["return"])) m.call(i);
        }
        finally { if (e) throw e.error; }
    }
    return ar;
};
var __spreadArray = (undefined && undefined.__spreadArray) || function (to, from, pack) {
    if (pack || arguments.length === 2) for (var i = 0, l = from.length, ar; i < l; i++) {
        if (ar || !(i in from)) {
            if (!ar) ar = Array.prototype.slice.call(from, 0, i);
            ar[i] = from[i];
        }
    }
    return to.concat(ar || Array.prototype.slice.call(from));
};













var BASE_COLOR = "#000000";
var TABLE_EXTERNAL_MARGIN = 40;
var EGameStates;
(function (EGameStates) {
    EGameStates[EGameStates["First"] = 0] = "First";
    EGameStates[EGameStates["AfterDemoLose"] = 1] = "AfterDemoLose";
    EGameStates[EGameStates["AfterDemoWin"] = 2] = "AfterDemoWin";
    EGameStates[EGameStates["AfterWin"] = 3] = "AfterWin";
    EGameStates[EGameStates["AfterLose"] = 4] = "AfterLose";
    EGameStates[EGameStates["AfterReplayWin"] = 5] = "AfterReplayWin";
    EGameStates[EGameStates["AfterReplayLose"] = 6] = "AfterReplayLose";
})(EGameStates || (EGameStates = {}));
var DSPopinsContainer = /** @class */ (function (_super) {
    __extends(DSPopinsContainer, _super);
    function DSPopinsContainer(options, game, ticketType) {
        var e_1, _a;
        var _this = _super.call(this) || this;
        _this.ticketType = ticketType;
        _this.state = EGameStates.First;
        _this.rulesOpen = false;
        _this._verticalOffset = 0;
        _this.dockingBounds = new _gdk_core_pixi__WEBPACK_IMPORTED_MODULE_2__["DockingBounds"](game.vi.inGameView.dockingBounds.width + 180, // add some margin for left and right arrows
        game.vi.inGameView.dockingBounds.height + _adaptativeVisualIdentity_identities_danskeSpil_views_bottomBar__WEBPACK_IMPORTED_MODULE_12__["BottomBar"].height); // add bottom bar height
        _this.resize = new _gdk_core_pixi__WEBPACK_IMPORTED_MODULE_2__["Resize"](_gdk_core_pixi__WEBPACK_IMPORTED_MODULE_2__["Resize"].fitContain);
        _this.game = game;
        _this.setViElements(options);
        _this.popinsOverlay = new pixi_js__WEBPACK_IMPORTED_MODULE_0__["Graphics"]();
        _this.popinsOverlay.beginFill(0, 0);
        _this.popinsOverlay.drawRect(0, 0, 1, 1);
        _this.popinsOverlay.endFill();
        _this.popinsOverlay.resize = new _gdk_core_pixi__WEBPACK_IMPORTED_MODULE_2__["Resize"](_gdk_core_pixi__WEBPACK_IMPORTED_MODULE_2__["Resize"].cover);
        _this.popinsOverlay.interactive = true;
        _this.addChild(_this.popinsOverlay);
        _this.onStart = options.onStart;
        _this.onAuto = options.viButtonsCallbacks.onAuto;
        _this.on("added", function () {
            _this.onAdded();
        });
        _this.setBetPopin(options);
        _this.setDemoEndPopin(options);
        _this.setBetEndPopin(options);
        _this.setReplayEndPopin(options);
        _this.setResumePopin(options);
        _this.setReplayPopin(options);
        _this.setConfirmPopin(options);
        _this.setViAccessableElements(options);
        _this.hideButtons();
        try {
            for (var _b = __values(_this.children), _c = _b.next(); !_c.done; _c = _b.next()) {
                var child = _c.value;
                child.visible = false;
            }
        }
        catch (e_1_1) { e_1 = { error: e_1_1 }; }
        finally {
            try {
                if (_c && !_c.done && (_a = _b.return)) _a.call(_b);
            }
            finally { if (e_1) throw e_1.error; }
        }
        return _this;
    }
    Object.defineProperty(DSPopinsContainer.prototype, "ticket", {
        get: function () {
            return this._ticket;
        },
        enumerable: false,
        configurable: true
    });
    /**
     * Handle the game start.
     * It will show the rules if thisit's rulesequired optionsr ask for wich game type this play.
     * It will also check for replay or resume if required.
     *
     * @access public
     */
    DSPopinsContainer.prototype.start = function () {
        return __awaiter(this, void 0, void 0, function () {
            var _a, _b, child, _c;
            var e_2, _d;
            return __generator(this, function (_e) {
                switch (_e.label) {
                    case 0:
                        this.hideButtons();
                        try {
                            for (_a = __values(this.children), _b = _a.next(); !_b.done; _b = _a.next()) {
                                child = _b.value;
                                child.visible = false;
                            }
                        }
                        catch (e_2_1) { e_2 = { error: e_2_1 }; }
                        finally {
                            try {
                                if (_b && !_b.done && (_d = _a.return)) _d.call(_a);
                            }
                            finally { if (e_2) throw e_2.error; }
                        }
                        _c = this;
                        return [4 /*yield*/, this.game.getTicketToReplay(false)];
                    case 1:
                        _c.replayTicketResponse = _e.sent();
                        if (this.replayTicketResponse) {
                            if (this.replayTicketResponse.status === _game__WEBPACK_IMPORTED_MODULE_10__["ETicketStatus"].CLAIMED) {
                                this.popinsOverlay.visible = true;
                                this.hideButtons();
                                this._ticket = new this.ticketType(this.replayTicketResponse, _game__WEBPACK_IMPORTED_MODULE_10__["ETicketMode"].REPLAY, this.game);
                                this.replayPopin.show(false);
                            }
                            else {
                                this._ticket = new this.ticketType(this.replayTicketResponse, _game__WEBPACK_IMPORTED_MODULE_10__["ETicketMode"].RESUME, this.game);
                                this.resumePopin.show(false);
                            }
                        }
                        else {
                            if (this.shouldHideRules) {
                                this.toGame();
                            }
                            else {
                                this.viOverlay.visible = true;
                                this.rules.show(true);
                            }
                        }
                        return [2 /*return*/];
                }
            });
        });
    };
    /**
     * This will hide all the viButtons and deactivate them
     *
     * @access public
     */
    DSPopinsContainer.prototype.hideButtons = function () {
        this.viButtons.hideButtons(true);
    };
    /**
     * It will handle the end of game. It shows the result popin
     *
     * @access public
     */
    DSPopinsContainer.prototype.end = function () {
        this.popinsOverlay.visible = true;
        this.hideButtons();
        switch (this.state) {
            case EGameStates.AfterDemoLose:
            case EGameStates.AfterDemoWin:
                this.demoEndPopin.show(true, this.ticket);
                break;
            case EGameStates.AfterLose:
            case EGameStates.AfterWin:
                this.betEndPopin.show(true, this.ticket);
                break;
            case EGameStates.AfterReplayLose:
            case EGameStates.AfterReplayWin:
                this._ticket = new this.ticketType(this.replayTicketResponse, _game__WEBPACK_IMPORTED_MODULE_10__["ETicketMode"].REPLAY, this.game);
                this.replayEndPopin.show(false, this._ticket);
                break;
        }
    };
    /**
     * Claim the ticket when the game is finished
     *
     * @access public
     * @returns {Promise<void>} The claim promise
     */
    DSPopinsContainer.prototype.claim = function () {
        return __awaiter(this, void 0, void 0, function () {
            var response;
            return __generator(this, function (_a) {
                switch (_a.label) {
                    case 0:
                        if (this.ticket.mode === _game__WEBPACK_IMPORTED_MODULE_10__["ETicketMode"].REPLAY) {
                            this.state =
                                this.ticket.wonAmount.value > 0 ? EGameStates.AfterReplayWin : EGameStates.AfterReplayLose;
                            return [2 /*return*/];
                        }
                        return [4 /*yield*/, this.ticket.claim()];
                    case 1:
                        response = _a.sent();
                        if (this.ticket.demo) {
                            this.state =
                                response.wonAmount.value > 0 ? EGameStates.AfterDemoWin : EGameStates.AfterDemoLose;
                        }
                        else {
                            this.state = response.wonAmount.value > 0 ? EGameStates.AfterWin : EGameStates.AfterLose;
                        }
                        return [2 /*return*/];
                }
            });
        });
    };
    DSPopinsContainer.prototype.replay = function () {
        return __awaiter(this, void 0, void 0, function () {
            return __generator(this, function (_a) {
                switch (_a.label) {
                    case 0: return [4 /*yield*/, this.onStart()];
                    case 1:
                        _a.sent();
                        this.onAuto();
                        this.game.vi.emit(_adaptativeVisualIdentity__WEBPACK_IMPORTED_MODULE_9__["EVisualIdentityAction"].RulesEnabled, true);
                        this.game.vi.emit(_adaptativeVisualIdentity__WEBPACK_IMPORTED_MODULE_9__["EVisualIdentityAction"].SettingsEnabled, true);
                        return [2 /*return*/];
                }
            });
        });
    };
    DSPopinsContainer.prototype.handleGameStart = function (demo) {
        if (demo === void 0) { demo = false; }
        return __awaiter(this, void 0, void 0, function () {
            var responseTicket;
            return __generator(this, function (_a) {
                switch (_a.label) {
                    case 0: return [4 /*yield*/, this.game.bet({
                            applicationId: "ITG",
                            serviceName: this.game.gameConfig.lotteryGameCode,
                            stake: {
                                currency: this.game.selectedStake.currency,
                                value: this.game.selectedStake.value,
                            },
                            demo: demo,
                        })];
                    case 1:
                        responseTicket = _a.sent();
                        this._ticket = new this.ticketType(responseTicket, _game__WEBPACK_IMPORTED_MODULE_10__["ETicketMode"].DEFAULT, this.game);
                        this.startAndActivateButtons();
                        this.popinsOverlay.visible = false;
                        return [2 /*return*/];
                }
            });
        });
    };
    DSPopinsContainer.prototype.startAndActivateButtons = function () {
        return __awaiter(this, void 0, void 0, function () {
            return __generator(this, function (_a) {
                switch (_a.label) {
                    case 0: return [4 /*yield*/, this.onStart()];
                    case 1:
                        _a.sent();
                        this.viButtons.activateAuto();
                        this.game.vi.emit(_adaptativeVisualIdentity__WEBPACK_IMPORTED_MODULE_9__["EVisualIdentityAction"].RulesEnabled, true);
                        this.game.vi.emit(_adaptativeVisualIdentity__WEBPACK_IMPORTED_MODULE_9__["EVisualIdentityAction"].SettingsEnabled, true);
                        return [2 /*return*/];
                }
            });
        });
    };
    DSPopinsContainer.prototype.onHideSettings = function () {
        if (!this.rulesOpen) {
            this.viButtons.showActiveButtons();
            this.game.onRulesQuit();
        }
    };
    DSPopinsContainer.prototype.onShowSettings = function () {
        this.viButtons.hideButtons();
    };
    DSPopinsContainer.prototype.showVIGains = function () {
        this.game.onRulesOpen();
        this.viOverlay.visible = true;
        this.rulesOpen = true;
        this.rules.visible = false;
        this.gainTable.show(false);
    };
    DSPopinsContainer.prototype.showVIRules = function () {
        this.game.onRulesOpen();
        this.viOverlay.visible = true;
        this.rulesOpen = true;
        this.gainTable.visible = false;
        this.rules.show(false);
    };
    DSPopinsContainer.prototype.toGame = function () {
        this.popinsOverlay.visible = true;
        this.viOverlay.visible = false;
        this.game.vi.emit(_adaptativeVisualIdentity__WEBPACK_IMPORTED_MODULE_9__["EVisualIdentityAction"].RulesEnabled, true);
        this.game.vi.emit(_adaptativeVisualIdentity__WEBPACK_IMPORTED_MODULE_9__["EVisualIdentityAction"].SettingsEnabled, true);
        this.hideButtons();
        this.betPopin.show(false);
    };
    DSPopinsContainer.prototype.cancelBet = function () {
        return __awaiter(this, void 0, void 0, function () {
            var _a, ticketToReplay;
            return __generator(this, function (_b) {
                switch (_b.label) {
                    case 0:
                        _a = this.state;
                        switch (_a) {
                            case EGameStates.AfterDemoLose: return [3 /*break*/, 1];
                            case EGameStates.AfterDemoWin: return [3 /*break*/, 1];
                            case EGameStates.AfterLose: return [3 /*break*/, 2];
                            case EGameStates.AfterWin: return [3 /*break*/, 2];
                        }
                        return [3 /*break*/, 3];
                    case 1:
                        this.end();
                        return [3 /*break*/, 5];
                    case 2:
                        this.seeResult();
                        return [3 /*break*/, 5];
                    case 3: return [4 /*yield*/, this.game.getTicketToReplay(false)];
                    case 4:
                        ticketToReplay = _b.sent();
                        if (ticketToReplay) {
                            if (ticketToReplay.status === _game__WEBPACK_IMPORTED_MODULE_10__["ETicketStatus"].CLAIMED) {
                                this.popinsOverlay.visible = true;
                                this.hideButtons();
                                this._ticket = new this.ticketType(ticketToReplay, _game__WEBPACK_IMPORTED_MODULE_10__["ETicketMode"].REPLAY, this.game);
                                this.replayPopin.show(false);
                            }
                            else {
                                this._ticket = new this.ticketType(ticketToReplay, _game__WEBPACK_IMPORTED_MODULE_10__["ETicketMode"].RESUME, this.game);
                                this.resumePopin.show(false);
                            }
                        }
                        else {
                            this.toGame();
                        }
                        return [3 /*break*/, 5];
                    case 5: return [2 /*return*/];
                }
            });
        });
    };
    DSPopinsContainer.prototype.resume = function () {
        return __awaiter(this, void 0, void 0, function () {
            return __generator(this, function (_a) {
                this.startAndActivateButtons();
                this.popinsOverlay.visible = false;
                return [2 /*return*/];
            });
        });
    };
    DSPopinsContainer.prototype.confirm = function () {
        return __awaiter(this, void 0, void 0, function () {
            var existingTicket;
            return __generator(this, function (_a) {
                switch (_a.label) {
                    case 0: 
                    // change game mode
                    return [4 /*yield*/, this.game.updateGameMode(_falcon_bridge__WEBPACK_IMPORTED_MODULE_3__["EGameMode"].normal)];
                    case 1:
                        // change game mode
                        _a.sent();
                        return [4 /*yield*/, this.game.getExistingTicket(this.game.gameConfig.lotteryGameCode, false)];
                    case 2:
                        existingTicket = _a.sent();
                        if (!existingTicket) return [3 /*break*/, 3];
                        this._ticket = new this.ticketType(existingTicket, _game__WEBPACK_IMPORTED_MODULE_10__["ETicketMode"].RESUME, this.game);
                        this.resumePopin.show(false);
                        return [3 /*break*/, 5];
                    case 3: return [4 /*yield*/, this.game.preBet({
                            applicationId: "ITG",
                            serviceName: this.game.gameConfig.lotteryGameCode,
                            stake: {
                                currency: this.game.selectedStake.currency,
                                value: this.game.selectedStake.value,
                            },
                        })];
                    case 4:
                        _a.sent();
                        this.popinsOverlay.visible = true;
                        this.hideButtons();
                        this.confirmPopin.show(false);
                        _a.label = 5;
                    case 5: return [2 /*return*/];
                }
            });
        });
    };
    DSPopinsContainer.prototype.noMoreRules = function () {
        localStorage.setItem("".concat(i18next__WEBPACK_IMPORTED_MODULE_1__["t"]("common.gameName"), "-noMoreRules"), "true");
        this.toGame();
    };
    Object.defineProperty(DSPopinsContainer.prototype, "shouldHideRules", {
        get: function () {
            return (this.game.getOpenGameParameters().skipRules ||
                localStorage.getItem("".concat(i18next__WEBPACK_IMPORTED_MODULE_1__["t"]("common.gameName"), "-noMoreRules")) === "true");
        },
        enumerable: false,
        configurable: true
    });
    DSPopinsContainer.prototype.seeResult = function () {
        this.popinsOverlay.visible = false;
        this.viButtons.activatePlayAgain();
    };
    DSPopinsContainer.prototype.seeDemoResult = function () {
        this.popinsOverlay.visible = false;
        this.viButtons.activateTryAgain();
    };
    DSPopinsContainer.prototype.onAdded = function () {
        this.betPopin.resizePopin();
        this.demoEndPopin.resizePopin();
        this.betEndPopin.resizePopin();
        this.replayEndPopin.resizePopin();
        this.confirmPopin.resizePopin();
        this.rules.resizePopin();
        this.gainTable.resizePopin();
        this.resumePopin.resizePopin();
        this.replayPopin.resizePopin();
        // this.fakeIOS13(true);
    };
    DSPopinsContainer.prototype.onVIClose = function () {
        this.rulesOpen = false;
        this.viButtons.showActiveButtons();
        this.viOverlay.visible = false;
        this.game.onRulesQuit();
    };
    DSPopinsContainer.prototype.setViElements = function (options) {
        var _this = this;
        this.game.vi.inGameView.settingsComponent.soundEnabled = false;
        this.game.mute(true);
        this.viOverlay = new pixi_js__WEBPACK_IMPORTED_MODULE_0__["Graphics"]();
        this.viOverlay.beginFill(0, 0.3);
        this.viOverlay.drawRect(0, 0, 1, 1);
        this.viOverlay.endFill();
        this.viOverlay.resize = new _gdk_core_pixi__WEBPACK_IMPORTED_MODULE_2__["Resize"](_gdk_core_pixi__WEBPACK_IMPORTED_MODULE_2__["Resize"].cover);
        this.viOverlay.interactive = true;
        this.game.vi.emitter.on(_adaptativeVisualIdentity__WEBPACK_IMPORTED_MODULE_9__["EVisualIdentityEvent"].ShowRules, function () {
            _this.showVIRules();
        });
        this.game.vi.emitter.on(_adaptativeVisualIdentity__WEBPACK_IMPORTED_MODULE_9__["EVisualIdentityEvent"].ShowWinningTable, function () {
            _this.showVIGains();
        });
        this.game.vi.emitter.on(_adaptativeVisualIdentity__WEBPACK_IMPORTED_MODULE_9__["EVisualIdentityEvent"].ShowSettings, function () {
            _this.onShowSettings();
        });
        this.game.vi.emitter.on(_adaptativeVisualIdentity__WEBPACK_IMPORTED_MODULE_9__["EVisualIdentityEvent"].HideSettings, function () {
            _this.onHideSettings();
        });
        this.viButtons = new _viButtons__WEBPACK_IMPORTED_MODULE_7__["DSVIButtons"](this.game, {
            onAuto: function () {
                _this.viButtons.activatePause();
                options.viButtonsCallbacks.onAuto();
            },
            onStop: function () {
                _this.viButtons.activateAuto();
                options.viButtonsCallbacks.onStop();
            },
            onPlayAgain: function () { return __awaiter(_this, void 0, void 0, function () {
                var _this = this;
                return __generator(this, function (_a) {
                    switch (_a.label) {
                        case 0: return [4 /*yield*/, this.confirm().catch(function (e) {
                                _this.viButtons.activatePlayAgain();
                                throw e;
                            })];
                        case 1:
                            _a.sent();
                            return [2 /*return*/];
                    }
                });
            }); },
            onTryAgain: function () {
                _this.end();
            },
        });
        this.game.vi.emit(_adaptativeVisualIdentity__WEBPACK_IMPORTED_MODULE_9__["EVisualIdentityAction"].UpdateDesign, {
            titleStyles: {
                default: {
                    fill: options.titleColor ? options.titleColor : BASE_COLOR,
                    stroke: options.titleColor ? options.titleColor : BASE_COLOR,
                    fontName: "OpenSans-SemiBold",
                    fontSize: _popin__WEBPACK_IMPORTED_MODULE_11__["DSPopin"].titleFontSize,
                    strokeOffsetX: 0,
                    strokeOffsetY: 0,
                    strokeWidth: 1,
                },
            },
            contentStyles: {
                default: {
                    fill: options.titleColor ? options.titleColor : BASE_COLOR,
                    stroke: options.titleColor ? options.titleColor : BASE_COLOR,
                    fontName: "OpenSans-SemiBold",
                    fontSize: _popin__WEBPACK_IMPORTED_MODULE_11__["DSPopin"].textFontSize,
                    strokeOffsetX: 0,
                    strokeOffsetY: 0,
                    strokeWidth: 0,
                },
            },
            buttonsStyles: {
                default: {
                    fill: options.secondaryColor ? options.secondaryColor : BASE_COLOR,
                    stroke: options.secondaryColor ? options.secondaryColor : BASE_COLOR,
                    fontName: "OpenSans-SemiBold",
                    fontSize: _popin__WEBPACK_IMPORTED_MODULE_11__["DSPopin"].menuButtonFontSize,
                    strokeOffsetX: 0,
                    strokeOffsetY: 0,
                },
            },
        });
    };
    DSPopinsContainer.prototype.setRules = function (titleColor) {
        var e_3, _a;
        var _this = this;
        var slides = [];
        var rulesContainer = this.game.stage.getChildByName("rules");
        try {
            for (var _b = __values(rulesContainer.children), _c = _b.next(); !_c.done; _c = _b.next()) {
                var slide = _c.value;
                slides.push(slide);
            }
        }
        catch (e_3_1) { e_3 = { error: e_3_1 }; }
        finally {
            try {
                if (_c && !_c.done && (_a = _b.return)) _a.call(_b);
            }
            finally { if (e_3) throw e_3.error; }
        }
        this.game.stage.removeChild(rulesContainer);
        if (rulesContainer.dockingBounds) {
            // allow dev to set vi dockingBounds via rulesContainer (not great but revealView not aviable)
            this.dockingBounds = new _gdk_core_pixi__WEBPACK_IMPORTED_MODULE_2__["DockingBounds"](Math.max(this.dockingBounds.width, rulesContainer.dockingBounds.width + 180), // add some margin for left and right arrows
            Math.max(this.dockingBounds.height, rulesContainer.dockingBounds.height + _adaptativeVisualIdentity_identities_danskeSpil_views_bottomBar__WEBPACK_IMPORTED_MODULE_12__["BottomBar"].height)); // add bottom bar height
        }
        this.rules = new _paginatedPopin__WEBPACK_IMPORTED_MODULE_6__["DSPaginatedPopin"]({
            title: i18next__WEBPACK_IMPORTED_MODULE_1__["t"]("howTo.title"),
            titleColor: titleColor,
            leftButtonLabel: i18next__WEBPACK_IMPORTED_MODULE_1__["t"]("howTo.toGame"),
            rightButtonLabel: i18next__WEBPACK_IMPORTED_MODULE_1__["t"]("howTo.hide"),
            onLeft: function () { return __awaiter(_this, void 0, void 0, function () {
                return __generator(this, function (_a) {
                    this.toGame();
                    return [2 /*return*/];
                });
            }); },
            onRight: function () { return __awaiter(_this, void 0, void 0, function () {
                return __generator(this, function (_a) {
                    this.noMoreRules();
                    return [2 /*return*/];
                });
            }); },
            onClose: function () { return __awaiter(_this, void 0, void 0, function () {
                return __generator(this, function (_a) {
                    this.onVIClose();
                    return [2 /*return*/];
                });
            }); },
            slides: slides,
        });
        this.rules.docking = new _gdk_core_pixi__WEBPACK_IMPORTED_MODULE_2__["Docking"](_gdk_core_pixi__WEBPACK_IMPORTED_MODULE_2__["Docking"].centerAll, 0, DSPopinsContainer.verticalOffset - DSPopinsContainer.verticalOffsetIOS);
        this.addChild(this.rules);
    };
    DSPopinsContainer.prototype.setGainBoard = function (options) {
        var e_4, _a;
        var _this = this;
        var GAINS = [];
        var GAIN_BOARD = this.game.stage.getChildByName("gainBoard");
        try {
            for (var _b = __values(GAIN_BOARD.children), _c = _b.next(); !_c.done; _c = _b.next()) {
                var slide = _c.value;
                GAINS.push(slide);
            }
        }
        catch (e_4_1) { e_4 = { error: e_4_1 }; }
        finally {
            try {
                if (_c && !_c.done && (_a = _b.return)) _a.call(_b);
            }
            finally { if (e_4) throw e_4.error; }
        }
        this.game.stage.removeChild(GAIN_BOARD);
        if (GAINS.length === 0) {
            this.makeGainBoardSlides(GAIN_BOARD, GAINS, options);
        }
        this.gainTable = new _paginatedPopin__WEBPACK_IMPORTED_MODULE_6__["DSPaginatedPopin"]({
            title: i18next__WEBPACK_IMPORTED_MODULE_1__["t"]("gainTable.title"),
            titleColor: options.titleColor,
            slides: GAINS,
            onClose: function () { return __awaiter(_this, void 0, void 0, function () {
                return __generator(this, function (_a) {
                    this.onVIClose();
                    return [2 /*return*/];
                });
            }); },
        });
        this.gainTable.docking = new _gdk_core_pixi__WEBPACK_IMPORTED_MODULE_2__["Docking"](_gdk_core_pixi__WEBPACK_IMPORTED_MODULE_2__["Docking"].centerAll, 0, DSPopinsContainer.verticalOffset);
        this.addChild(this.gainTable);
    };
    DSPopinsContainer.prototype.makeGainBoardSlides = function (gainBoard, gains, options) {
        var e_5, _a;
        var MAX_HEIGHT = gainBoard.dockingBounds.height - 2 * TABLE_EXTERNAL_MARGIN;
        var MAIN_FONTSIZE = options.gainFontsizes && options.gainFontsizes.main
            ? options.gainFontsizes.main
            : _popin__WEBPACK_IMPORTED_MODULE_11__["DSPopin"].titleFontSize;
        var LEFT_FONTSIZE = options.gainFontsizes && options.gainFontsizes.left
            ? options.gainFontsizes.left
            : MAIN_FONTSIZE;
        var MAX_LINES = options.gainMaxLines || 10;
        var RANKS = [];
        var newSlide;
        var newTable;
        var index = 0;
        var rank = i18next__WEBPACK_IMPORTED_MODULE_1__["t"]("gainTable.ranks.".concat(index));
        var gain = i18next__WEBPACK_IMPORTED_MODULE_1__["t"]("gainTable.gainRanks.".concat(index));
        var rows;
        while (rank !== "gainTable.ranks.".concat(index) && gain !== "gainTable.gainRanks.".concat(index)) {
            if (index % MAX_LINES === 0) {
                newSlide = new pixi_js__WEBPACK_IMPORTED_MODULE_0__["Container"]();
                newSlide.dockingBounds = new _gdk_core_pixi__WEBPACK_IMPORTED_MODULE_2__["DockingBounds"](gainBoard.dockingBounds.width, gainBoard.dockingBounds.height);
                newTable = new _gdk_core_pixi__WEBPACK_IMPORTED_MODULE_2__["Table"]();
                newTable.docking = new _gdk_core_pixi__WEBPACK_IMPORTED_MODULE_2__["Docking"](_gdk_core_pixi__WEBPACK_IMPORTED_MODULE_2__["Docking"].centerAll);
                newSlide.addChild(newTable);
                gains.push(newSlide);
                rows = [];
            }
            RANKS.push(rank);
            var RANK_TEXT = new _gdk_core_pixi__WEBPACK_IMPORTED_MODULE_2__["TextField"](rank, {
                fill: options.titleColor ? options.titleColor : BASE_COLOR,
                fontSize: LEFT_FONTSIZE,
            }, {
                align: _gdk_core_pixi__WEBPACK_IMPORTED_MODULE_2__["EAlign"].Left,
                noUpdate: true,
            });
            var GAIN_TEXT = new _gdk_core_pixi__WEBPACK_IMPORTED_MODULE_2__["TextField"](gain, {
                fill: options.titleColor ? options.titleColor : BASE_COLOR,
                fontSize: MAIN_FONTSIZE,
            }, {
                align: _gdk_core_pixi__WEBPACK_IMPORTED_MODULE_2__["EAlign"].Right,
                noUpdate: true,
            });
            rows.push([RANK_TEXT, GAIN_TEXT]);
            if (index % MAX_LINES === MAX_LINES - 1 ||
                i18next__WEBPACK_IMPORTED_MODULE_1__["t"]("gainTable.ranks.".concat(index + 1)) === "gainTable.ranks.".concat(index + 1) ||
                i18next__WEBPACK_IMPORTED_MODULE_1__["t"]("gainTable.gainRanks.".concat(index)) === "gainTable.gainRanks.".concat(index + 1)) {
                var COLUMN = rows.map(function (ROW) {
                    return ROW[1];
                });
                var maxWidth = 0;
                try {
                    for (var COLUMN_1 = (e_5 = void 0, __values(COLUMN)), COLUMN_1_1 = COLUMN_1.next(); !COLUMN_1_1.done; COLUMN_1_1 = COLUMN_1.next()) {
                        var TEXT = COLUMN_1_1.value;
                        if (TEXT.width > maxWidth) {
                            maxWidth = TEXT.width;
                        }
                    }
                }
                catch (e_5_1) { e_5 = { error: e_5_1 }; }
                finally {
                    try {
                        if (COLUMN_1_1 && !COLUMN_1_1.done && (_a = COLUMN_1.return)) _a.call(COLUMN_1);
                    }
                    finally { if (e_5) throw e_5.error; }
                }
                maxWidth += 40;
                newTable.setFixedWidth(newSlide.dockingBounds.width - 2 * TABLE_EXTERNAL_MARGIN);
                newTable.setFixedColumnsWidth([0, maxWidth]);
                newTable.push.apply(newTable, __spreadArray([], __read(rows), false));
                // send error cause the text is out of the popup
                if (newTable.height > MAX_HEIGHT) {
                    throw new Error("The gain table contains too much entries by slides");
                }
            }
            index++;
            rank = i18next__WEBPACK_IMPORTED_MODULE_1__["t"]("gainTable.ranks.".concat(index));
            gain = i18next__WEBPACK_IMPORTED_MODULE_1__["t"]("gainTable.gainRanks.".concat(index));
        }
        this.demoEndPopin.ranks = RANKS;
        this.replayEndPopin.ranks = RANKS;
        this.betEndPopin.ranks = RANKS;
    };
    DSPopinsContainer.prototype.setViAccessableElements = function (options) {
        this.addChild(this.viOverlay);
        this.setRules(options.titleColor);
        this.setGainBoard(options);
    };
    DSPopinsContainer.prototype.setConfirmPopin = function (options) {
        var _this = this;
        var confirmSentence = new _gdk_core_pixi__WEBPACK_IMPORTED_MODULE_2__["TextField"](i18next__WEBPACK_IMPORTED_MODULE_1__["t"]("confirm.content"), {
            default: {
                fontName: "OpenSans-SemiBold",
                fontSize: _popin__WEBPACK_IMPORTED_MODULE_11__["DSPopin"].textFontSize,
                fill: options.titleColor ? options.titleColor : BASE_COLOR,
            },
        }, {
            noUpdate: true,
        });
        confirmSentence.freeze();
        confirmSentence.wordWrap = true;
        confirmSentence.align = _gdk_core_pixi__WEBPACK_IMPORTED_MODULE_2__["EAlign"].Center;
        confirmSentence.width = _popin__WEBPACK_IMPORTED_MODULE_11__["DSPopin"].minWidth;
        confirmSentence.dockingBounds = new _gdk_core_pixi__WEBPACK_IMPORTED_MODULE_2__["DockingBounds"](_popin__WEBPACK_IMPORTED_MODULE_11__["DSPopin"].minWidth, 120);
        confirmSentence.unfreeze();
        this.confirmPopin = new _twoButtonsPopin__WEBPACK_IMPORTED_MODULE_4__["DSTwoButtonsPopin"]({
            base: {
                title: i18next__WEBPACK_IMPORTED_MODULE_1__["t"]("confirm.title"),
                titleColor: options.titleColor,
                content: confirmSentence,
            },
            right: {
                label: i18next__WEBPACK_IMPORTED_MODULE_1__["t"]("confirm.no"),
                color: options.secondaryColor,
                primary: false,
            },
            onRight: function () { return __awaiter(_this, void 0, void 0, function () {
                return __generator(this, function (_a) {
                    switch (_a.label) {
                        case 0: return [4 /*yield*/, this.cancelBet()];
                        case 1:
                            _a.sent();
                            return [2 /*return*/];
                    }
                });
            }); },
            left: {
                label: i18next__WEBPACK_IMPORTED_MODULE_1__["t"]("confirm.yes"),
                primary: true,
            },
            onLeft: function () { return __awaiter(_this, void 0, void 0, function () {
                return __generator(this, function (_a) {
                    switch (_a.label) {
                        case 0: return [4 /*yield*/, this.handleGameStart()];
                        case 1:
                            _a.sent();
                            return [2 /*return*/];
                    }
                });
            }); },
            shine: true,
        });
        this.confirmPopin.docking = new _gdk_core_pixi__WEBPACK_IMPORTED_MODULE_2__["Docking"](_gdk_core_pixi__WEBPACK_IMPORTED_MODULE_2__["Docking"].centerAll, 0, DSPopinsContainer.verticalOffset);
        this.addChild(this.confirmPopin);
    };
    DSPopinsContainer.prototype.setReplayPopin = function (options) {
        var _this = this;
        this.replayPopin = new _replayPopin__WEBPACK_IMPORTED_MODULE_8__["DSReplayPoptin"]({
            base: {
                title: i18next__WEBPACK_IMPORTED_MODULE_1__["t"]("replay.title"),
                titleColor: options.titleColor,
            },
            right: {
                label: i18next__WEBPACK_IMPORTED_MODULE_1__["t"]("replay.leftButton"),
                color: options.secondaryColor,
            },
            onRight: function () { return __awaiter(_this, void 0, void 0, function () {
                var _this = this;
                return __generator(this, function (_a) {
                    switch (_a.label) {
                        case 0: return [4 /*yield*/, this.confirm().catch(function (e) {
                                _this.replayPopin.show(false);
                                throw e;
                            })];
                        case 1:
                            _a.sent();
                            return [2 /*return*/];
                    }
                });
            }); },
            left: {
                label: i18next__WEBPACK_IMPORTED_MODULE_1__["t"]("replay.rightButton"),
            },
            onLeft: function () { return __awaiter(_this, void 0, void 0, function () {
                return __generator(this, function (_a) {
                    this.replay();
                    return [2 /*return*/];
                });
            }); },
            shine: true,
        }, this);
        this.replayPopin.docking = new _gdk_core_pixi__WEBPACK_IMPORTED_MODULE_2__["Docking"](_gdk_core_pixi__WEBPACK_IMPORTED_MODULE_2__["Docking"].centerAll, 0, DSPopinsContainer.verticalOffset);
        this.addChild(this.replayPopin);
    };
    DSPopinsContainer.prototype.setBetPopin = function (options) {
        var _this = this;
        this.betPopin = new _twoButtonsPopin__WEBPACK_IMPORTED_MODULE_4__["DSTwoButtonsPopin"]({
            base: {
                title: i18next__WEBPACK_IMPORTED_MODULE_1__["t"]("tryOrBuy.title"),
                titleColor: options.titleColor,
            },
            right: {
                label: i18next__WEBPACK_IMPORTED_MODULE_1__["t"]("tryOrBuy.try"),
                color: options.secondaryColor,
                primary: false,
            },
            onRight: function () { return __awaiter(_this, void 0, void 0, function () {
                return __generator(this, function (_a) {
                    switch (_a.label) {
                        case 0: return [4 /*yield*/, this.handleGameStart(true)];
                        case 1:
                            _a.sent();
                            return [2 /*return*/];
                    }
                });
            }); },
            left: {
                label: i18next__WEBPACK_IMPORTED_MODULE_1__["t"]("tryOrBuy.buy"),
                primary: true,
            },
            onLeft: function () { return __awaiter(_this, void 0, void 0, function () {
                var _this = this;
                return __generator(this, function (_a) {
                    switch (_a.label) {
                        case 0: return [4 /*yield*/, this.confirm().catch(function (e) {
                                _this.betPopin.show(false);
                                throw e;
                            })];
                        case 1:
                            _a.sent();
                            return [2 /*return*/];
                    }
                });
            }); },
            shine: true,
        });
        this.betPopin.docking = new _gdk_core_pixi__WEBPACK_IMPORTED_MODULE_2__["Docking"](_gdk_core_pixi__WEBPACK_IMPORTED_MODULE_2__["Docking"].centerAll, 0, DSPopinsContainer.verticalOffset);
        this.addChild(this.betPopin);
    };
    DSPopinsContainer.prototype.setReplayEndPopin = function (options) {
        var _this = this;
        this.replayEndPopin = new _winLosePopin__WEBPACK_IMPORTED_MODULE_5__["DSWinLosePopin"]({
            loseTitle: i18next__WEBPACK_IMPORTED_MODULE_1__["t"]("end.lose.title"),
            winTitle: i18next__WEBPACK_IMPORTED_MODULE_1__["t"]("end.win.title"),
            loseContent: i18next__WEBPACK_IMPORTED_MODULE_1__["t"]("end.lose.content"),
            winContentKey: "end.win.content",
            base: {
                title: "",
                titleColor: options.titleColor,
                onClose: function () { return __awaiter(_this, void 0, void 0, function () {
                    return __generator(this, function (_a) {
                        this.seeDemoResult();
                        return [2 /*return*/];
                    });
                }); },
            },
            right: {
                label: i18next__WEBPACK_IMPORTED_MODULE_1__["t"]("replay.leftButton"),
                color: options.secondaryColor,
            },
            onRight: function () { return __awaiter(_this, void 0, void 0, function () {
                var _this = this;
                return __generator(this, function (_a) {
                    switch (_a.label) {
                        case 0: return [4 /*yield*/, this.confirm().catch(function (e) {
                                _this.replayPopin.show(false);
                                throw e;
                            })];
                        case 1:
                            _a.sent();
                            return [2 /*return*/];
                    }
                });
            }); },
            left: {
                label: i18next__WEBPACK_IMPORTED_MODULE_1__["t"]("replay.rightButton"),
            },
            onLeft: function () { return __awaiter(_this, void 0, void 0, function () {
                return __generator(this, function (_a) {
                    this.replay();
                    return [2 /*return*/];
                });
            }); },
            shine: true,
        });
        this.replayEndPopin.docking = new _gdk_core_pixi__WEBPACK_IMPORTED_MODULE_2__["Docking"](_gdk_core_pixi__WEBPACK_IMPORTED_MODULE_2__["Docking"].centerAll, 0, DSPopinsContainer.verticalOffset);
        this.addChild(this.replayEndPopin);
    };
    DSPopinsContainer.prototype.setDemoEndPopin = function (options) {
        var _this = this;
        this.demoEndPopin = new _winLosePopin__WEBPACK_IMPORTED_MODULE_5__["DSWinLosePopin"]({
            loseTitle: i18next__WEBPACK_IMPORTED_MODULE_1__["t"]("tryEnd.lose.title"),
            winTitle: i18next__WEBPACK_IMPORTED_MODULE_1__["t"]("tryEnd.win.title"),
            exceptionnalTitle: i18next__WEBPACK_IMPORTED_MODULE_1__["t"]("tryEnd.exceptionnal.title"),
            loseContent: i18next__WEBPACK_IMPORTED_MODULE_1__["t"]("tryEnd.lose.content"),
            winContentKey: "tryEnd.win.content",
            exceptionnalContentKey: "tryEnd.exceptionnal.content",
            base: {
                title: "",
                titleColor: options.titleColor,
                onClose: function () { return __awaiter(_this, void 0, void 0, function () {
                    return __generator(this, function (_a) {
                        this.seeDemoResult();
                        return [2 /*return*/];
                    });
                }); },
            },
            left: {
                label: i18next__WEBPACK_IMPORTED_MODULE_1__["t"]("tryEnd.try"),
                color: options.secondaryColor,
            },
            onLeft: function () { return __awaiter(_this, void 0, void 0, function () {
                return __generator(this, function (_a) {
                    switch (_a.label) {
                        case 0: return [4 /*yield*/, this.handleGameStart(true)];
                        case 1:
                            _a.sent();
                            return [2 /*return*/];
                    }
                });
            }); },
            right: {
                label: i18next__WEBPACK_IMPORTED_MODULE_1__["t"]("tryEnd.buy"),
            },
            onRight: function () { return __awaiter(_this, void 0, void 0, function () {
                var _this = this;
                return __generator(this, function (_a) {
                    switch (_a.label) {
                        case 0: return [4 /*yield*/, this.confirm().catch(function (e) {
                                _this.demoEndPopin.show(true, _this.ticket);
                                throw e;
                            })];
                        case 1:
                            _a.sent();
                            return [2 /*return*/];
                    }
                });
            }); },
            shine: true,
        });
        this.demoEndPopin.docking = new _gdk_core_pixi__WEBPACK_IMPORTED_MODULE_2__["Docking"](_gdk_core_pixi__WEBPACK_IMPORTED_MODULE_2__["Docking"].centerAll, 0, DSPopinsContainer.verticalOffset);
        this.addChild(this.demoEndPopin);
    };
    DSPopinsContainer.prototype.setBetEndPopin = function (options) {
        var _this = this;
        this.betEndPopin = new _winLosePopin__WEBPACK_IMPORTED_MODULE_5__["DSWinLosePopin"]({
            loseTitle: i18next__WEBPACK_IMPORTED_MODULE_1__["t"]("end.lose.title"),
            winTitle: i18next__WEBPACK_IMPORTED_MODULE_1__["t"]("end.win.title"),
            exceptionnalTitle: i18next__WEBPACK_IMPORTED_MODULE_1__["t"]("end.exceptionnal.title"),
            loseContent: i18next__WEBPACK_IMPORTED_MODULE_1__["t"]("end.lose.content"),
            winContentKey: "end.win.content",
            exceptionnalContentKey: "end.exceptionnal.content",
            base: {
                title: "",
                titleColor: options.titleColor,
                onClose: function () { return __awaiter(_this, void 0, void 0, function () {
                    return __generator(this, function (_a) {
                        this.seeResult();
                        return [2 /*return*/];
                    });
                }); },
            },
            right: {
                label: i18next__WEBPACK_IMPORTED_MODULE_1__["t"]("end.buy"),
            },
            onRight: function () { return __awaiter(_this, void 0, void 0, function () {
                var _this = this;
                return __generator(this, function (_a) {
                    switch (_a.label) {
                        case 0: return [4 /*yield*/, this.confirm().catch(function (e) {
                                _this.betEndPopin.show(true, _this.ticket);
                                throw e;
                            })];
                        case 1:
                            _a.sent();
                            return [2 /*return*/];
                    }
                });
            }); },
            shine: true,
        });
        this.betEndPopin.docking = new _gdk_core_pixi__WEBPACK_IMPORTED_MODULE_2__["Docking"](_gdk_core_pixi__WEBPACK_IMPORTED_MODULE_2__["Docking"].centerAll, 0, DSPopinsContainer.verticalOffset);
        this.addChild(this.betEndPopin);
    };
    DSPopinsContainer.prototype.setResumePopin = function (options) {
        var _this = this;
        var resumeSentence = new _gdk_core_pixi__WEBPACK_IMPORTED_MODULE_2__["TextField"](i18next__WEBPACK_IMPORTED_MODULE_1__["t"]("resume.content"), {
            default: {
                fontName: "OpenSans-SemiBold",
                fontSize: _popin__WEBPACK_IMPORTED_MODULE_11__["DSPopin"].textFontSize,
                fill: options.titleColor ? options.titleColor : BASE_COLOR,
            },
        }, {
            noUpdate: true,
        });
        resumeSentence.freeze();
        resumeSentence.wordWrap = true;
        resumeSentence.align = _gdk_core_pixi__WEBPACK_IMPORTED_MODULE_2__["EAlign"].Center;
        resumeSentence.width = _popin__WEBPACK_IMPORTED_MODULE_11__["DSPopin"].minWidth;
        resumeSentence.dockingBounds = new _gdk_core_pixi__WEBPACK_IMPORTED_MODULE_2__["DockingBounds"](_popin__WEBPACK_IMPORTED_MODULE_11__["DSPopin"].minWidth, 120);
        resumeSentence.unfreeze();
        this.resumePopin = new _twoButtonsPopin__WEBPACK_IMPORTED_MODULE_4__["DSTwoButtonsPopin"]({
            base: {
                title: i18next__WEBPACK_IMPORTED_MODULE_1__["t"]("resume.title"),
                titleColor: options.titleColor,
                content: resumeSentence,
            },
            right: {
                label: i18next__WEBPACK_IMPORTED_MODULE_1__["t"]("resume.button"),
            },
            onRight: function () { return __awaiter(_this, void 0, void 0, function () {
                return __generator(this, function (_a) {
                    this.resume();
                    return [2 /*return*/];
                });
            }); },
        });
        this.resumePopin.docking = new _gdk_core_pixi__WEBPACK_IMPORTED_MODULE_2__["Docking"](_gdk_core_pixi__WEBPACK_IMPORTED_MODULE_2__["Docking"].centerAll, 0, DSPopinsContainer.verticalOffset);
        this.addChild(this.resumePopin);
    };
    DSPopinsContainer.verticalOffset = -25;
    DSPopinsContainer.verticalOffsetIOS = 0;
    return DSPopinsContainer;
}(pixi_js__WEBPACK_IMPORTED_MODULE_0__["Container"]));



/***/ }),

/***/ "./src/ds/replayPopin.ts":
/*!*******************************!*\
  !*** ./src/ds/replayPopin.ts ***!
  \*******************************/
/*! exports provided: DSReplayPoptin */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "DSReplayPoptin", function() { return DSReplayPoptin; });
/* harmony import */ var _gdk_core_pixi__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @gdk/core-pixi */ "@gdk/core-pixi");
/* harmony import */ var _gdk_core_pixi__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_gdk_core_pixi__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var i18next__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! i18next */ "i18next");
/* harmony import */ var i18next__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(i18next__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var _twoButtonsPopin__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./twoButtonsPopin */ "./src/ds/twoButtonsPopin.ts");
/* harmony import */ var _popin__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./popin */ "./src/ds/popin.ts");
var __extends = (undefined && undefined.__extends) || (function () {
    var extendStatics = function (d, b) {
        extendStatics = Object.setPrototypeOf ||
            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||
            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };
        return extendStatics(d, b);
    };
    return function (d, b) {
        if (typeof b !== "function" && b !== null)
            throw new TypeError("Class extends value " + String(b) + " is not a constructor or null");
        extendStatics(d, b);
        function __() { this.constructor = d; }
        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
    };
})();




var REPLAY_CONTENT = "replay.content";
var DSReplayPoptin = /** @class */ (function (_super) {
    __extends(DSReplayPoptin, _super);
    function DSReplayPoptin(options, popinsContainer) {
        var _this = this;
        var replaySentence = new _gdk_core_pixi__WEBPACK_IMPORTED_MODULE_0__["TextField"](i18next__WEBPACK_IMPORTED_MODULE_1__["t"](REPLAY_CONTENT), {
            default: {
                fontName: "OpenSans-SemiBold",
                fontSize: _popin__WEBPACK_IMPORTED_MODULE_3__["DSPopin"].textFontSize,
                fill: options.base.titleColor ? options.base.titleColor : "#000000",
            },
        });
        replaySentence.freeze();
        replaySentence.wordWrap = true;
        replaySentence.align = _gdk_core_pixi__WEBPACK_IMPORTED_MODULE_0__["EAlign"].Center;
        replaySentence.width = _popin__WEBPACK_IMPORTED_MODULE_3__["DSPopin"].minWidth;
        replaySentence.dockingBounds = new _gdk_core_pixi__WEBPACK_IMPORTED_MODULE_0__["DockingBounds"](_popin__WEBPACK_IMPORTED_MODULE_3__["DSPopin"].minWidth, 120);
        replaySentence.unfreeze({ noUpdate: true });
        options.base.content = replaySentence;
        _this = _super.call(this, options) || this;
        _this.popinsContainer = popinsContainer;
        _this.replaySentence = replaySentence;
        return _this;
    }
    /**
     * Show the popin with or without close button
     *
     * @access public
     * @param {boolean} withClose, should add the close button
     */
    DSReplayPoptin.prototype.show = function (withClose) {
        this.replaySentence.text = i18next__WEBPACK_IMPORTED_MODULE_1__["t"](REPLAY_CONTENT, {
            ticketId: this.popinsContainer.ticket.ticketId,
        });
        _super.prototype.show.call(this, withClose);
    };
    return DSReplayPoptin;
}(_twoButtonsPopin__WEBPACK_IMPORTED_MODULE_2__["DSTwoButtonsPopin"]));



/***/ }),

/***/ "./src/ds/shineableButton.ts":
/*!***********************************!*\
  !*** ./src/ds/shineableButton.ts ***!
  \***********************************/
/*! exports provided: ShineableButton */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ShineableButton", function() { return ShineableButton; });
/* harmony import */ var _gdk_core_pixi__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @gdk/core-pixi */ "@gdk/core-pixi");
/* harmony import */ var _gdk_core_pixi__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_gdk_core_pixi__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var pixi_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! pixi.js */ "pixi.js");
/* harmony import */ var pixi_js__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(pixi_js__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var gsap__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! gsap */ "gsap");
/* harmony import */ var gsap__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(gsap__WEBPACK_IMPORTED_MODULE_2__);
var __extends = (undefined && undefined.__extends) || (function () {
    var extendStatics = function (d, b) {
        extendStatics = Object.setPrototypeOf ||
            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||
            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };
        return extendStatics(d, b);
    };
    return function (d, b) {
        if (typeof b !== "function" && b !== null)
            throw new TypeError("Class extends value " + String(b) + " is not a constructor or null");
        extendStatics(d, b);
        function __() { this.constructor = d; }
        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
    };
})();



var CTA = "buttons/primary/shine";
var ShineableButton = /** @class */ (function (_super) {
    __extends(ShineableButton, _super);
    function ShineableButton(options, textStyles, text) {
        var _this = _super.call(this, options.button, textStyles, text) || this;
        _this._bump = 0;
        if (options.shine) {
            _this.shine = new pixi_js__WEBPACK_IMPORTED_MODULE_1__["Sprite"](pixi_js__WEBPACK_IMPORTED_MODULE_1__["Texture"].from(CTA));
            _this.addChild(_this.shine);
            _this.shine.anchor.x = 0;
            _this.shine.anchor.y = 0;
        }
        return _this;
    }
    /**
     * It will update the button size to fit min width or the text
     *
     * @access public
     */
    ShineableButton.prototype.updateSize = function () {
        if (this.shine) {
            if (!this.shineMask) {
                this.shineMask = new pixi_js__WEBPACK_IMPORTED_MODULE_1__["Graphics"]();
            }
            else {
                this.shineMask.clear();
            }
            this.shineMask.beginFill(0xffffff, 1);
            this.shineMask.drawRoundedRect(9, 8, this.backgroundNineSlice.width - 18, this.backgroundNineSlice.height - 20, 9);
            this.shineMask.endFill();
            this.addChild(this.shineMask);
            this.shine.mask = this.shineMask;
            this.shine.scaleXY = this.shineScale = this.backgroundNineSlice.height / this.shine.height;
            gsap__WEBPACK_IMPORTED_MODULE_2__["TweenMax"].fromTo(this.shine, 0.9, {
                x: -this.shine.width,
            }, {
                x: this.backgroundNineSlice.width,
                repeat: -1,
                repeatDelay: 2,
                ease: gsap__WEBPACK_IMPORTED_MODULE_2__["Linear"].easeNone,
            });
            gsap__WEBPACK_IMPORTED_MODULE_2__["TweenMax"].fromTo(this, 0.9, {
                bump: 0,
            }, {
                bump: Math.PI,
                repeat: -1,
                repeatDelay: 2,
                ease: gsap__WEBPACK_IMPORTED_MODULE_2__["Linear"].easeNone,
            });
        }
    };
    Object.defineProperty(ShineableButton.prototype, "bump", {
        /**
         * It will return the current bump state
         *
         * @access public
         */
        get: function () {
            return this._bump;
        },
        /**
         * It will set the shine bump (scale bump)
         *
         * @access public
         * @param {number} bump, the bump size
         */
        set: function (bump) {
            this._bump = this.shineScale * (1 + Math.sin(bump));
            this.shine.scaleXY = this._bump;
        },
        enumerable: false,
        configurable: true
    });
    Object.defineProperty(ShineableButton.prototype, "enabled", {
        /**
         * Get the enabled state
         *
         * @access public
         */
        get: function () {
            return this._enabled;
        },
        /**
         * @Override, It will set the button with or without shine
         *
         * @access public
         * @param {boolean} enabled, enable the button or not
         */
        set: function (enabled) {
            if (this.shine) {
                this.shine.visible = enabled;
            }
            if (!enabled) {
                if (this.disabledTexture) {
                    this._updateTexture(this.disabledTexture);
                }
            }
            else {
                this._updateTexture(this.idleTexture);
            }
            this._updateTextStyle(enabled ? this.textStates.idle : this.textStates.disabled);
            this._enabled = enabled;
            this.interactive = enabled;
            this.buttonMode = enabled;
        },
        enumerable: false,
        configurable: true
    });
    return ShineableButton;
}(_gdk_core_pixi__WEBPACK_IMPORTED_MODULE_0__["Button"]));



/***/ }),

/***/ "./src/ds/twoButtonsPopin.ts":
/*!***********************************!*\
  !*** ./src/ds/twoButtonsPopin.ts ***!
  \***********************************/
/*! exports provided: DSTwoButtonsPopin */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "DSTwoButtonsPopin", function() { return DSTwoButtonsPopin; });
/* harmony import */ var pixi_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! pixi.js */ "pixi.js");
/* harmony import */ var pixi_js__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(pixi_js__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var _gdk_core_pixi__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @gdk/core-pixi */ "@gdk/core-pixi");
/* harmony import */ var _gdk_core_pixi__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(_gdk_core_pixi__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var _popin__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./popin */ "./src/ds/popin.ts");
/* harmony import */ var _shineableButton__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./shineableButton */ "./src/ds/shineableButton.ts");
var __extends = (undefined && undefined.__extends) || (function () {
    var extendStatics = function (d, b) {
        extendStatics = Object.setPrototypeOf ||
            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||
            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };
        return extendStatics(d, b);
    };
    return function (d, b) {
        if (typeof b !== "function" && b !== null)
            throw new TypeError("Class extends value " + String(b) + " is not a constructor or null");
        extendStatics(d, b);
        function __() { this.constructor = d; }
        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
    };
})();
var __values = (undefined && undefined.__values) || function(o) {
    var s = typeof Symbol === "function" && Symbol.iterator, m = s && o[s], i = 0;
    if (m) return m.call(o);
    if (o && typeof o.length === "number") return {
        next: function () {
            if (o && i >= o.length) o = void 0;
            return { value: o && o[i++], done: !o };
        }
    };
    throw new TypeError(s ? "Object is not iterable." : "Symbol.iterator is not defined.");
};




var LEFT_TOP_RIGHT = 30;
var BOTTOM = 40;
var BUTTONS_SPACE = 80;
var DEFAULT_COLOR = "#000000";
var TEXTURES = {
    primary: {
        idleTexture: "buttons/primary/idle",
        overTexture: "buttons/primary/over",
        clickedTexture: "buttons/primary/idle",
        disabledTexture: "buttons/primary/idle",
    },
    secondary: {
        idleTexture: "buttons/secondary/idle",
        overTexture: "buttons/secondary/over",
        clickedTexture: "buttons/secondary/idle",
        disabledTexture: "buttons/secondary/idle",
    },
};
var DSTwoButtonsPopin = /** @class */ (function (_super) {
    __extends(DSTwoButtonsPopin, _super);
    function DSTwoButtonsPopin(options) {
        var e_1, _a;
        var _this = this;
        var _b, _c, _d;
        var baseContent = options.base.content || new pixi_js__WEBPACK_IMPORTED_MODULE_0__["Container"]();
        if (!baseContent.dockingBounds) {
            baseContent.dockingBounds = new _gdk_core_pixi__WEBPACK_IMPORTED_MODULE_1__["DockingBounds"](0, 0);
        }
        options.base.content = null;
        _this = _super.call(this, options.base) || this;
        _this.content.addChild(baseContent);
        _this.content.dockingBounds = new _gdk_core_pixi__WEBPACK_IMPORTED_MODULE_1__["DockingBounds"](baseContent.dockingBounds.width, baseContent.dockingBounds.height + BUTTONS_SPACE);
        _this.baseContent = baseContent;
        if (options.left) {
            var primary = (_b = options.left.primary) !== null && _b !== void 0 ? _b : false;
            var textures = TEXTURES[primary ? "primary" : "secondary"];
            _this.leftButton = new _shineableButton__WEBPACK_IMPORTED_MODULE_3__["ShineableButton"]({
                button: textures,
                shine: primary && options.shine,
            }, {
                default: {
                    fontName: "OpenSans-SemiBold",
                    fontSize: _popin__WEBPACK_IMPORTED_MODULE_2__["DSPopin"].buttonFontSize,
                    fill: options.left.color ? options.left.color : DEFAULT_COLOR,
                },
            }, options.left.label);
            // this.leftButton.docking = new Docking(Docking.bottomLeft);
            _this.leftButton.on("pointertap", function () {
                _this.executeButtonCallback(options.onLeft);
            });
        }
        var rightIsPrimary = (_d = (_c = options.right) === null || _c === void 0 ? void 0 : _c.primary) !== null && _d !== void 0 ? _d : true;
        var rightTextures = TEXTURES[rightIsPrimary ? "primary" : "secondary"];
        _this.rightButton = new _shineableButton__WEBPACK_IMPORTED_MODULE_3__["ShineableButton"]({
            button: rightTextures,
            shine: rightIsPrimary && options.shine,
        }, {
            default: {
                fontName: "OpenSans-SemiBold",
                fontSize: _popin__WEBPACK_IMPORTED_MODULE_2__["DSPopin"].buttonFontSize,
                fill: options.right.color ? options.right.color : DEFAULT_COLOR,
            },
        }, options.right.label);
        // this.rightButton.docking = new Docking(options.left ? Docking.bottomRight : Docking.bottomCenterHorizontal);
        _this.rightButton.on("pointertap", function () {
            _this.executeButtonCallback(options.onRight);
        });
        var buttons = [_this.rightButton];
        if (options.left) {
            buttons.unshift(_this.leftButton);
        }
        try {
            for (var buttons_1 = __values(buttons), buttons_1_1 = buttons_1.next(); !buttons_1_1.done; buttons_1_1 = buttons_1.next()) {
                var button = buttons_1_1.value;
                button.isNineSlice = true;
                button.backgroundNineSlice.leftWidth = LEFT_TOP_RIGHT;
                button.backgroundNineSlice.topHeight = LEFT_TOP_RIGHT;
                button.backgroundNineSlice.rightWidth = LEFT_TOP_RIGHT;
                button.backgroundNineSlice.bottomHeight = BOTTOM;
                button.nineSliceMinSize.x = 280;
                button.nineSliceMinSize.y = 70;
                button.nineSlicePadding.x = 20;
                button.nineSlicePadding.y = 21;
                button.nineSlicePadding.width = 20;
                button.nineSlicePadding.height = 22;
                // this.content.addChild(button);
                _this.buttonStack.push(button, false);
                // Useful for resizing a niceSlice Button
                button.label = button.label;
            }
        }
        catch (e_1_1) { e_1 = { error: e_1_1 }; }
        finally {
            try {
                if (buttons_1_1 && !buttons_1_1.done && (_a = buttons_1.return)) _a.call(buttons_1);
            }
            finally { if (e_1) throw e_1.error; }
        }
        if (_this.leftButton !== undefined) {
            _this.leftButton.updateSize();
        }
        _this.rightButton.updateSize();
        return _this;
    }
    /**
     * Resize the popin to fit the content
     *
     * @access public
     */
    DSTwoButtonsPopin.prototype.resizePopin = function () {
        this.content.dockingBounds.width = this.baseContent.dockingBounds.width;
        this.content.dockingBounds.height = this.baseContent.dockingBounds.height;
        if (this.content.dockingBounds.width < _popin__WEBPACK_IMPORTED_MODULE_2__["DSPopin"].minWidth) {
            this.content.dockingBounds.width = _popin__WEBPACK_IMPORTED_MODULE_2__["DSPopin"].minWidth;
        }
        _super.prototype.resizePopin.call(this);
    };
    /**
     * Show with or without close button
     *
     * @access public
     * @param {boolean} withClose=false, should add the close button
     */
    DSTwoButtonsPopin.prototype.show = function (withClose) {
        if (withClose === void 0) { withClose = false; }
        this.closeButton.visible = Boolean(withClose);
        _super.prototype.show.call(this);
    };
    DSTwoButtonsPopin.prototype.activateButtons = function (activate) {
        var e_2, _a;
        try {
            for (var _b = __values(["leftButton", "rightButton", "closeButton"]), _c = _b.next(); !_c.done; _c = _b.next()) {
                var key = _c.value;
                if (this[key]) {
                    this[key].enabled = activate;
                }
            }
        }
        catch (e_2_1) { e_2 = { error: e_2_1 }; }
        finally {
            try {
                if (_c && !_c.done && (_a = _b.return)) _a.call(_b);
            }
            finally { if (e_2) throw e_2.error; }
        }
    };
    return DSTwoButtonsPopin;
}(_popin__WEBPACK_IMPORTED_MODULE_2__["DSPopin"]));



/***/ }),

/***/ "./src/ds/viButtons.ts":
/*!*****************************!*\
  !*** ./src/ds/viButtons.ts ***!
  \*****************************/
/*! exports provided: DSVIButtons */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "DSVIButtons", function() { return DSVIButtons; });
/* harmony import */ var _gdk_core_pixi__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @gdk/core-pixi */ "@gdk/core-pixi");
/* harmony import */ var _gdk_core_pixi__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_gdk_core_pixi__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var i18next__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! i18next */ "i18next");
/* harmony import */ var i18next__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(i18next__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var _shineableButton__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./shineableButton */ "./src/ds/shineableButton.ts");
/* harmony import */ var _adaptativeVisualIdentity__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../adaptativeVisualIdentity */ "./src/adaptativeVisualIdentity/index.ts");
/* harmony import */ var _popin__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./popin */ "./src/ds/popin.ts");
var __values = (undefined && undefined.__values) || function(o) {
    var s = typeof Symbol === "function" && Symbol.iterator, m = s && o[s], i = 0;
    if (m) return m.call(o);
    if (o && typeof o.length === "number") return {
        next: function () {
            if (o && i >= o.length) o = void 0;
            return { value: o && o[i++], done: !o };
        }
    };
    throw new TypeError(s ? "Object is not iterable." : "Symbol.iterator is not defined.");
};





var BASE = "buttons/autoskrab/";
var IDLE = "".concat(BASE, "idle");
var OVER = "".concat(BASE, "over");
var CLICKED = "".concat(BASE, "down");
var DISABLED = "".concat(BASE, "disabled");
var PADDING = 15;
var PADDING_WIDTH = 30;
var COLOR = "#000000";
var KEYS = {
    auto: "reveal.auto",
    stop: "reveal.pause",
    playAgain: "reveal.playAgain",
    tryAgain: "reveal.tryAgain",
};
var DSVIButtons = /** @class */ (function () {
    function DSVIButtons(game, callbacks) {
        var e_1, _a;
        this.buttons = [];
        this.game = game;
        this.onAuto = callbacks.onAuto;
        this.onStop = callbacks.onStop;
        this.onPlayAgain = callbacks.onPlayAgain;
        this.onTryAgain = callbacks.onTryAgain;
        try {
            for (var _b = __values(["auto", "stop", "playAgain", "tryAgain"]), _c = _b.next(); !_c.done; _c = _b.next()) {
                var key = _c.value;
                if (key === "playAgain" || key === "tryAgain") {
                    this[key] = new _shineableButton__WEBPACK_IMPORTED_MODULE_2__["ShineableButton"]({
                        button: {
                            idleTexture: IDLE,
                            overTexture: OVER,
                            clickedTexture: CLICKED,
                            disabledTexture: DISABLED,
                        },
                        shine: true,
                    }, {
                        default: {
                            fontName: "OpenSans-SemiBold",
                            fontSize: _popin__WEBPACK_IMPORTED_MODULE_4__["DSPopin"].menuButtonFontSize,
                            fill: COLOR,
                        },
                    }, "");
                }
                else {
                    this[key] = new _gdk_core_pixi__WEBPACK_IMPORTED_MODULE_0__["Button"]({
                        idleTexture: IDLE,
                        overTexture: OVER,
                        clickedTexture: CLICKED,
                        disabledTexture: DISABLED,
                    }, {
                        default: {
                            fontName: "OpenSans-SemiBold",
                            fontSize: _popin__WEBPACK_IMPORTED_MODULE_4__["DSPopin"].menuButtonFontSize,
                            fill: COLOR,
                        },
                    }, "");
                }
                this[key].docking = new _gdk_core_pixi__WEBPACK_IMPORTED_MODULE_0__["Docking"](_gdk_core_pixi__WEBPACK_IMPORTED_MODULE_0__["Docking"].centerAll);
                this[key].text.docking.y = -4;
                this[key].isNineSlice = true;
                this[key].backgroundNineSlice.leftWidth = PADDING_WIDTH;
                this[key].backgroundNineSlice.topHeight = PADDING;
                this[key].backgroundNineSlice.rightWidth = PADDING_WIDTH;
                this[key].backgroundNineSlice.bottomHeight = PADDING;
                this[key].nineSliceMinSize.x = 170;
                this[key].nineSliceMinSize.y = 70;
                this[key].nineSlicePadding.x = PADDING;
                this[key].nineSlicePadding.y = PADDING;
                this[key].nineSlicePadding.width = PADDING;
                this[key].nineSlicePadding.height = PADDING;
                this[key].label = i18next__WEBPACK_IMPORTED_MODULE_1__["t"](KEYS[key]);
                this[key].trackingName = key;
                this.buttons.push(this[key]);
            }
        }
        catch (e_1_1) { e_1 = { error: e_1_1 }; }
        finally {
            try {
                if (_c && !_c.done && (_a = _b.return)) _a.call(_b);
            }
            finally { if (e_1) throw e_1.error; }
        }
        this.deactivateButtons();
        this.auto.on("pointertap", this.onAuto);
        this.stop.on("pointertap", this.onStop);
        this.playAgain.on("pointertap", this.onPlayAgain);
        this.tryAgain.on("pointertap", this.onTryAgain);
        this.game.vi.emit(_adaptativeVisualIdentity__WEBPACK_IMPORTED_MODULE_3__["EVisualIdentityAction"].AddControlButton, this.buttons);
    }
    /**
     * Activate the play again button
     *
     * @access public
     */
    DSVIButtons.prototype.activatePlayAgain = function () {
        this.activateButtons([this.playAgain]);
        this.playAgain.updateSize();
    };
    /**
     * Activate the try again button
     *
     * @access public
     */
    DSVIButtons.prototype.activateTryAgain = function () {
        this.activateButtons([this.tryAgain]);
        this.tryAgain.updateSize();
    };
    /**
     * Activate the auto button
     *
     * @access public
     */
    DSVIButtons.prototype.activateAuto = function () {
        this.activateButtons([this.auto]);
    };
    /**
     * Activate the pause button
     *
     * @access public
     */
    DSVIButtons.prototype.activatePause = function () {
        this.activateButtons([this.stop]);
    };
    /**
     * It will hide all the vi buttons.
     *
     * @access public
     * @param {boolean} deactivateAll=false, if it must disable all buttons
     */
    DSVIButtons.prototype.hideButtons = function (deactivateAll) {
        var e_2, _a;
        if (deactivateAll === void 0) { deactivateAll = false; }
        try {
            for (var _b = __values(this.buttons), _c = _b.next(); !_c.done; _c = _b.next()) {
                var button = _c.value;
                button.visible = false;
            }
        }
        catch (e_2_1) { e_2 = { error: e_2_1 }; }
        finally {
            try {
                if (_c && !_c.done && (_a = _b.return)) _a.call(_b);
            }
            finally { if (e_2) throw e_2.error; }
        }
        if (deactivateAll) {
            this.deactivateButtons();
        }
    };
    /**
     * Show all the active buttons
     *
     * @access public
     */
    DSVIButtons.prototype.showActiveButtons = function () {
        var e_3, _a;
        this.hideButtons();
        try {
            for (var _b = __values(this.buttons), _c = _b.next(); !_c.done; _c = _b.next()) {
                var button = _c.value;
                if (button.enabled) {
                    button.visible = true;
                }
            }
        }
        catch (e_3_1) { e_3 = { error: e_3_1 }; }
        finally {
            try {
                if (_c && !_c.done && (_a = _b.return)) _a.call(_b);
            }
            finally { if (e_3) throw e_3.error; }
        }
    };
    DSVIButtons.prototype.activateButtons = function (buttons) {
        var e_4, _a;
        this.deactivateButtons();
        try {
            for (var buttons_1 = __values(buttons), buttons_1_1 = buttons_1.next(); !buttons_1_1.done; buttons_1_1 = buttons_1.next()) {
                var button = buttons_1_1.value;
                button.enabled = true;
            }
        }
        catch (e_4_1) { e_4 = { error: e_4_1 }; }
        finally {
            try {
                if (buttons_1_1 && !buttons_1_1.done && (_a = buttons_1.return)) _a.call(buttons_1);
            }
            finally { if (e_4) throw e_4.error; }
        }
        this.showActiveButtons();
    };
    DSVIButtons.prototype.deactivateButtons = function () {
        var e_5, _a;
        try {
            for (var _b = __values(this.buttons), _c = _b.next(); !_c.done; _c = _b.next()) {
                var button = _c.value;
                button.enabled = false;
            }
        }
        catch (e_5_1) { e_5 = { error: e_5_1 }; }
        finally {
            try {
                if (_c && !_c.done && (_a = _b.return)) _a.call(_b);
            }
            finally { if (e_5) throw e_5.error; }
        }
        this.showActiveButtons();
    };
    return DSVIButtons;
}());



/***/ }),

/***/ "./src/ds/winLosePopin.ts":
/*!********************************!*\
  !*** ./src/ds/winLosePopin.ts ***!
  \********************************/
/*! exports provided: DSWinLosePopin */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "DSWinLosePopin", function() { return DSWinLosePopin; });
/* harmony import */ var _gdk_core_pixi__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @gdk/core-pixi */ "@gdk/core-pixi");
/* harmony import */ var _gdk_core_pixi__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_gdk_core_pixi__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var _gdk_core__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @gdk/core */ "@gdk/core");
/* harmony import */ var _gdk_core__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(_gdk_core__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var i18next__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! i18next */ "i18next");
/* harmony import */ var i18next__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(i18next__WEBPACK_IMPORTED_MODULE_2__);
/* harmony import */ var _falcon_bridge__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @falcon/bridge */ "@falcon/bridge");
/* harmony import */ var _falcon_bridge__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(_falcon_bridge__WEBPACK_IMPORTED_MODULE_3__);
/* harmony import */ var _game__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../game */ "./src/game/index.ts");
/* harmony import */ var _twoButtonsPopin__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./twoButtonsPopin */ "./src/ds/twoButtonsPopin.ts");
/* harmony import */ var _popin__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./popin */ "./src/ds/popin.ts");
var __extends = (undefined && undefined.__extends) || (function () {
    var extendStatics = function (d, b) {
        extendStatics = Object.setPrototypeOf ||
            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||
            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };
        return extendStatics(d, b);
    };
    return function (d, b) {
        if (typeof b !== "function" && b !== null)
            throw new TypeError("Class extends value " + String(b) + " is not a constructor or null");
        extendStatics(d, b);
        function __() { this.constructor = d; }
        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
    };
})();







var DEFAULT_COLOR = "#000000";
var BOTTOM_SPACE = 30;
var DSWinLosePopin = /** @class */ (function (_super) {
    __extends(DSWinLosePopin, _super);
    function DSWinLosePopin(options) {
        var _this = this;
        var content = new _gdk_core_pixi__WEBPACK_IMPORTED_MODULE_0__["TextField"]("", {
            default: {
                fontName: "OpenSans-SemiBold",
                fontSize: _popin__WEBPACK_IMPORTED_MODULE_6__["DSPopin"].textFontSize,
                fill: options.base.titleColor ? options.base.titleColor : DEFAULT_COLOR,
            },
        });
        content.wordWrap = true;
        content.width = _popin__WEBPACK_IMPORTED_MODULE_6__["DSPopin"].minWidth;
        content.align = _gdk_core_pixi__WEBPACK_IMPORTED_MODULE_0__["EAlign"].Center;
        content.dockingBounds = new _gdk_core_pixi__WEBPACK_IMPORTED_MODULE_0__["DockingBounds"](0, 0);
        options.base.content = content;
        _this = _super.call(this, options) || this;
        _this.contentText = content;
        _this.loseTitle = options.loseTitle;
        _this.winTitle = options.winTitle;
        _this.exceptionnalTitle = options.exceptionnalTitle;
        _this.loseContent = options.loseContent;
        _this.winContentKey = options.winContentKey;
        _this.exceptionnalContentKey = options.exceptionnalContentKey;
        return _this;
    }
    /**
     * Show with or without close button, could use a Ticket to specify amount
     *
     * @access public
     * @param {boolean} withClose=false, Should show the close button
     * @param {Ticket} ticket?, the game ticket
     */
    DSWinLosePopin.prototype.show = function (withClose, ticket) {
        if (withClose === void 0) { withClose = false; }
        if (Boolean(this.exceptionnalTitle) &&
            Boolean(ticket.prize) &&
            ticket.prize.type === _falcon_bridge__WEBPACK_IMPORTED_MODULE_3__["EItgPrizeType"].periodicWinning) {
            // periodic winning
            this.title.text = this.exceptionnalTitle;
            this.contentText.text = i18next__WEBPACK_IMPORTED_MODULE_2__["t"](this.exceptionnalContentKey, { amount: this._formatAmount(ticket, true) })
                .replace(/\.\./g, ".");
        }
        else if (Boolean(this.exceptionnalTitle) &&
            ticket.action === _game__WEBPACK_IMPORTED_MODULE_4__["EBetResponseAction"].SUSPENSION_TRIGGERED) {
            // big win
            this.title.text = this.exceptionnalTitle;
            this.contentText.text = i18next__WEBPACK_IMPORTED_MODULE_2__["t"](this.exceptionnalContentKey, { amount: this._formatAmount(ticket) })
                .replace(/\.\./g, ".");
        }
        else if (ticket.wonAmount.value > 0) {
            // normal win
            this.title.text = this.winTitle;
            this.contentText.text = i18next__WEBPACK_IMPORTED_MODULE_2__["t"](this.winContentKey, { amount: this._formatAmount(ticket) })
                .replace(/\.\./g, ".");
        }
        else {
            // lose
            this.title.text = this.loseTitle;
            this.contentText.text = this.loseContent;
        }
        this.contentText.dockingBounds.width = this.contentText.width;
        this.contentText.dockingBounds.height = this.contentText.height + BOTTOM_SPACE;
        _super.prototype.show.call(this, withClose);
    };
    Object.defineProperty(DSWinLosePopin.prototype, "ranks", {
        /**
         * Set the ranks of the popin, it contains the descriptions of the game ranks.
         * They are used to display infomations on specials wins
         */
        set: function (ranks) {
            this._ranks = ranks;
        },
        enumerable: false,
        configurable: true
    });
    DSWinLosePopin.prototype._formatAmount = function (ticket, description) {
        if (description === void 0) { description = false; }
        var amount;
        if (description &&
            Boolean(ticket.prize) &&
            ticket.prize.rank &&
            Array.isArray(this._ranks) &&
            Boolean(this._ranks[ticket.prize.rank])) {
            amount = this._ranks[ticket.prize.rank - 1];
        }
        else {
            amount = _gdk_core__WEBPACK_IMPORTED_MODULE_1__["Numeral"].currency(ticket.wonAmount, {
                minimumFractionDigits: ticket.wonAmount.value % 100 === 0 ? 0 : 2,
            });
        }
        return amount;
    };
    return DSWinLosePopin;
}(_twoButtonsPopin__WEBPACK_IMPORTED_MODULE_5__["DSTwoButtonsPopin"]));



/***/ }),

/***/ "./src/game/abstractGame.ts":
/*!**********************************!*\
  !*** ./src/game/abstractGame.ts ***!
  \**********************************/
/*! exports provided: AbstractGame */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "AbstractGame", function() { return AbstractGame; });
/* harmony import */ var _gdk_core__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @gdk/core */ "@gdk/core");
/* harmony import */ var _gdk_core__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_gdk_core__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var _gdk_core_pixi__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @gdk/core-pixi */ "@gdk/core-pixi");
/* harmony import */ var _gdk_core_pixi__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(_gdk_core_pixi__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var gsap__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! gsap */ "gsap");
/* harmony import */ var gsap__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(gsap__WEBPACK_IMPORTED_MODULE_2__);
/* harmony import */ var howler__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! howler */ "howler");
/* harmony import */ var howler__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(howler__WEBPACK_IMPORTED_MODULE_3__);
/* harmony import */ var i18next__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! i18next */ "i18next");
/* harmony import */ var i18next__WEBPACK_IMPORTED_MODULE_4___default = /*#__PURE__*/__webpack_require__.n(i18next__WEBPACK_IMPORTED_MODULE_4__);
/* harmony import */ var pixi_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! pixi.js */ "pixi.js");
/* harmony import */ var pixi_js__WEBPACK_IMPORTED_MODULE_5___default = /*#__PURE__*/__webpack_require__.n(pixi_js__WEBPACK_IMPORTED_MODULE_5__);
/* harmony import */ var _adaptativeVisualIdentity__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../adaptativeVisualIdentity */ "./src/adaptativeVisualIdentity/index.ts");
/* harmony import */ var _com__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../com */ "./src/com/index.ts");
/* harmony import */ var _gameEvents__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ./gameEvents */ "./src/game/gameEvents.ts");
/* harmony import */ var _notifier_notifier__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ./notifier/notifier */ "./src/game/notifier/notifier.ts");
/* harmony import */ var _tweenUtils__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ./tweenUtils */ "./src/game/tweenUtils.ts");
var __extends = (undefined && undefined.__extends) || (function () {
    var extendStatics = function (d, b) {
        extendStatics = Object.setPrototypeOf ||
            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||
            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };
        return extendStatics(d, b);
    };
    return function (d, b) {
        if (typeof b !== "function" && b !== null)
            throw new TypeError("Class extends value " + String(b) + " is not a constructor or null");
        extendStatics(d, b);
        function __() { this.constructor = d; }
        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
    };
})();
var __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};
var __generator = (undefined && undefined.__generator) || function (thisArg, body) {
    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;
    return g = { next: verb(0), "throw": verb(1), "return": verb(2) }, typeof Symbol === "function" && (g[Symbol.iterator] = function() { return this; }), g;
    function verb(n) { return function (v) { return step([n, v]); }; }
    function step(op) {
        if (f) throw new TypeError("Generator is already executing.");
        while (g && (g = 0, op[0] && (_ = 0)), _) try {
            if (f = 1, y && (t = op[0] & 2 ? y["return"] : op[0] ? y["throw"] || ((t = y["return"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;
            if (y = 0, t) op = [op[0] & 2, t.value];
            switch (op[0]) {
                case 0: case 1: t = op; break;
                case 4: _.label++; return { value: op[1], done: false };
                case 5: _.label++; y = op[1]; op = [0]; continue;
                case 7: op = _.ops.pop(); _.trys.pop(); continue;
                default:
                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }
                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }
                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }
                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }
                    if (t[2]) _.ops.pop();
                    _.trys.pop(); continue;
            }
            op = body.call(thisArg, _);
        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }
        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };
    }
};
var __values = (undefined && undefined.__values) || function(o) {
    var s = typeof Symbol === "function" && Symbol.iterator, m = s && o[s], i = 0;
    if (m) return m.call(o);
    if (o && typeof o.length === "number") return {
        next: function () {
            if (o && i >= o.length) o = void 0;
            return { value: o && o[i++], done: !o };
        }
    };
    throw new TypeError(s ? "Object is not iterable." : "Symbol.iterator is not defined.");
};
var __read = (undefined && undefined.__read) || function (o, n) {
    var m = typeof Symbol === "function" && o[Symbol.iterator];
    if (!m) return o;
    var i = m.call(o), r, ar = [], e;
    try {
        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);
    }
    catch (error) { e = { error: error }; }
    finally {
        try {
            if (r && !r.done && (m = i["return"])) m.call(i);
        }
        finally { if (e) throw e.error; }
    }
    return ar;
};
var __spreadArray = (undefined && undefined.__spreadArray) || function (to, from, pack) {
    if (pack || arguments.length === 2) for (var i = 0, l = from.length, ar; i < l; i++) {
        if (ar || !(i in from)) {
            if (!ar) ar = Array.prototype.slice.call(from, 0, i);
            ar[i] = from[i];
        }
    }
    return to.concat(ar || Array.prototype.slice.call(from));
};











var AbstractGame = /** @class */ (function (_super) {
    __extends(AbstractGame, _super);
    /**
     * Constructor
     * @param gameConfig: the game configuration (game.conf.json)
     * @param width: the canvas width
     * @param height: the canvas height
     * @param noWebGL: enable/disable WebGL (to force Canvas)
     * @param options: the Pixi.js applicaiton options
     */
    function AbstractGame(gameConfig, width, height, noWebGL, options) {
        var _this = 
        // Initialize
        _super.call(this, width, height, noWebGL, _gdk_core__WEBPACK_IMPORTED_MODULE_0__["Tools"].assign(options, {
            createGameDiv: options.createGameDiv === undefined,
        })) || this;
        _this.skin = null;
        _this.rulesVisible = false;
        _this.events = new pixi_js__WEBPACK_IMPORTED_MODULE_5__["utils"].EventEmitter();
        _this._muted = false;
        /**
         * List of unique reasons this game was paused for.
         * This set is empty means: the game is not paused. Better use `paused` getter
         * to know if the game is paused.
         *
         * This set is updated by methods `pause` and `unpause`.
         */
        _this.pauseReasons = new Set();
        _this.com = new _com__WEBPACK_IMPORTED_MODULE_7__["Com"](_this);
        // merge behaviour into gameParameters, every property must be accessed in gameConfig.gameParameters
        gameConfig.gameParameters = _gdk_core__WEBPACK_IMPORTED_MODULE_0__["Tools"].merge(gameConfig.gameParameters, gameConfig.behavioursParameters[gameConfig.selectedBehaviour]);
        // Configure popin
        _com__WEBPACK_IMPORTED_MODULE_7__["Popin"].wrapper = _this.gameDiv;
        // Init logger
        _gdk_core__WEBPACK_IMPORTED_MODULE_0__["Logger"].init();
        // Create Visual identity
        _this.vi = new _adaptativeVisualIdentity__WEBPACK_IMPORTED_MODULE_6__["AdaptativeVisualIdentity"](_this, {
            lottery: gameConfig.behavioursParameters[gameConfig.selectedBehaviour].vi,
            theme: gameConfig.behavioursParameters[gameConfig.selectedBehaviour].viParameters.theme ||
                "default",
            parameters: gameConfig.behavioursParameters[gameConfig.selectedBehaviour].viParameters,
        });
        // Create the overlay used to disable all interactivity (ex: replay of a game)
        _this._createOverlay();
        // Events
        _this.onResize = function () { return _this.resize(); };
        _this.onShowLockScreen = function () {
            _this.mute(true);
            _this.pause("lockscreen");
            // TODO[epic=jackpot] JACKPOT_SHOW_LOCKSCREEN
            _this.com.bridge.emitEvent("JACKPOT_SHOW_LOCKSCREEN");
        };
        _this.onHideLockScreen = function () {
            _this.unpause("lockscreen");
            _this.tryToMute(false);
            // TODO[epic=jackpot] JACKPOT_HIDE_LOCKSCREEN
            _this.com.bridge.emitEvent("JACKPOT_HIDE_LOCKSCREEN");
        };
        _this.vi.emitter.on(_adaptativeVisualIdentity__WEBPACK_IMPORTED_MODULE_6__["EVisualIdentityAction"].SoundEnabled, function (enabled) {
            _this.mute(!enabled);
        });
        // Track quit event
        _this.vi.emitter.on(_adaptativeVisualIdentity__WEBPACK_IMPORTED_MODULE_6__["EVisualIdentityEvent"].QuitGame, function () {
            _gdk_core__WEBPACK_IMPORTED_MODULE_0__["tracker"].track(new _gdk_core__WEBPACK_IMPORTED_MODULE_0__["GameQuit"]());
            _this.com.bridge.executeAction("CLOSE_GAME");
        });
        // Handle Rules buttons
        var previouslyEnabled = false;
        _this.vi.emitter.on(_adaptativeVisualIdentity__WEBPACK_IMPORTED_MODULE_6__["EVisualIdentityEvent"].ShowSettings, function () {
            var _a;
            // Pause the game
            if ((_a = _this.gameConfig.gameParameters.pauseOnSettings) !== null && _a !== void 0 ? _a : true) {
                _this.pause("settings");
            }
            // On show settings, enable or disable rules buttons
            var enabled = _this.vi.inGameView.settingsComponent && _this.vi.inGameView.settingsComponent.rulesEnabled;
            previouslyEnabled = enabled;
            if (_this.state.current() === "rules") {
                enabled = false;
            }
            if (_this.vi.inGameView.settingsComponent) {
                _this.vi.inGameView.settingsComponent.rulesEnabled = enabled;
            }
        });
        _this.vi.emitter.on(_adaptativeVisualIdentity__WEBPACK_IMPORTED_MODULE_6__["EVisualIdentityEvent"].HideSettings, function () {
            var _a;
            if ((_a = _this.gameConfig.gameParameters.pauseOnSettings) !== null && _a !== void 0 ? _a : true) {
                _this.unpause("settings");
            }
            if (_this.vi.inGameView.settingsComponent) {
                _this.vi.inGameView.settingsComponent.rulesEnabled = previouslyEnabled;
            }
        });
        _this.vi.emitter.on(_adaptativeVisualIdentity__WEBPACK_IMPORTED_MODULE_6__["EVisualIdentityEvent"].ShowRules, function () {
            _this.onRulesOpen();
        });
        _this.vi.emitter.on(_adaptativeVisualIdentity__WEBPACK_IMPORTED_MODULE_6__["EVisualIdentityEvent"].HideRules, function () {
            _this.onRulesQuit();
        });
        _this.vi.emitter.on(_adaptativeVisualIdentity__WEBPACK_IMPORTED_MODULE_6__["EVisualIdentityEvent"].ShowMainRules, function () {
            _this.onRulesOpen();
        });
        _this.vi.emitter.on(_adaptativeVisualIdentity__WEBPACK_IMPORTED_MODULE_6__["EVisualIdentityEvent"].ShowWinningTable, function () {
            _this.onRulesOpen();
        });
        // Override events from game-core
        // (blur & focus)
        _this.onFocus = function () {
            if (_this.gameConfig.gameParameters.pauseOnBlur) {
                _this.unpause("blur");
            }
            if (_this.gameConfig.gameParameters.muteSoundOnBlur !== false) {
                _this.tryToMute(false);
            }
            _this.vi.emitter.emit(_adaptativeVisualIdentity__WEBPACK_IMPORTED_MODULE_6__["EVisualIdentityEvent"].GameFocused);
        };
        _this.onBlur = function () {
            // games may want to remains active on blur.
            if (_this.gameConfig.gameParameters.pauseOnBlur) {
                _this.pause("blur");
            }
            // We check !== false to ensure backward compatibility where muteSoundOnBlur
            // was undefined.
            if (_this.gameConfig.gameParameters.muteSoundOnBlur !== false) {
                _this.tryToMute(true);
            }
            _this.vi.emitter.emit(_adaptativeVisualIdentity__WEBPACK_IMPORTED_MODULE_6__["EVisualIdentityEvent"].GameBlurred);
        };
        // Request fullscreen
        _this.application.view.addEventListener("touchend", function () {
            _this.requestFullscreen();
        });
        // handle context menu blocking
        if (gameConfig.gameParameters.contextMenuBlocked) {
            document.addEventListener("contextmenu", function (e) {
                e.preventDefault();
            }, false);
        }
        // handle right click rejection
        if (gameConfig.gameParameters.rightClickRejected) {
            var interaction = _this.application.renderer.plugins.interaction;
            if (interaction.supportsPointerEvents) {
                window.document.removeEventListener("pointermove", interaction.onPointerMove, true);
                interaction.interactionDOMElement.removeEventListener("pointerdown", interaction.onPointerDown, true);
                window.removeEventListener("pointerup", interaction.onPointerUp, true);
            }
            else {
                window.document.removeEventListener("mousemove", interaction.onPointerMove, true);
                interaction.interactionDOMElement.removeEventListener("mousedown", interaction.onPointerDown, true);
                window.removeEventListener("mouseup", interaction.onPointerUp, true);
            }
            var legacyOnPointerDown_1 = interaction.onPointerDown;
            interaction.onPointerDown = function (e) {
                if (e.button !== 2) {
                    legacyOnPointerDown_1.call(this, e);
                }
            };
            var legacyOnPointerUp_1 = interaction.onPointerUp;
            interaction.onPointerUp = function (e) {
                if (e.button !== 2) {
                    legacyOnPointerUp_1.call(this, e);
                }
            };
            var legacyOnPointerMove_1 = interaction.onPointerMove;
            interaction.onPointerMove = function (e) {
                if (e.buttons === 0 || (e.buttons & 1) === 1) {
                    legacyOnPointerMove_1.call(this, e);
                }
            };
            if (interaction.supportsPointerEvents) {
                window.document.addEventListener("pointermove", interaction.onPointerMove, true);
                interaction.interactionDOMElement.addEventListener("pointerdown", interaction.onPointerDown, true);
                window.addEventListener("pointerup", interaction.onPointerUp, true);
            }
            else {
                window.document.addEventListener("mousemove", interaction.onPointerMove, true);
                interaction.interactionDOMElement.addEventListener("mousedown", interaction.onPointerDown, true);
                window.addEventListener("mouseup", interaction.onPointerUp, true);
            }
        }
        // Register sound loader
        _gdk_core__WEBPACK_IMPORTED_MODULE_0__["Loader"].register(new _gdk_core__WEBPACK_IMPORTED_MODULE_0__["HowlerLoader"]());
        _this.events.on(_gameEvents__WEBPACK_IMPORTED_MODULE_8__["EGameEvents"].GameEnd, function () {
            _this.com.messageManager.onGameEnd();
        });
        // Configure numeral
        _gdk_core__WEBPACK_IMPORTED_MODULE_0__["Numeral"].locale = gameConfig.selectedLocale;
        _gdk_core__WEBPACK_IMPORTED_MODULE_0__["Numeral"].currencyCode = gameConfig.stakes[0].currency;
        return _this;
    }
    /**
     * Return true if the game is paused for one of the given reasons.
     * If no reason passed, this method simply returns true if the game is paused.
     */
    AbstractGame.prototype.isPaused = function () {
        var e_1, _a;
        var reasons = [];
        for (var _i = 0; _i < arguments.length; _i++) {
            reasons[_i] = arguments[_i];
        }
        if (reasons.length === 0) {
            return this.pauseReasons.size > 0;
        }
        try {
            for (var reasons_1 = __values(reasons), reasons_1_1 = reasons_1.next(); !reasons_1_1.done; reasons_1_1 = reasons_1.next()) {
                var reason = reasons_1_1.value;
                if (this.pauseReasons.has(reason)) {
                    return true;
                }
            }
        }
        catch (e_1_1) { e_1 = { error: e_1_1 }; }
        finally {
            try {
                if (reasons_1_1 && !reasons_1_1.done && (_a = reasons_1.return)) _a.call(reasons_1);
            }
            finally { if (e_1) throw e_1.error; }
        }
        return false;
    };
    /**
     * Add a reason to pause the game. The game is actually paused if it wasn't yet.
     */
    AbstractGame.prototype.pause = function (reason) {
        var wasPaused = this.isPaused();
        this.pauseReasons.add(reason);
        console.debug("game.pause(".concat(reason, ").") +
            " Game pause reasons: [".concat(Array.from(this.pauseReasons).join(", "), "]"));
        if (!wasPaused) {
            this.events.emit(_gameEvents__WEBPACK_IMPORTED_MODULE_8__["EGameEvents"].GamePaused, true, reason);
            // send events to jackpot
            switch (reason) {
                case "blur":
                    this.com.bridge.emitEvent("JACKPOT_PAUSE");
                    break;
                case "lockscreen":
                    this.com.bridge.emitEvent("JACKPOT_SHOW_LOCKSCREEN");
                    break;
                case "rules":
                case "settings":
                case "messagemanager":
                    this.com.bridge.emitEvent("JACKPOT_CONFIGURE", { interactive: false });
                    break;
            }
            _tweenUtils__WEBPACK_IMPORTED_MODULE_10__["TweenUtils"].pauseAllTweens(false);
            pixi_js__WEBPACK_IMPORTED_MODULE_5__["ticker"].shared.stop();
            // Mute scratch sounds
            if (_gdk_core_pixi__WEBPACK_IMPORTED_MODULE_1__["Scratch2"].scratchSound) {
                _gdk_core_pixi__WEBPACK_IMPORTED_MODULE_1__["Scratch2"].scratchSound.mute(true);
            }
        }
    };
    /**
     * Unregister given reason from the list of reasons to pause and resume the game
     * is necessary.
     *
     * @returns boolean: was the game resumed ?
     *     true if this call did actually unpause the game,
     *     false otherwise
     */
    AbstractGame.prototype.unpause = function (reason) {
        var wasPaused = this.isPaused();
        this.pauseReasons.delete(reason);
        console.debug("game.unpause(".concat(reason, ").") +
            " Game pause reasons: [".concat(Array.from(this.pauseReasons).join(", "), "]"));
        // try to unmute sound, if it was muted
        if (!this.isPaused()) {
            this.mute(false);
        }
        if (wasPaused && !this.isPaused()) {
            this.events.emit(_gameEvents__WEBPACK_IMPORTED_MODULE_8__["EGameEvents"].GamePaused, false, reason);
            // send events to jackpot
            switch (reason) {
                case "blur":
                    this.com.bridge.emitEvent("JACKPOT_RESUME");
                    break;
                case "lockscreen":
                    this.com.bridge.emitEvent("JACKPOT_HIDE_LOCKSCREEN");
                    break;
                case "rules":
                case "settings":
                case "messagemanager":
                    if (!this.isPaused("rules", "settings", "messagemanager")) {
                        this.com.bridge.emitEvent("JACKPOT_CONFIGURE", { interactive: true });
                    }
                    break;
            }
            _tweenUtils__WEBPACK_IMPORTED_MODULE_10__["TweenUtils"].resumeAllTweens();
            pixi_js__WEBPACK_IMPORTED_MODULE_5__["ticker"].shared.start();
            // Unmute scratch sounds
            if (_gdk_core_pixi__WEBPACK_IMPORTED_MODULE_1__["Scratch2"].scratchSound) {
                _gdk_core_pixi__WEBPACK_IMPORTED_MODULE_1__["Scratch2"].scratchSound.mute(false);
            }
            return true;
        }
        return false;
    };
    /**
     * Pause tween animations
     */
    AbstractGame.prototype.onRulesOpen = function () {
        this.pause("rules");
        _tweenUtils__WEBPACK_IMPORTED_MODULE_10__["TweenUtils"].resumeRulesTweens();
        if (_gdk_core_pixi__WEBPACK_IMPORTED_MODULE_1__["Scratch2"].scratchSound) {
            _gdk_core_pixi__WEBPACK_IMPORTED_MODULE_1__["Scratch2"].scratchSound.mute(true);
        }
        this.rulesVisible = true;
        this.events.emit(_gameEvents__WEBPACK_IMPORTED_MODULE_8__["EGameEvents"].RulesOpen);
    };
    /**
     * Resume tween animations
     */
    AbstractGame.prototype.onRulesQuit = function () {
        _tweenUtils__WEBPACK_IMPORTED_MODULE_10__["TweenUtils"].pauseRulesTweens();
        if (_gdk_core_pixi__WEBPACK_IMPORTED_MODULE_1__["Scratch2"].scratchSound) {
            _gdk_core_pixi__WEBPACK_IMPORTED_MODULE_1__["Scratch2"].scratchSound.mute(false);
        }
        this.unpause("rules");
        this.rulesVisible = false;
        this.events.emit(_gameEvents__WEBPACK_IMPORTED_MODULE_8__["EGameEvents"].RulesQuit);
    };
    Object.defineProperty(AbstractGame.prototype, "soundStatus", {
        /**
         * Returns if the game sound is active (helper)
         */
        get: function () {
            return this.vi.soundEnabled;
        },
        enumerable: false,
        configurable: true
    });
    Object.defineProperty(AbstractGame.prototype, "hasSuperJackpot", {
        /**
         * Returns if the game is super jackpotized
         * (default: false)
         */
        get: function () {
            // TODO[epic=jackpot] change this
            return true;
        },
        enumerable: false,
        configurable: true
    });
    /**
     * Updates the purse
     * @param updateVi if should update the VI purse
     */
    AbstractGame.prototype.getPurse = function (updateVi) {
        return __awaiter(this, void 0, void 0, function () {
            var updatePurse, amount;
            var _this = this;
            return __generator(this, function (_a) {
                switch (_a.label) {
                    case 0:
                        updatePurse = function (updatedAmount) {
                            if (updateVi) {
                                _this.vi.emitter.emit(_adaptativeVisualIdentity__WEBPACK_IMPORTED_MODULE_6__["EVisualIdentityAction"].SetPurse, updatedAmount ? new _gdk_core__WEBPACK_IMPORTED_MODULE_0__["Amount"](updatedAmount) : null);
                            }
                        };
                        return [4 /*yield*/, this.com.getPurse()];
                    case 1:
                        amount = _a.sent();
                        updatePurse(amount);
                        return [2 /*return*/, amount];
                }
            });
        });
    };
    /**
     * Initializes all game's components:
     * - Com
     * - i18n
     * - getGameConfiguration
     * @param done called once initialization is done (com, i18n, etc.)
     */
    AbstractGame.prototype.init = function (done) {
        return __awaiter(this, void 0, void 0, function () {
            var EVENTID_DIMENSIONS, EVENTID_DIMENSIONS_LEGACY, dimensions;
            return __generator(this, function (_a) {
                switch (_a.label) {
                    case 0: return [4 /*yield*/, this.com.init()];
                    case 1:
                        _a.sent();
                        EVENTID_DIMENSIONS = "DIMENSIONS";
                        EVENTID_DIMENSIONS_LEGACY = "dimensions";
                        dimensions = {
                            width: this.settings.orientation === _gdk_core__WEBPACK_IMPORTED_MODULE_0__["EOrientation"].Portrait ? 480 : 800,
                            height: this.settings.orientation === _gdk_core__WEBPACK_IMPORTED_MODULE_0__["EOrientation"].Portrait ? 640 : 600,
                        };
                        this.com.bridge.emitEvent(EVENTID_DIMENSIONS, dimensions);
                        this.com.bridge.emitEvent(EVENTID_DIMENSIONS_LEGACY, dimensions);
                        if (this.com.bridge.channel.setNotifier) {
                            this.com.bridge.channel.setNotifier(new _notifier_notifier__WEBPACK_IMPORTED_MODULE_9__["Notifier"](this));
                        }
                        _gdk_core__WEBPACK_IMPORTED_MODULE_0__["tracker"].init({ com: this.com, logger: _gdk_core__WEBPACK_IMPORTED_MODULE_0__["Logger"].getLogger() });
                        // Init i18n
                        this.settings.language = this.gameConfig.selectedLocale;
                        i18next__WEBPACK_IMPORTED_MODULE_4___default.a.init({
                            lng: this.gameConfig.selectedLocale,
                            resources: {},
                        });
                        i18next__WEBPACK_IMPORTED_MODULE_4___default.a.setDefaultNamespace("game");
                        // Init com i18n
                        return [4 /*yield*/, this.com.initI18n()];
                    case 2:
                        // Init com i18n
                        _a.sent();
                        done();
                        return [2 /*return*/];
                }
            });
        });
    };
    /**
     * Starts the game.
     * @param view Specifies the first view to make appear.
     * @param done Optionnal callback called once start is done.
     * @returns A promise resolved when the game is loaded and started or void for backward compatibility.
     */
    AbstractGame.prototype.start = function (state, done) {
        return this._start(state, done);
    };
    AbstractGame.prototype._start = function (state, done) {
        return __awaiter(this, void 0, void 0, function () {
            var _this = this;
            return __generator(this, function (_a) {
                switch (_a.label) {
                    case 0:
                        // Give event emitter to state.
                        if (this.state) {
                            this.state.eventEmitter = this.events;
                        }
                        return [4 /*yield*/, this._startVI()];
                    case 1:
                        _a.sent();
                        // When loading, we disable the lock screen.
                        // The lock screen is only enabled when the game has been loaded.
                        // To perform this action, just force resize
                        this.lockScreenEnabled = false;
                        this.resize(innerWidth, innerHeight, true);
                        // Now add the canvas into the webpage
                        this.gameDiv.appendChild(this.application.view);
                        // Update purse using the Communication module. Then, update the VI's purse
                        return [4 /*yield*/, this.getPurse(true)];
                    case 2:
                        // Update purse using the Communication module. Then, update the VI's purse
                        _a.sent();
                        // Load all the game's assets!
                        return [4 /*yield*/, new Promise(function (resolve) {
                                _this._loadAssets(function () {
                                    resolve();
                                    // Must call done there or the loading screen won't work.
                                    // Load process is unreliable.
                                    if (done) {
                                        done();
                                    }
                                }, function () {
                                    // Once assets loaded, start Visual Identity introduction
                                    _this.lockScreenEnabled = true;
                                    // Show the Visual Identity introduction once game's assets are loaded
                                    // Once animation finished, start the game!
                                    _this.vi.showIntroduction(function () { return __awaiter(_this, void 0, void 0, function () {
                                        return __generator(this, function (_a) {
                                            switch (_a.label) {
                                                case 0:
                                                    // Show the ingame view of the Visual Identity first.
                                                    this.vi.showInGame();
                                                    // Be sure game is resized to ensure transformations of the inGameView
                                                    // of the Visual Identity. It is not deconnant.
                                                    this.resize(innerWidth, innerHeight);
                                                    // Finally start the game
                                                    return [4 /*yield*/, _super.prototype.start.call(this, state)];
                                                case 1:
                                                    // Finally start the game
                                                    _a.sent();
                                                    this.verifySymbolSpriteSignatures();
                                                    // Notify ready and show in-game Visual Identity
                                                    this.vi.emit(_adaptativeVisualIdentity__WEBPACK_IMPORTED_MODULE_6__["EVisualIdentityAction"].SetGameReady);
                                                    return [2 /*return*/];
                                            }
                                        });
                                    }); });
                                    // Resize the back buffer and check
                                    // if we are in the right orientation
                                    // To perform this action, just force resize
                                    _this.resize(innerWidth, innerHeight, true);
                                });
                            })];
                    case 3:
                        // Load all the game's assets!
                        _a.sent();
                        // TODO[epic=jackpot] JACKPOT_CONFIGURE send lotteryGameName from locale
                        this.com.bridge.emitEvent("JACKPOT_CONFIGURE", {
                            lotteryGameName: i18next__WEBPACK_IMPORTED_MODULE_4___default.a.t("gameName", { returnEmptyString: true }),
                        });
                        return [2 /*return*/];
                }
            });
        });
    };
    AbstractGame.prototype.verifySymbolSpriteSignatures = function () {
        var e_2, _a;
        var _b;
        var authorizedSignatures = (_b = this.gameConfig.symbolSprites) !== null && _b !== void 0 ? _b : [];
        var wrongSignatures = authorizedSignatures.filter(function (s) { return s.length !== 7 && s.length !== 64; });
        if (wrongSignatures.length > 0) {
            this.displayErrorPopin(this.com.t("no-network", "error"));
            throw new _gdk_core_pixi__WEBPACK_IMPORTED_MODULE_1__["SymbolSpriteError"]("Incorrect signatures: \"".concat(wrongSignatures.join(", "), "\": signatures must be 7 or 64 characters long"));
        }
        var symbolSpriteInstances = _gdk_core_pixi__WEBPACK_IMPORTED_MODULE_1__["SymbolSprite"].instances;
        var currentSignatures = symbolSpriteInstances.map(function (symbolSprite) { return symbolSprite.signature; });
        var unauthorizedSignatures = new Set(currentSignatures.filter(function (signature) {
            var e_3, _a;
            try {
                for (var authorizedSignatures_1 = __values(authorizedSignatures), authorizedSignatures_1_1 = authorizedSignatures_1.next(); !authorizedSignatures_1_1.done; authorizedSignatures_1_1 = authorizedSignatures_1.next()) {
                    var authorizedSignature = authorizedSignatures_1_1.value;
                    var signatureToCompare = authorizedSignature.length === 7 ? signature.slice(0, 7) : signature;
                    if (authorizedSignature === signatureToCompare) {
                        return false;
                    }
                }
            }
            catch (e_3_1) { e_3 = { error: e_3_1 }; }
            finally {
                try {
                    if (authorizedSignatures_1_1 && !authorizedSignatures_1_1.done && (_a = authorizedSignatures_1.return)) _a.call(authorizedSignatures_1);
                }
                finally { if (e_3) throw e_3.error; }
            }
            return true;
        }));
        if (unauthorizedSignatures.size > 0) {
            this.displayErrorPopin(this.com.t("no-network", "error"));
            throw new _gdk_core_pixi__WEBPACK_IMPORTED_MODULE_1__["SymbolSpriteError"]("Found symbolSprite signatures that were not specified in config.symbolSprites: \"".concat(__spreadArray([], __read(unauthorizedSignatures), false).join(", "), "\""));
        }
        var currentSignaturesToCompare = __spreadArray([], __read(new Set(__spreadArray(__spreadArray([], __read(currentSignatures), false), __read(currentSignatures.map(function (s) { return s.slice(0, 7); })), false))), false);
        var signaturesNotUsed = new Set(authorizedSignatures.filter(function (signature) {
            return !currentSignaturesToCompare.includes(signature);
        }));
        if (signaturesNotUsed.size > 0) {
            this.displayErrorPopin(this.com.t("no-network", "error"));
            throw new _gdk_core_pixi__WEBPACK_IMPORTED_MODULE_1__["SymbolSpriteError"]("Signatures \"".concat(__spreadArray([], __read(signaturesNotUsed), false).join(", "), "\" were specified in config.symbolSprites but not used by any symbolSprite in the project"));
        }
        try {
            for (var symbolSpriteInstances_1 = __values(symbolSpriteInstances), symbolSpriteInstances_1_1 = symbolSpriteInstances_1.next(); !symbolSpriteInstances_1_1.done; symbolSpriteInstances_1_1 = symbolSpriteInstances_1.next()) {
                var symbolSprite = symbolSpriteInstances_1_1.value;
                symbolSprite.seal();
            }
        }
        catch (e_2_1) { e_2 = { error: e_2_1 }; }
        finally {
            try {
                if (symbolSpriteInstances_1_1 && !symbolSpriteInstances_1_1.done && (_a = symbolSpriteInstances_1.return)) _a.call(symbolSpriteInstances_1);
            }
            finally { if (e_2) throw e_2.error; }
        }
    };
    AbstractGame.prototype.displayErrorPopin = function (text) {
        this.com.messageManager
            .display({
            code: undefined,
            type: _com__WEBPACK_IMPORTED_MODULE_7__["EMessageType"].Immediate,
            popup: {
                level: _com__WEBPACK_IMPORTED_MODULE_7__["EPopinLevel"].Error,
                text: text,
                closable: false,
                buttons: [
                    {
                        label: this.com.t("close", "ui"),
                        action: _com__WEBPACK_IMPORTED_MODULE_7__["PopinButtonAction"].CloseGame,
                    },
                ],
            },
        })
            .finally();
    };
    AbstractGame.prototype._startVI = function () {
        var _a, _b;
        return __awaiter(this, void 0, void 0, function () {
            var baseUrl, viFolder;
            return __generator(this, function (_c) {
                switch (_c.label) {
                    case 0:
                        baseUrl = this.gameConfig.frameworkPath;
                        viFolder = _gdk_core__WEBPACK_IMPORTED_MODULE_0__["Tools"].getFolder(this.gameConfig.modules.paths["@gdk/gamekit"]);
                        this.vi.loader.baseUrl = "".concat(baseUrl).concat(viFolder, "/../assets/visualidentity/");
                        // Init the Visual Identity module. This will load all the required
                        // assets and create the required views
                        return [4 /*yield*/, this.vi.init()];
                    case 1:
                        // Init the Visual Identity module. This will load all the required
                        // assets and create the required views
                        _c.sent();
                        // Setup illiko introduction. To skip introduction, just set skipIntro to true
                        this.vi.introductionView.skipIntro =
                            (_a = this.gameConfig.behavioursParameters[this.gameConfig.selectedBehaviour].viParameters
                                .skipIntroduction) !== null && _a !== void 0 ? _a : false;
                        // Once done, settings are enabled by default. This must be done once the VI
                        // has been initialized. Also, by default, the rules are disabled until the game
                        // enters in the "home" view
                        this.vi.emitter.emit(_adaptativeVisualIdentity__WEBPACK_IMPORTED_MODULE_6__["EVisualIdentityAction"].SettingsEnabled, true);
                        this.vi.emitter.emit(_adaptativeVisualIdentity__WEBPACK_IMPORTED_MODULE_6__["EVisualIdentityAction"].RulesEnabled, false);
                        this.vi.emitter.emit(_adaptativeVisualIdentity__WEBPACK_IMPORTED_MODULE_6__["EVisualIdentityAction"].SoundEnabled, (_b = this.gameConfig.gameParameters.soundEnabled) !== null && _b !== void 0 ? _b : true);
                        // Just show the loading view (spinner + percentage)
                        this.vi.showLoadingView();
                        return [2 /*return*/];
                }
            });
        });
    };
    /**
     * Mute / demute all sounds in game. If sound state was already in the right state,
     * does nothing. If asked to unmute (muted == false) and sound was deactivated
     * from settings (this.vi.soundEnabled == false), does nothing (excepted if force == true).
     * If sound is actually changed, returns true, notifies com, and emit event
     * EVisualIdentityEvent.SoundStatusChanged
     *
     * @param value desired mute state
     * @param force: boolean: if true, force vi sound state to synchronized with given state
     * @return boolean: true is sound status changed
     */
    AbstractGame.prototype.mute = function (muted, force) {
        if (force === void 0) { force = false; }
        if (this.muted === muted) {
            return false;
        }
        else if (force) {
            this._muted = muted;
            this.vi.soundEnabled = true;
        }
        var changed = this.tryToMute(muted);
        if (changed) {
            this._muted = muted;
            this.com.sendSoundStatus(!muted);
            this.vi.emitter.emit(_adaptativeVisualIdentity__WEBPACK_IMPORTED_MODULE_6__["EVisualIdentityEvent"].SoundStatusChanged);
        }
    };
    /**
     * Tries to disable/enable the sound in the applet. If the applet is already forced to be
     * muted, then nothing changes.
     * @param disabled defines wether or not the sound should be disabled.
     * @returns boolean: true if sound status was changed, false otherwise
     */
    AbstractGame.prototype.tryToMute = function (muted) {
        var e_4, _a;
        // QUICKFIX: prevent stacking of sounds by howler,
        // erasing sound resume handlers filters sounds started when audio context was disabled
        // not really elegant since it could break things based on sound resume handlers
        if (!muted) {
            var canceledSounds = [];
            try {
                for (var _b = __values(howler__WEBPACK_IMPORTED_MODULE_3__["Howler"]._howls), _c = _b.next(); !_c.done; _c = _b.next()) {
                    var howl = _c.value;
                    if (!howl._loop) {
                        var l = howl._onresume.length;
                        howl._onresume = howl._onresume.filter(function (_a) {
                            var fn = _a.fn;
                            return fn.name !== "playWebAudio";
                        });
                        if (howl._onresume.length < l) {
                            canceledSounds.push(howl._src);
                        }
                    }
                }
            }
            catch (e_4_1) { e_4 = { error: e_4_1 }; }
            finally {
                try {
                    if (_c && !_c.done && (_a = _b.return)) _a.call(_b);
                }
                finally { if (e_4) throw e_4.error; }
            }
            if (canceledSounds.length > 0) {
                var canceledSoundNames = canceledSounds.map(function (s) { return s.substr(s.lastIndexOf("/") + 1); });
                console.debug("Sound actived: resume of these sounds was canceled" +
                    " since they are not looping: ".concat(canceledSoundNames.join(", ")));
            }
        }
        if (!muted && !this.vi.soundEnabled) {
            return false;
        }
        howler__WEBPACK_IMPORTED_MODULE_3__["Howler"].mute(muted);
        this.events.emit(_gameEvents__WEBPACK_IMPORTED_MODULE_8__["EGameEvents"].GameMuted, muted);
        return true;
    };
    /**
     * Puts an interactive overlay over the game so all interaction are catched
     */
    AbstractGame.prototype.showInteractivityOverlay = function () {
        this.stage.addChild(this._disableInteractivityOverlay);
        gsap__WEBPACK_IMPORTED_MODULE_2__["TweenMax"].fromTo(this._disableInteractivityOverlay, 0.15, { alpha: 0 }, { alpha: 1, ease: gsap__WEBPACK_IMPORTED_MODULE_2__["Power1"].easeInOut });
    };
    /**
     * Removes the interactive overlay
     */
    AbstractGame.prototype.removeInteractivityOverlay = function () {
        var _this = this;
        gsap__WEBPACK_IMPORTED_MODULE_2__["TweenMax"].fromTo(this._disableInteractivityOverlay, 0.15, { alpha: 1 }, {
            alpha: 0,
            ease: gsap__WEBPACK_IMPORTED_MODULE_2__["Power1"].easeInOut,
            onComplete: function () {
                _this.stage.removeChild(_this._disableInteractivityOverlay);
            },
        });
    };
    Object.defineProperty(AbstractGame.prototype, "muted", {
        /**
         * will return current game sounds state (muted or not)
         * @return true if the sound is muted.
         */
        get: function () {
            return howler__WEBPACK_IMPORTED_MODULE_3__["Howler"].state !== "running" || this._muted;
        },
        enumerable: false,
        configurable: true
    });
    /**
     * Returns the path of the assets folder according to the current theme in GameConf.
     */
    AbstractGame.prototype.getThemePath = function () {
        var themeKey = this.gameConfig.selectedTheme;
        var themePath = this.gameConfig.gameDescription.assets.themes[themeKey];
        return "".concat(this.gameConfig.gamePath, "assets/").concat(themePath);
    };
    /**
     * Return the game's infos. Should be overidden to add
     * more informations to log
     */
    AbstractGame.prototype.getInfos = function () {
        return __awaiter(this, void 0, void 0, function () {
            var infos;
            return __generator(this, function (_a) {
                switch (_a.label) {
                    case 0: return [4 /*yield*/, _super.prototype.getInfos.call(this)];
                    case 1:
                        infos = _a.sent();
                        infos.envInfos.bridge = this.com.bridge.version;
                        infos.envInfos.renderMode = this.isCanvasRenderer ? "Canvas" : "WebGL";
                        infos.envInfos.renderSize = { width: this.renderer.width, height: this.renderer.height };
                        return [2 /*return*/, infos];
                }
            });
        });
    };
    /**
     * Get open game parameters
     */
    AbstractGame.prototype.getOpenGameParameters = function () {
        return this.com.getOpenGameParameters();
    };
    /**
     * Resolves when done, with the current GameMode
     */
    AbstractGame.prototype.getGameMode = function () {
        return this.com.getGameMode();
    };
    /**
     * Loads the game assets
     * @param startCallback callback when starting the game once assets loaded
     * @param done callback when everything has been loaded and created
     */
    AbstractGame.prototype._loadAssets = function (startCallback, done) {
        return __awaiter(this, void 0, void 0, function () {
            var expFolder;
            var _this = this;
            return __generator(this, function (_a) {
                // Track game is loaded
                _gdk_core__WEBPACK_IMPORTED_MODULE_0__["tracker"].track(new _gdk_core__WEBPACK_IMPORTED_MODULE_0__["GameLoaded"]({
                    technicalName: this.gameConfig.lotteryGameCode,
                    gameType: this.gameConfig.engine,
                    locale: this.gameConfig.selectedLocale,
                    currency: this.gameConfig.stakes[0].currency,
                    theme: this.gameConfig.selectedTheme,
                }));
                this.loader.onError = function (file) {
                    _gdk_core__WEBPACK_IMPORTED_MODULE_0__["tracker"].track(new _gdk_core__WEBPACK_IMPORTED_MODULE_0__["ErrorEvent"]("Failed to load ".concat(file)));
                };
                // Now, just configure the loader of the game to have an empty
                // base URL
                this.loader.baseUrl = "";
                expFolder = this.gameConfig.frameworkPath +
                    _gdk_core__WEBPACK_IMPORTED_MODULE_0__["Tools"].getFolder(this.gameConfig.modules.paths["@gdk/gamekit"]);
                this.loader.add("".concat(expFolder, "/../assets/game/").concat(this.settings.language, ".json"), "game-i18n");
                // Set the assets path of the game (game path + "assets/") and
                // call the main loader to load from the current Game Config File (game.conf.json)
                this.loader.assetsPath = "".concat(this.gameConfig.gamePath, "assets/");
                this.loader.loadFrom(this.gameConfig, function () {
                    // Merge game locales into the current ones
                    i18next__WEBPACK_IMPORTED_MODULE_4___default.a.addResourceBundle(_this.settings.language, "game", _this.loader.get("game-i18n"), true, false);
                    // Callback the user in order to add his/her own background(s)
                    // view(s) etc.
                    if (startCallback.length === 0) {
                        startCallback();
                    }
                    return done();
                });
                return [2 /*return*/];
            });
        });
    };
    AbstractGame.prototype._createOverlay = function () {
        // When updating the session becuase the browser was hidden, draw an overlay
        this._disableInteractivityOverlay = new pixi_js__WEBPACK_IMPORTED_MODULE_5__["Graphics"]();
        this._disableInteractivityOverlay.beginFill(0x0, 0.6);
        this._disableInteractivityOverlay.drawRect(0, 0, 1, 1);
        this._disableInteractivityOverlay.resize = new _gdk_core_pixi__WEBPACK_IMPORTED_MODULE_1__["Resize"](_gdk_core_pixi__WEBPACK_IMPORTED_MODULE_1__["Resize"].cover);
        this._disableInteractivityOverlay.interactive = true;
    };
    return AbstractGame;
}(_gdk_core_pixi__WEBPACK_IMPORTED_MODULE_1__["GamePixi"]));



/***/ }),

/***/ "./src/game/action/action.ts":
/*!***********************************!*\
  !*** ./src/game/action/action.ts ***!
  \***********************************/
/*! exports provided: Action */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Action", function() { return Action; });
/* harmony import */ var i18next__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! i18next */ "i18next");
/* harmony import */ var i18next__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(i18next__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var _com__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../com */ "./src/com/index.ts");
/* harmony import */ var _abstractGame__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../abstractGame */ "./src/game/abstractGame.ts");
var __extends = (undefined && undefined.__extends) || (function () {
    var extendStatics = function (d, b) {
        extendStatics = Object.setPrototypeOf ||
            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||
            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };
        return extendStatics(d, b);
    };
    return function (d, b) {
        if (typeof b !== "function" && b !== null)
            throw new TypeError("Class extends value " + String(b) + " is not a constructor or null");
        extendStatics(d, b);
        function __() { this.constructor = d; }
        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
    };
})();
var __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};
var __generator = (undefined && undefined.__generator) || function (thisArg, body) {
    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;
    return g = { next: verb(0), "throw": verb(1), "return": verb(2) }, typeof Symbol === "function" && (g[Symbol.iterator] = function() { return this; }), g;
    function verb(n) { return function (v) { return step([n, v]); }; }
    function step(op) {
        if (f) throw new TypeError("Generator is already executing.");
        while (g && (g = 0, op[0] && (_ = 0)), _) try {
            if (f = 1, y && (t = op[0] & 2 ? y["return"] : op[0] ? y["throw"] || ((t = y["return"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;
            if (y = 0, t) op = [op[0] & 2, t.value];
            switch (op[0]) {
                case 0: case 1: t = op; break;
                case 4: _.label++; return { value: op[1], done: false };
                case 5: _.label++; y = op[1]; op = [0]; continue;
                case 7: op = _.ops.pop(); _.trys.pop(); continue;
                default:
                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }
                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }
                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }
                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }
                    if (t[2]) _.ops.pop();
                    _.trys.pop(); continue;
            }
            op = body.call(thisArg, _);
        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }
        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };
    }
};



/**
 * Action game.
 * @template TModel Model typings.
 * @template TGameData Session typings.
 * @template TEventResponse "evr" typings.
 * @template TEventParameters Event parameters.
 * @template TMotorsSession override session typings.
 */
var Action = /** @class */ (function (_super) {
    __extends(Action, _super);
    /**
     * Constructor
     * @param gameConfig: the game configuration (game.conf.json)
     * @param width: the canvas width
     * @param height: the canvas height
     * @param noWebGL: enable/disable WebGL (to force Canvas)
     * @param options: the Pixi.js applicaiton options
     */
    function Action(gameConfig, width, height, noWebGL, options) {
        var _this = 
        // Initialize
        _super.call(this, gameConfig, width, height, noWebGL, options) || this;
        _this.selectedStake =
            gameConfig.stakes[gameConfig.defaultStakeIndex ? gameConfig.defaultStakeIndex : 0];
        return _this;
    }
    /**
     * Returns the Motors model of the given service name (optional, default is taken from game config).
     * @param parameters: the request parameters (applicationId and service name)
     */
    Action.prototype.getModel = function (parameters, demoMode) {
        if (parameters === void 0) { parameters = {}; }
        return __awaiter(this, void 0, void 0, function () {
            return __generator(this, function (_a) {
                switch (_a.label) {
                    case 0: return [4 /*yield*/, this.com.getModel(parameters, demoMode)];
                    case 1: return [2 /*return*/, _a.sent()];
                }
            });
        });
    };
    /**
     * Returns the Presto ticket information for the current player (token dependant).
     */
    Action.prototype.getPrsTicketInfos = function () {
        return __awaiter(this, void 0, void 0, function () {
            return __generator(this, function (_a) {
                switch (_a.label) {
                    case 0: return [4 /*yield*/, this.com.getPrsTicketInfos()];
                    case 1: return [2 /*return*/, _a.sent()];
                }
            });
        });
    };
    /**
     * Returns the Motors available sessions
     * @param parameters: the request parameters (applicationId and service name)
     */
    Action.prototype.getSession = function (parameters, demoMode) {
        if (parameters === void 0) { parameters = {}; }
        if (demoMode === void 0) { demoMode = false; }
        return this.com.getMtrSession(parameters, undefined, demoMode);
    };
    /**
     * Looks for session from bet it.
     * Returns a IMtrReplaySession if existing or undefined otherwise.
     * @param parameters
     */
    Action.prototype.getSessionFromBetId = function (parameters) {
        if (parameters === void 0) { parameters = {}; }
        return this.com.getMtrSessionToReplay(parameters);
    };
    /**
     * Starts a Motors session (bet)
     * @param parameters: the start session parameters
     */
    Action.prototype.bet = function (parameters) {
        return __awaiter(this, void 0, void 0, function () {
            var bet;
            return __generator(this, function (_a) {
                switch (_a.label) {
                    case 0: return [4 /*yield*/, this.com.createMtrBet(parameters)];
                    case 1:
                        bet = _a.sent();
                        if (bet.message) {
                            this.com.messageManager.push(bet.message);
                        }
                        // Update purse
                        return [4 /*yield*/, this.getPurse(true)];
                    case 2:
                        // Update purse
                        _a.sent();
                        return [2 /*return*/, bet];
                }
            });
        });
    };
    /**
     * Has to be called before buying a ticket in real money
     * @returns promise
     * The lottery must resolve whenever it wants the player to continuer with his bet
     * The lottery must reject if ever it wants to cancel the player's bet process
     */
    Action.prototype.preBet = function (betRequest) {
        return __awaiter(this, void 0, void 0, function () {
            return __generator(this, function (_a) {
                return [2 /*return*/, this.com.preBet(betRequest)];
            });
        });
    };
    /**
     * Shows the continue game popup
     * @param done callback once the user closes the popup
     */
    Action.prototype.showResumeGamePopup = function () {
        return __awaiter(this, void 0, void 0, function () {
            return __generator(this, function (_a) {
                switch (_a.label) {
                    case 0: return [4 /*yield*/, this.com.messageManager.display({
                            code: "MTR.RESUME",
                            type: _com__WEBPACK_IMPORTED_MODULE_1__["EMessageType"].Immediate,
                            popup: {
                                level: _com__WEBPACK_IMPORTED_MODULE_1__["EPopinLevel"].Info,
                                text: i18next__WEBPACK_IMPORTED_MODULE_0___default.a.t("motors.resume.text"),
                                buttons: [
                                    {
                                        label: i18next__WEBPACK_IMPORTED_MODULE_0___default.a.t("motors.resume.button"),
                                        action: _com__WEBPACK_IMPORTED_MODULE_1__["PopinButtonAction"].ClosePopin,
                                    },
                                ],
                            },
                        })];
                    case 1:
                        _a.sent();
                        return [2 /*return*/];
                }
            });
        });
    };
    /**
     * Execute get context
     * @param parameters
     * @todo support gamif :)
     */
    Action.prototype.getContext = function (parameters) {
        return __awaiter(this, void 0, void 0, function () {
            var serviceName, context;
            return __generator(this, function (_a) {
                switch (_a.label) {
                    case 0:
                        serviceName = parameters.serviceName || this.gameConfig.lotteryGameCode;
                        return [4 /*yield*/, this.com.getContext(serviceName)];
                    case 1:
                        context = _a.sent();
                        return [2 /*return*/, context];
                }
            });
        });
    };
    return Action;
}(_abstractGame__WEBPACK_IMPORTED_MODULE_2__["AbstractGame"]));



/***/ }),

/***/ "./src/game/action/model.ts":
/*!**********************************!*\
  !*** ./src/game/action/model.ts ***!
  \**********************************/
/*! exports provided: MotorsModel */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "MotorsModel", function() { return MotorsModel; });
var MotorsModel = /** @class */ (function () {
    /**
     * Constructor
     * @param response: the response of the motors model request
     */
    function MotorsModel(response) {
        this.gameModelId = response.data.gmid;
        this.gameName = response.data.gmn;
        this.data = response.data.mdl;
    }
    return MotorsModel;
}());



/***/ }),

/***/ "./src/game/action/session.ts":
/*!************************************!*\
  !*** ./src/game/action/session.ts ***!
  \************************************/
/*! exports provided: ESessionMode, MotorsSession */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ESessionMode", function() { return ESessionMode; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "MotorsSession", function() { return MotorsSession; });
/* harmony import */ var _falcon_bridge__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @falcon/bridge */ "@falcon/bridge");
/* harmony import */ var _falcon_bridge__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_falcon_bridge__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var _com__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../com */ "./src/com/index.ts");
var __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};
var __generator = (undefined && undefined.__generator) || function (thisArg, body) {
    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;
    return g = { next: verb(0), "throw": verb(1), "return": verb(2) }, typeof Symbol === "function" && (g[Symbol.iterator] = function() { return this; }), g;
    function verb(n) { return function (v) { return step([n, v]); }; }
    function step(op) {
        if (f) throw new TypeError("Generator is already executing.");
        while (g && (g = 0, op[0] && (_ = 0)), _) try {
            if (f = 1, y && (t = op[0] & 2 ? y["return"] : op[0] ? y["throw"] || ((t = y["return"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;
            if (y = 0, t) op = [op[0] & 2, t.value];
            switch (op[0]) {
                case 0: case 1: t = op; break;
                case 4: _.label++; return { value: op[1], done: false };
                case 5: _.label++; y = op[1]; op = [0]; continue;
                case 7: op = _.ops.pop(); _.trys.pop(); continue;
                default:
                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }
                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }
                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }
                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }
                    if (t[2]) _.ops.pop();
                    _.trys.pop(); continue;
            }
            op = body.call(thisArg, _);
        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }
        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };
    }
};


var ESessionMode;
(function (ESessionMode) {
    ESessionMode["Default"] = "default";
    ESessionMode["Resume"] = "resume";
    ESessionMode["Replay"] = "replay";
})(ESessionMode || (ESessionMode = {}));
/**
 * Motors Session.
 * @template TGameData Session typings.
 * @template TEventParameters "prm" typings.
 * @template TEventResponse "evr" typings.
 * @template TModel model definition.
 */
var MotorsSession = /** @class */ (function () {
    /**
     * Constructor.
     * @param payload mtrSession or mtrBetResult
     */
    function MotorsSession(game, payload) {
        /**
         * Session id.
         */
        this.id = undefined;
        /**
         * Current session state.
         */
        this.state = undefined;
        /**
         * Session game data. Must be used ONLY for resuming game.
         * It will be undefined in replay mode.
         */
        this.sessionData = undefined;
        /**
         * Bet amount.
         */
        this.betAmount = undefined;
        /**
         * Won amount, defined only when the game is done or in replay mode.
         */
        this.wonAmount = undefined;
        /**
         * Last bet/updatebet EVR.
         */
        this.lastResponse = undefined;
        /**
         * Mtr session mode.
         */
        this.mode = undefined;
        this._game = game;
        if ("res" in payload.data) {
            this._initFromBetRespone(payload);
        }
        else if ("gmd" in payload.data) {
            this._initFromSession(payload);
        }
        else {
            this._initFromReplaySession(payload);
        }
    }
    /**
     * Executes a Motors action and update the session with the response.
     * @param event name of the event to trigger.
     * @param parameters parameters for the event.
     */
    MotorsSession.prototype.updateBet = function (event, parameters) {
        return __awaiter(this, void 0, void 0, function () {
            var response;
            return __generator(this, function (_a) {
                switch (_a.label) {
                    case 0:
                        if (this.mode === ESessionMode.Replay && this.hasReplaySteps()) {
                            this._updateFromBetResponse(this._getReplayStepAsBetResult());
                            return [2 /*return*/];
                        }
                        return [4 /*yield*/, this._game.com.updateMtrBet({
                                serviceName: this.serviceName,
                                applicationId: this.applicationId,
                                parameters: {
                                    prm: parameters,
                                    evn: event,
                                    sid: this.id,
                                },
                                demo: this.demo,
                            })];
                    case 1:
                        response = _a.sent();
                        if (response.message) {
                            this._game.com.messageManager.push(response.message);
                        }
                        this._updateFromBetResponse(response);
                        return [2 /*return*/];
                }
            });
        });
    };
    /**
     * Check if session has replay steps.
     */
    MotorsSession.prototype.hasReplaySteps = function () {
        return this._steps !== undefined;
    };
    /**
     * Usable on replay mode.
     * Returns next replay step as a betResult.
     */
    MotorsSession.prototype._getReplayStepAsBetResult = function () {
        if (!this._steps || !this._steps.length) {
            throw new Error("No steps in the session.");
        }
        var step = this._steps.shift();
        var result = {
            applicationId: this.applicationId,
            serviceName: this.serviceName,
            betAmount: this.betAmount,
            wonAmount: this.wonAmount,
            receiptId: "",
            platformBetId: "",
            serverMessage: [],
            data: {
                res: "ok",
                data: {
                    evr: step.res,
                    st: step.st,
                    gmid: this.gmid,
                    id: this.id,
                },
            },
            demo: false, // no replay for demo
        };
        if (!this._steps.length) {
            this._steps = undefined;
        }
        return result;
    };
    /**
     * Usable on replay mode.
     * Reurns initial action parameters.
     */
    MotorsSession.prototype.getInitialReplayParameters = function () {
        if (!this._initialStepParameters) {
            throw new Error("No steps in the session.");
        }
        return this._initialStepParameters;
    };
    /**
     * Usable on replay mode.
     * Returns next action parameters.
     */
    MotorsSession.prototype.getNextReplayStepParameters = function () {
        if (!this._steps) {
            this._game.com.messageManager.display({
                code: "MTR.REPLAY.RESOLVED",
                type: _com__WEBPACK_IMPORTED_MODULE_1__["EMessageType"].Immediate,
                popup: {
                    level: _com__WEBPACK_IMPORTED_MODULE_1__["EPopinLevel"].Error,
                    text: this._game.com.t("motors-replay-unfinished", "error"),
                    buttons: [
                        {
                            label: this._game.com.t("close", "ui") || " Close",
                            action: _com__WEBPACK_IMPORTED_MODULE_1__["PopinButtonAction"].CloseGame,
                        },
                    ],
                },
            });
            throw new Error("No steps in the session.");
        }
        return this._steps[0].par;
    };
    /**
     * Update state, last response and eventually wonAmount from BetResult.
     * @param betResult
     */
    MotorsSession.prototype._updateFromBetResponse = function (betResult) {
        this.state = betResult.data.data.st;
        if (betResult.wonAmount) {
            this.wonAmount = betResult.wonAmount;
        }
        this.lastResponse = betResult.data.data.evr;
    };
    /**
     * Init session data from BetResult.
     * @param betResult
     */
    MotorsSession.prototype._initFromBetRespone = function (betResult) {
        this.demo = betResult.demo;
        this.id = betResult.data.data.id;
        this.state = betResult.data.data.st;
        this.betAmount = betResult.betAmount;
        if (betResult.wonAmount) {
            this.wonAmount = betResult.wonAmount;
        }
        this.lastResponse = betResult.data.data.evr;
        this.mode = ESessionMode.Default;
        this.gmid = betResult.data.data.gmid;
        this.applicationId = betResult.applicationId;
        this.serviceName = betResult.serviceName;
    };
    /**
     * Init session data from IMtrSession.
     * This method must be used ONLY for resuming game.
     * @param session
     */
    MotorsSession.prototype._initFromSession = function (session) {
        this._initFromSessionOrReplaySession(session);
        this.state = session.data.st;
        this.sessionData = session.data.gmd;
    };
    /**
     * Init session data from IMtrReplaySession.
     * This method must be used ONLY for replaying or resuming a game.
     * @param session
     */
    MotorsSession.prototype._initFromReplaySession = function (session) {
        this._initFromSessionOrReplaySession(session);
        if (session.data.steps && session.data.steps.length) {
            var steps = session.data.steps.slice(1); // ignore first step (bet)
            if (steps.length) {
                this._steps = steps;
            }
            this._initialStepParameters = session.data.steps[0].par;
            this.lastResponse = session.data.steps[0].res;
            this.wonAmount = session.wonAmount;
        }
    };
    MotorsSession.prototype._initFromSessionOrReplaySession = function (session) {
        this.demo = false; // no demo information on IMtrReplaySession so presume that demo = false
        this.id = session.id;
        this.betAmount = session.betAmount;
        this.mode =
            session.data.state === _falcon_bridge__WEBPACK_IMPORTED_MODULE_0__["EMtrSessionState"].InProgress
                ? ESessionMode.Resume
                : ESessionMode.Replay;
        this.gmid = session.data.gmid;
        this.applicationId = session.applicationId;
        this.serviceName = session.serviceName;
    };
    return MotorsSession;
}());



/***/ }),

/***/ "./src/game/carousel.ts":
/*!******************************!*\
  !*** ./src/game/carousel.ts ***!
  \******************************/
/*! exports provided: Carousel */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Carousel", function() { return Carousel; });
/* harmony import */ var _gdk_core_pixi__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @gdk/core-pixi */ "@gdk/core-pixi");
/* harmony import */ var _gdk_core_pixi__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_gdk_core_pixi__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var _gdk_core__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @gdk/core */ "@gdk/core");
/* harmony import */ var _gdk_core__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(_gdk_core__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var gsap__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! gsap */ "gsap");
/* harmony import */ var gsap__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(gsap__WEBPACK_IMPORTED_MODULE_2__);
/* harmony import */ var pixi_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! pixi.js */ "pixi.js");
/* harmony import */ var pixi_js__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(pixi_js__WEBPACK_IMPORTED_MODULE_3__);
/* harmony import */ var _tweenUtils__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./tweenUtils */ "./src/game/tweenUtils.ts");
var __extends = (undefined && undefined.__extends) || (function () {
    var extendStatics = function (d, b) {
        extendStatics = Object.setPrototypeOf ||
            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||
            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };
        return extendStatics(d, b);
    };
    return function (d, b) {
        if (typeof b !== "function" && b !== null)
            throw new TypeError("Class extends value " + String(b) + " is not a constructor or null");
        extendStatics(d, b);
        function __() { this.constructor = d; }
        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
    };
})();
var __assign = (undefined && undefined.__assign) || function () {
    __assign = Object.assign || function(t) {
        for (var s, i = 1, n = arguments.length; i < n; i++) {
            s = arguments[i];
            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))
                t[p] = s[p];
        }
        return t;
    };
    return __assign.apply(this, arguments);
};
var __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};
var __generator = (undefined && undefined.__generator) || function (thisArg, body) {
    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;
    return g = { next: verb(0), "throw": verb(1), "return": verb(2) }, typeof Symbol === "function" && (g[Symbol.iterator] = function() { return this; }), g;
    function verb(n) { return function (v) { return step([n, v]); }; }
    function step(op) {
        if (f) throw new TypeError("Generator is already executing.");
        while (g && (g = 0, op[0] && (_ = 0)), _) try {
            if (f = 1, y && (t = op[0] & 2 ? y["return"] : op[0] ? y["throw"] || ((t = y["return"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;
            if (y = 0, t) op = [op[0] & 2, t.value];
            switch (op[0]) {
                case 0: case 1: t = op; break;
                case 4: _.label++; return { value: op[1], done: false };
                case 5: _.label++; y = op[1]; op = [0]; continue;
                case 7: op = _.ops.pop(); _.trys.pop(); continue;
                default:
                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }
                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }
                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }
                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }
                    if (t[2]) _.ops.pop();
                    _.trys.pop(); continue;
            }
            op = body.call(thisArg, _);
        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }
        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };
    }
};
var __values = (undefined && undefined.__values) || function(o) {
    var s = typeof Symbol === "function" && Symbol.iterator, m = s && o[s], i = 0;
    if (m) return m.call(o);
    if (o && typeof o.length === "number") return {
        next: function () {
            if (o && i >= o.length) o = void 0;
            return { value: o && o[i++], done: !o };
        }
    };
    throw new TypeError(s ? "Object is not iterable." : "Symbol.iterator is not defined.");
};
var __read = (undefined && undefined.__read) || function (o, n) {
    var m = typeof Symbol === "function" && o[Symbol.iterator];
    if (!m) return o;
    var i = m.call(o), r, ar = [], e;
    try {
        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);
    }
    catch (error) { e = { error: error }; }
    finally {
        try {
            if (r && !r.done && (m = i["return"])) m.call(i);
        }
        finally { if (e) throw e.error; }
    }
    return ar;
};
var __spreadArray = (undefined && undefined.__spreadArray) || function (to, from, pack) {
    if (pack || arguments.length === 2) for (var i = 0, l = from.length, ar; i < l; i++) {
        if (ar || !(i in from)) {
            if (!ar) ar = Array.prototype.slice.call(from, 0, i);
            ar[i] = from[i];
        }
    }
    return to.concat(ar || Array.prototype.slice.call(from));
};





var defaultCarouselSettings = {
    offset: 0,
    maxDragTime: 400,
    dragSensibility: 10,
    animationDuration: 0.5,
    scales: [1, 0.75, 0.6, 0.5],
    fixedDocking: [new pixi_js__WEBPACK_IMPORTED_MODULE_3__["Point"](0, 0), new pixi_js__WEBPACK_IMPORTED_MODULE_3__["Point"](176, 128), new pixi_js__WEBPACK_IMPORTED_MODULE_3__["Point"](300, 226), new pixi_js__WEBPACK_IMPORTED_MODULE_3__["Point"](500, 324)],
    fixedDocking2Cards: [new pixi_js__WEBPACK_IMPORTED_MODULE_3__["Point"](232, 232), new pixi_js__WEBPACK_IMPORTED_MODULE_3__["Point"](-232, -232)],
};
var Carousel = /** @class */ (function (_super) {
    __extends(Carousel, _super);
    /* LIFECYCLE */
    /**
     * @constructor
     * @param cards: List of cards containers
     * @param leftArrow: Button for Left Arrow
     * @param rightArrow: Button for Right Arrow
     */
    function Carousel(data, settings) {
        if (settings === void 0) { settings = {}; }
        var _this = _super.call(this) || this;
        /**
         * The timestamp of the drag start
         */
        _this.dragStartTime = 0;
        /**
         * The mouse position when the drag has started
         */
        _this.dragStartPosition = new pixi_js__WEBPACK_IMPORTED_MODULE_3__["Point"]();
        /**
         * Check if the player is currently dragging the carousel
         */
        _this.isDragging = false;
        /**
         * Check if the carousel is active
         */
        _this.isActive = false;
        _this.game = data.game;
        _this.container = data.container;
        _this.previousArrow = data.previousArrow;
        _this.nextArrow = data.nextArrow;
        // cards ordered by childIndex
        var visibleChildren = data.container.children.filter(function (card) { return card.visible; });
        // cards childIndex, ordered by position from center to right then left to center
        _this.correspondingIndex = [];
        for (var i = 0; i < visibleChildren.length; i++) {
            var value = visibleChildren.length - 1 - i;
            i % 2 === 0 ? _this.correspondingIndex.push(value) : _this.correspondingIndex.unshift(value);
        }
        var splicingNeeded = Math.ceil(visibleChildren.length / 2);
        for (var i = 0; i < splicingNeeded; i++) {
            var temp = _this.correspondingIndex.pop();
            _this.correspondingIndex.splice(0, 0, temp);
        }
        _this.cards = [];
        for (var i = 0; i < visibleChildren.length; i++) {
            _this.cards[i] = visibleChildren[_this.correspondingIndex[i]];
        }
        _this.settings = __assign(__assign(__assign({}, defaultCarouselSettings), { orientation: _this.game.settings.orientation }), settings);
        if (_this.previousArrow) {
            _this.previousArrow.on("pointertap", function () {
                _this.previousCard();
            });
        }
        if (_this.nextArrow) {
            _this.nextArrow.on("pointertap", function () {
                _this.nextCard();
            });
        }
        // Init carousel
        _this.setButtonActive(_this.isCarousel());
        _this.previousActiveCard = _this.cards[0];
        _this.updateCardPositions(false);
        // Init drag
        _this.container.interactive = true;
        _this.container.on("pointerdown", _this.onDragStart.bind(_this));
        _this.container.on("pointerup", _this.onDragStop.bind(_this));
        _this.container.on("pointerupoutside", _this.onDragStop.bind(_this));
        // Init scroll
        if (typeof window !== "undefined") {
            window.addEventListener("wheel", _this.onScroll.bind(_this));
            window.addEventListener("mousewheel", _this.onScroll.bind(_this));
            window.addEventListener("DOMMouseScroll", _this.onScroll.bind(_this));
        }
        return _this;
    }
    /* METHODS */
    /**
     * Get the maximum dimension depending of cards
     */
    Carousel.prototype.getCardDimension = function () {
        var e_1, _a;
        var width = 0;
        var height = 0;
        try {
            for (var _b = __values(this.cards), _c = _b.next(); !_c.done; _c = _b.next()) {
                var card = _c.value;
                width = Math.max(width, card.width * (1 / card.scaleX));
                height = Math.max(height, card.height * (1 / card.scaleY));
            }
        }
        catch (e_1_1) { e_1 = { error: e_1_1 }; }
        finally {
            try {
                if (_c && !_c.done && (_a = _b.return)) _a.call(_b);
            }
            finally { if (e_1) throw e_1.error; }
        }
        return new pixi_js__WEBPACK_IMPORTED_MODULE_3__["Point"](width, height);
    };
    /**
     * Get the offset value between each cards relative to the container dimension
     */
    Carousel.prototype.getCardsOffset = function () {
        var cardDimenion = this.getCardDimension();
        var containerDimension = _gdk_core_pixi__WEBPACK_IMPORTED_MODULE_0__["ContainerUtils"].getContainerDimensions(this.game.renderer, this.container);
        var cardOrientationSize = (this.settings.orientation === _gdk_core__WEBPACK_IMPORTED_MODULE_1__["EOrientation"].Landscape && cardDimenion.x) || cardDimenion.y;
        var containerOrientationSize = (this.settings.orientation === _gdk_core__WEBPACK_IMPORTED_MODULE_1__["EOrientation"].Landscape && containerDimension.x) ||
            containerDimension.y;
        if (this.cards.length === 2) {
            return Math.max(20, (containerOrientationSize - cardOrientationSize * 2) / 2);
        }
        return Math.max(1, (containerOrientationSize - cardOrientationSize) / this.cards.length);
    };
    /**
     * Sort cards with children to prevent card to nlap other
     * @param reverseLastCard: True if you want that the right card will be the first drawed card
     */
    Carousel.prototype.sortCards = function (reverseLastCard) {
        var _this = this;
        if (reverseLastCard === void 0) { reverseLastCard = false; }
        if (this.cards.length <= 2) {
            return;
        }
        var activeCardIndex = this.cards.findIndex(function (card) { return card === _this.activeCard; });
        var nextCards = this.cards
            .slice(activeCardIndex)
            .concat(this.cards.slice(0, activeCardIndex));
        this.cards = nextCards;
        var odds = [];
        var evens = [];
        var separationIndex = Math.round(this.cards.length / 2);
        var computedCards = __spreadArray(__spreadArray([], __read(this.cards.slice(0, separationIndex)), false), __read(this.cards.slice(separationIndex).reverse()), false);
        for (var i = 0; i < computedCards.length; i++) {
            if (i === 0) {
                continue;
            }
            else if (i % 2 === 0) {
                evens.push(computedCards[i]);
            }
            else {
                odds.push(computedCards[i]);
            }
        }
        var orders = __spreadArray(__spreadArray(__spreadArray([], __read(evens), false), __read(odds), false), [computedCards[0]], false);
        if (reverseLastCard) {
            orders.splice.apply(orders, __spreadArray([0, 2], __read(orders.slice(0, 2).reverse()), false));
        }
        orders.forEach(function (card) { return _this.container.addChild(card); });
    };
    /**
     * Convert an array of indices to the full array for each cards (useful to sort cards by peer)
     * @param array: The array to compute
     * @param isNegative: If true, the left part of the array will be negative
     * @returns The computed array
     */
    Carousel.prototype.computeArray = function (ar, isNegative) {
        if (isNegative === void 0) { isNegative = false; }
        var computedArray = ar.slice();
        // shorten the base array size if needed
        var sizeDiff = computedArray.length * 2 - 1 - this.cards.length;
        var nbrValueToDelete = Math.floor(sizeDiff / 2);
        computedArray.splice(computedArray.length - nbrValueToDelete, nbrValueToDelete);
        // make the second part of the array with mirrored values
        var reversedArray = computedArray.slice().reverse();
        reversedArray.pop();
        if (isNegative) {
            reversedArray = reversedArray.map(function (r) { return (r = -r); });
        }
        // even number of card mean the left side is shorter
        if (this.cards.length % 2 === 0) {
            computedArray.pop();
        }
        return computedArray.concat(reversedArray);
    };
    /**
     * Get all card positions based on fixed docking positions
     * @returns
     */
    Carousel.prototype.getCardPositions = function () {
        var _this = this;
        if (this.cards.length <= 2 && Array.isArray(this.settings.fixedDocking2Cards)) {
            return this.settings.fixedDocking2Cards.map(function (point) {
                return _this.settings.orientation === _gdk_core__WEBPACK_IMPORTED_MODULE_1__["EOrientation"].Landscape ? point.x : point.y;
            });
        }
        if (!Array.isArray(this.settings.fixedDocking)) {
            throw new Error("[carousel] fixedDocking must not be an array of Point and not be empty");
        }
        return this.computeArray(this.settings.fixedDocking.map(function (fixedDocking) {
            return _this.settings.orientation === _gdk_core__WEBPACK_IMPORTED_MODULE_1__["EOrientation"].Landscape
                ? fixedDocking.x
                : fixedDocking.y;
        }), true);
    };
    /**
     * When scroll has been detected
     * @param e: The window event
     */
    Carousel.prototype.onScroll = function (e) {
        if (!this.container.visible) {
            return;
        }
        var delta = 0;
        if (!e) {
            e = window.event;
        }
        if (event["wheelDelta"]) {
            // IE/opera
            delta = event["wheelDelta"] / 120;
        }
        else if (event["detail"]) {
            // mozilla
            delta -= event["detail"] / 3;
        }
        if (delta) {
            if (delta > 0) {
                this.nextCard();
            }
            else {
                this.previousCard();
            }
        }
    };
    /**
     * @event
     * When the drag has started
     * @param e: The interaction event
     * @returns
     */
    Carousel.prototype.onDragStart = function (e) {
        this.isDragging = true;
        this.dragStartTime = Date.now();
        this.dragStartPosition = new pixi_js__WEBPACK_IMPORTED_MODULE_3__["Point"](e.data.global.x, e.data.global.y);
    };
    /**
     * @event
     * When drag has stopped
     * @param e: The interaction event
     * @returns
     */
    Carousel.prototype.onDragStop = function (e) {
        if (!this.isDragging) {
            return;
        }
        var point = new pixi_js__WEBPACK_IMPORTED_MODULE_3__["Point"](e.data.global.x, e.data.global.y);
        var diff = new pixi_js__WEBPACK_IMPORTED_MODULE_3__["Point"](point.x - this.dragStartPosition.x, point.y - this.dragStartPosition.y);
        if (this.settings.orientation === _gdk_core__WEBPACK_IMPORTED_MODULE_1__["EOrientation"].Landscape &&
            Math.abs(diff.x) >= this.settings.dragSensibility) {
            if (point.x > this.dragStartPosition.x) {
                this.previousCard();
            }
            else {
                this.nextCard();
            }
        }
        else if (this.settings.orientation === _gdk_core__WEBPACK_IMPORTED_MODULE_1__["EOrientation"].Portrait &&
            Math.abs(diff.y) >= this.settings.dragSensibility) {
            if (point.y > this.dragStartPosition.y) {
                this.previousCard();
            }
            else {
                this.nextCard();
            }
        }
        this.isDragging = false;
    };
    /**
     * Update positions of arrows relative to the screen and orientation
     */
    Carousel.prototype.updateArrowsPositions = function () {
        var isLandscape = this.settings.orientation === _gdk_core__WEBPACK_IMPORTED_MODULE_1__["EOrientation"].Landscape;
        var rotation = (isLandscape ? 0 : 90) * (Math.PI / 180);
        if (this.previousArrow) {
            this.previousArrow.rotation = rotation;
            this.previousArrow.docking = isLandscape
                ? new _gdk_core_pixi__WEBPACK_IMPORTED_MODULE_0__["Docking"](_gdk_core_pixi__WEBPACK_IMPORTED_MODULE_0__["Docking"].bottomLeft, 0, -40)
                : new _gdk_core_pixi__WEBPACK_IMPORTED_MODULE_0__["Docking"](_gdk_core_pixi__WEBPACK_IMPORTED_MODULE_0__["Docking"].bottomRight, 0, -102);
        }
        if (this.nextArrow) {
            this.nextArrow.rotation = rotation;
            this.nextArrow.docking = isLandscape
                ? new _gdk_core_pixi__WEBPACK_IMPORTED_MODULE_0__["Docking"](_gdk_core_pixi__WEBPACK_IMPORTED_MODULE_0__["Docking"].bottomRight, 0, -40)
                : new _gdk_core_pixi__WEBPACK_IMPORTED_MODULE_0__["Docking"](_gdk_core_pixi__WEBPACK_IMPORTED_MODULE_0__["Docking"].bottomRight, 0, -40);
        }
    };
    /* PUBLIC */
    /**
     * Set a new card as active
     * @param nextCard: The next card to active
     * @param disableAnimation: True if animation should be disabled
     */
    Carousel.prototype.setActiveCard = function (nextCard, disableAnimation) {
        if (disableAnimation === void 0) { disableAnimation = false; }
        return __awaiter(this, void 0, void 0, function () {
            var index, i, temp, isReverseRotation;
            return __generator(this, function (_a) {
                switch (_a.label) {
                    case 0:
                        if (!this.cards.find(function (card) { return card === nextCard; }) || this.activeCard === nextCard) {
                            return [2 /*return*/];
                        }
                        this.previousActiveCard = this.cards[0];
                        index = this.cards.findIndex(function (c) { return c === nextCard; });
                        for (i = 0; i < index; i++) {
                            temp = this.cards.shift();
                            this.cards[this.cards.length] = temp;
                        }
                        isReverseRotation = (this.cards.length - index) % 2 === 1;
                        return [4 /*yield*/, this.updateCardPositions(disableAnimation, isReverseRotation)];
                    case 1:
                        _a.sent();
                        return [2 /*return*/];
                }
            });
        });
    };
    /**
     * Update positions of cards
     * @param disableAnimation: If true, cards will be updated without animation
     * @param reverseRotation: True if the default rotation should be reversed for better animation
     */
    Carousel.prototype.updateCardPositions = function (disableAnimation, reverseRotation) {
        if (disableAnimation === void 0) { disableAnimation = false; }
        if (reverseRotation === void 0) { reverseRotation = false; }
        return __awaiter(this, void 0, void 0, function () {
            var timeline, positions, scales, _loop_1, this_1, i, farRightBackCard;
            return __generator(this, function (_a) {
                switch (_a.label) {
                    case 0:
                        timeline = new gsap__WEBPACK_IMPORTED_MODULE_2__["TimelineMax"]();
                        positions = this.getCardPositions();
                        scales = this.cards.length > 2
                            ? this.computeArray(this.settings.scales)
                            : new Array(this.cards.length).fill(0.8);
                        this.activeCard = this.cards[0];
                        this.setButtonActive(false);
                        if (this.container.worldVisible) {
                            this.emit("beforeChangeCard", this.activeCard, this.previousActiveCard);
                        }
                        _loop_1 = function (i) {
                            var card = this_1.cards[i];
                            var scaleXY = scales[i];
                            var dockingX = this_1.settings.orientation === _gdk_core__WEBPACK_IMPORTED_MODULE_1__["EOrientation"].Landscape ? positions[i] : card.docking.x;
                            var dockingY = this_1.settings.orientation === _gdk_core__WEBPACK_IMPORTED_MODULE_1__["EOrientation"].Portrait ? positions[i] : card.docking.y;
                            // reorder cards in the container hierarchy (without animation)
                            this_1.container.addChild(this_1.cards[this_1.correspondingIndex.findIndex(function (c) { return c === i; })]);
                            if (disableAnimation) {
                                card.scaleXY = scaleXY;
                                card.docking.x = dockingX;
                                card.docking.y = dockingY;
                            }
                            else {
                                timeline.add(gsap__WEBPACK_IMPORTED_MODULE_2__["TweenMax"].to(card.docking, this_1.settings.animationDuration, { x: dockingX, y: dockingY }), 0);
                                timeline.add(gsap__WEBPACK_IMPORTED_MODULE_2__["TweenMax"].to(card, this_1.settings.animationDuration, { scaleXY: scaleXY }), 0);
                            }
                        };
                        this_1 = this;
                        for (i = 0; i < this.cards.length; i++) {
                            _loop_1(i);
                        }
                        // put the card that is moving the most behind the others
                        if (this.cards.length % 2 === 1) {
                            if (reverseRotation) {
                                this.container.setChildIndex(this.cards[this.correspondingIndex.findIndex(function (c) { return c === 1; })], 0);
                            }
                        }
                        else if (!reverseRotation) {
                            farRightBackCard = Math.floor((this.cards.length - 1) / 2);
                            this.container.setChildIndex(this.cards[farRightBackCard], 0);
                        }
                        if (!!disableAnimation) return [3 /*break*/, 2];
                        return [4 /*yield*/, _tweenUtils__WEBPACK_IMPORTED_MODULE_4__["TweenUtils"].playTween(timeline)];
                    case 1:
                        _a.sent();
                        _a.label = 2;
                    case 2:
                        this.setButtonActive(this.isCarousel());
                        if (this.container.worldVisible) {
                            this.emit("changeCard", this.activeCard, this.previousActiveCard);
                        }
                        if (!this.settings.useCustomArrowsPositions) {
                            this.updateArrowsPositions();
                        }
                        this.emit("cardPositionsUpdated");
                        return [2 /*return*/];
                }
            });
        });
    };
    /**
     * Active or deactive buttons Left/Right arrow
     * @param active: True if buttons must be active
     */
    Carousel.prototype.setButtonActive = function (active) {
        if (active === void 0) { active = true; }
        if (this.getCards().length <= 2) {
            return;
        }
        if (this.previousArrow) {
            this.previousArrow.enabled = this.previousArrow.visible = active;
        }
        if (this.nextArrow) {
            this.nextArrow.enabled = this.nextArrow.visible = active;
        }
    };
    /**
     * Switch to previous card
     * @param disableAnimation: True if the changement should be instant
     */
    Carousel.prototype.previousCard = function (disableAnimation) {
        if (disableAnimation === void 0) { disableAnimation = false; }
        if (!this.isCarousel()) {
            return;
        }
        this.previousActiveCard = this.cards[0];
        var temp = this.cards.pop();
        this.cards.splice(0, 0, temp);
        this.updateCardPositions(disableAnimation, true);
    };
    /**
     * Switch to next card
     * @param disableAnimation: True if the changement shoud be instant
     */
    Carousel.prototype.nextCard = function (disableAnimation) {
        if (disableAnimation === void 0) { disableAnimation = false; }
        if (!this.isCarousel()) {
            return;
        }
        this.previousActiveCard = this.cards[0];
        var temp = this.cards.shift();
        this.cards[this.cards.length] = temp;
        this.updateCardPositions(disableAnimation);
    };
    /**
     * Kill the carousel and remove all events
     */
    Carousel.prototype.kill = function () {
        if (typeof window !== "undefined") {
            window.removeEventListener("wheel", this.onScroll.bind(this));
            window.removeEventListener("mousewheel", this.onScroll.bind(this));
            window.removeEventListener("DOMMouseScroll", this.onScroll.bind(this));
        }
    };
    /**
     * Sets wether or not the carousel is active.
     * @param isActive defines wether or not the carousel is active.
     */
    Carousel.prototype.setActive = function (isActive) {
        return (this.isActive = isActive);
    };
    /* GETTERS */
    /**
     * Know if arrows should be active, in relation with the number of cards present in carousel
     */
    Carousel.prototype.isCarousel = function () {
        return this.cards.length > 2;
    };
    /**
     * Get the active card
     * @returns
     */
    Carousel.prototype.getActiveCard = function () {
        return this.activeCard;
    };
    /**
     * Get list of cards
     * @returns
     */
    Carousel.prototype.getCards = function () {
        return this.cards;
    };
    /**
     * Check if the carousel is in simple mode (without wheel)
     * @returns True if the carousel is in simple mode
     */
    Carousel.prototype.isSimpleMode = function () {
        return this.cards.length <= 2;
    };
    return Carousel;
}(pixi_js__WEBPACK_IMPORTED_MODULE_3__["utils"].EventEmitter));



/***/ }),

/***/ "./src/game/express/express.ts":
/*!*************************************!*\
  !*** ./src/game/express/express.ts ***!
  \*************************************/
/*! exports provided: Express */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Express", function() { return Express; });
/* harmony import */ var i18next__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! i18next */ "i18next");
/* harmony import */ var i18next__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(i18next__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var _com__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../com */ "./src/com/index.ts");
/* harmony import */ var _abstractGame__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../abstractGame */ "./src/game/abstractGame.ts");
var __extends = (undefined && undefined.__extends) || (function () {
    var extendStatics = function (d, b) {
        extendStatics = Object.setPrototypeOf ||
            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||
            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };
        return extendStatics(d, b);
    };
    return function (d, b) {
        if (typeof b !== "function" && b !== null)
            throw new TypeError("Class extends value " + String(b) + " is not a constructor or null");
        extendStatics(d, b);
        function __() { this.constructor = d; }
        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
    };
})();
var __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};
var __generator = (undefined && undefined.__generator) || function (thisArg, body) {
    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;
    return g = { next: verb(0), "throw": verb(1), "return": verb(2) }, typeof Symbol === "function" && (g[Symbol.iterator] = function() { return this; }), g;
    function verb(n) { return function (v) { return step([n, v]); }; }
    function step(op) {
        if (f) throw new TypeError("Generator is already executing.");
        while (g && (g = 0, op[0] && (_ = 0)), _) try {
            if (f = 1, y && (t = op[0] & 2 ? y["return"] : op[0] ? y["throw"] || ((t = y["return"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;
            if (y = 0, t) op = [op[0] & 2, t.value];
            switch (op[0]) {
                case 0: case 1: t = op; break;
                case 4: _.label++; return { value: op[1], done: false };
                case 5: _.label++; y = op[1]; op = [0]; continue;
                case 7: op = _.ops.pop(); _.trys.pop(); continue;
                default:
                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }
                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }
                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }
                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }
                    if (t[2]) _.ops.pop();
                    _.trys.pop(); continue;
            }
            op = body.call(thisArg, _);
        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }
        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };
    }
};



var Express = /** @class */ (function (_super) {
    __extends(Express, _super);
    /**
     * Constructor
     * @param gameConfig: the game configuration (game.conf.json)
     * @param width: the canvas width
     * @param height: the canvas height
     * @param noWebGL: enable/disable WebGL (to force Canvas)
     * @param options: the Pixi.js applicaiton options
     */
    function Express(gameConfig, width, height, noWebGL, options) {
        var _this = 
        // Initialize
        _super.call(this, gameConfig, width, height, noWebGL, options) || this;
        _this.selectedStake =
            gameConfig.stakes[gameConfig.defaultStakeIndex ? gameConfig.defaultStakeIndex : 0];
        return _this;
    }
    /**
     * Creates an ITG bet request.
     * @param betRequest: the bet request parameters.
     */
    Express.prototype.bet = function (betRequest) {
        return __awaiter(this, void 0, void 0, function () {
            var betResponse;
            return __generator(this, function (_a) {
                switch (_a.label) {
                    case 0:
                        if (!betRequest.stake) {
                            throw new Error("Try to bet with parameters.stake undefined");
                        }
                        return [4 /*yield*/, this.com.createItgBet(betRequest)];
                    case 1:
                        betResponse = _a.sent();
                        // Refresh purse
                        return [4 /*yield*/, this.getPurse(true)];
                    case 2:
                        // Refresh purse
                        _a.sent();
                        return [2 /*return*/, this._betResponseToTicketData(betRequest, betResponse)];
                }
            });
        });
    };
    /**
     * Shows the continue game popup
     */
    Express.prototype.showResumeGamePopup = function () {
        return __awaiter(this, void 0, void 0, function () {
            return __generator(this, function (_a) {
                switch (_a.label) {
                    case 0: return [4 /*yield*/, this.com.messageManager.display({
                            code: "ITG.RESUME",
                            type: _com__WEBPACK_IMPORTED_MODULE_1__["EMessageType"].Immediate,
                            popup: {
                                level: _com__WEBPACK_IMPORTED_MODULE_1__["EPopinLevel"].Info,
                                text: i18next__WEBPACK_IMPORTED_MODULE_0___default.a.t("itg.resume.text"),
                                buttons: [
                                    {
                                        label: i18next__WEBPACK_IMPORTED_MODULE_0___default.a.t("itg.resume.button"),
                                        action: _com__WEBPACK_IMPORTED_MODULE_1__["PopinButtonAction"].ClosePopin,
                                    },
                                ],
                            },
                        })];
                    case 1: return [2 /*return*/, _a.sent()];
                }
            });
        });
    };
    /**
     * Shows the continue game popup
     */
    Express.prototype.showReplayStartPopup = function () {
        return __awaiter(this, void 0, void 0, function () {
            return __generator(this, function (_a) {
                switch (_a.label) {
                    case 0: return [4 /*yield*/, this.com.messageManager.display({
                            code: "ITG.REPLAY",
                            type: _com__WEBPACK_IMPORTED_MODULE_1__["EMessageType"].Immediate,
                            popup: {
                                level: _com__WEBPACK_IMPORTED_MODULE_1__["EPopinLevel"].Info,
                                text: i18next__WEBPACK_IMPORTED_MODULE_0___default.a.t("itg.replay.text"),
                                buttons: [
                                    {
                                        label: i18next__WEBPACK_IMPORTED_MODULE_0___default.a.t("itg.replay.button"),
                                        action: _com__WEBPACK_IMPORTED_MODULE_1__["PopinButtonAction"].ClosePopin,
                                    },
                                ],
                            },
                        })];
                    case 1: return [2 /*return*/, _a.sent()];
                }
            });
        });
    };
    /**
     * Returns the current player's information.
     * null if the player is not authenticated
     */
    Express.prototype.getUserInformation = function () {
        return __awaiter(this, void 0, void 0, function () {
            return __generator(this, function (_a) {
                return [2 /*return*/, this.com.getUserInformation()];
            });
        });
    };
    /**
     * Has to be called before buying a ticket
     * The event will be sent only if `handlePreBet` parameter is set to true in the behaviourParameters set of the gameConfig
     * @returns promise
     * The lottery must resolve whenever it wants the player to continue with his bet
     * The lottery must reject if ever it wants to cancel the player's bet process
     */
    Express.prototype.preBet = function (betRequest) {
        return __awaiter(this, void 0, void 0, function () {
            return __generator(this, function (_a) {
                if (this.gameConfig.gameParameters.handlePreBet) {
                    return [2 /*return*/, this.com.preBet(betRequest)];
                }
                else {
                    // default behaviour
                    return [2 /*return*/, Promise.resolve()];
                }
                return [2 /*return*/];
            });
        });
    };
    /**
     * This hook can be called at the end of the revelation (after the result)
     * The event will be sent only if `gameEndHook` parameter is set to true in the behaviourParameters set of the gameConfig
     * It notifies the lottery that the game revelation has ended.
     * Allows the lottery to present the player a custom message asking him if he wants to replay.
     * The lottery has the ability to launch directly a new bet with a given stake and mode or to go back to the home view of the game.
     * @returns promise
     * The lottery must resolve with a stake and a demoMode whenever it wants the game to automatically buy a new game
     * The lottery must resolve with undefined otherwise
     */
    Express.prototype.gameEndHook = function (ticket) {
        return __awaiter(this, void 0, void 0, function () {
            return __generator(this, function (_a) {
                if (this.gameConfig.gameParameters.gameEndHook) {
                    return [2 /*return*/, this.com.bridge.emitEvent("GAME_END_HOOK", { ticket: ticket, stakes: this.gameConfig.stakes })];
                }
                else {
                    // default behaviour
                    return [2 /*return*/, Promise.resolve(undefined)];
                }
                return [2 /*return*/];
            });
        });
    };
    /**
     * Notifies the lottery that there is an existing opened ticket to resume.
     * The event will be sent only if `resumeHook` parameter is set to true in the behaviourParameters set of the gameConfig
     * The lottery has the ability to present the player with the info and to wether accept or refuse the resuming.
     * Resfusing the resuming of the ticket can return to home or close the game for example, depending on the lottery guidelines.
     * @returns promise
     * The lottery must resolve `true`to go on with resuming the ticket
     * The lottery must resolve `false` otherwise.
     */
    Express.prototype.resumeHook = function (ticket) {
        return __awaiter(this, void 0, void 0, function () {
            return __generator(this, function (_a) {
                if (this.gameConfig.gameParameters.resumeHook) {
                    return [2 /*return*/, this.com.bridge.emitEvent("RESUME_HOOK", ticket)];
                }
                else {
                    // default behaviour
                    return [2 /*return*/, Promise.resolve(true)];
                }
                return [2 /*return*/];
            });
        });
    };
    /**
     * Request a new game mode
     *  @param options : one of the two EGameMode
     *  - if current game mode is already the one, it will do nothing
     *  - otherwise creates the dedicated IF session
     * Resolves when done, with the new current GameMode
     */
    Express.prototype.updateGameMode = function (mode) {
        return __awaiter(this, void 0, void 0, function () {
            return __generator(this, function (_a) {
                return [2 /*return*/, this.com.updateGameMode(mode)];
            });
        });
    };
    /**
     * Returns the first existing ticket that haven't been claimed by the user.
     * @param serviceName the service name associated to the ticket.
     */
    Express.prototype.getExistingTicket = function (serviceName, demo) {
        return __awaiter(this, void 0, void 0, function () {
            var response;
            return __generator(this, function (_a) {
                switch (_a.label) {
                    case 0: return [4 /*yield*/, this.com.getItgTickets(serviceName, demo)];
                    case 1:
                        response = _a.sent();
                        return [2 /*return*/, response[0]];
                }
            });
        });
    };
    /**
     * Retrieve ticket to replay if any
     * returns null if no ticket to replay.
     */
    Express.prototype.getTicketToReplay = function (demo) {
        return __awaiter(this, void 0, void 0, function () {
            return __generator(this, function (_a) {
                return [2 /*return*/, this.com.getTicketToReplay(demo)];
            });
        });
    };
    /**
     * Updates the given ticket
     * @param betRequest: the bet request parameters.
     * @param ticketId the id of the ticket to update.
     * @param showError display an error on failed request
     */
    Express.prototype.updateTicket = function (betRequest, ticketId, showError) {
        if (showError === void 0) { showError = true; }
        return __awaiter(this, void 0, void 0, function () {
            var betResponse;
            return __generator(this, function (_a) {
                switch (_a.label) {
                    case 0: return [4 /*yield*/, this.com.updateItgTicket(betRequest, ticketId, showError)];
                    case 1:
                        betResponse = _a.sent();
                        return [2 /*return*/, this._betResponseToTicketData(betRequest, betResponse)];
                }
            });
        });
    };
    /**
     * Claims an ITG ticket
     * @param betRequest: the bet request parameters.
     * @param ticketId the id of the ticket to claim.
     */
    Express.prototype.claim = function (betRequest, ticketId) {
        return __awaiter(this, void 0, void 0, function () {
            var betResponse;
            return __generator(this, function (_a) {
                switch (_a.label) {
                    case 0: return [4 /*yield*/, this.com.claimItgBet(betRequest, ticketId)];
                    case 1:
                        betResponse = _a.sent();
                        return [4 /*yield*/, this.getPurse(true)];
                    case 2:
                        _a.sent();
                        return [2 /*return*/, this._betResponseToTicketData(betRequest, betResponse)];
                }
            });
        });
    };
    Express.prototype._betResponseToTicketData = function (betRequest, betResponse) {
        var ticket = betResponse.data;
        ticket.betAmount = betRequest.stake;
        ticket.wonAmount = betResponse.wonAmount;
        ticket.receiptId = betResponse.receiptId;
        ticket.platformBetId = betResponse.platformBetId;
        ticket.demo = betResponse.demo;
        var eventReference = ticket.eventReference;
        if (eventReference) {
            ticket.prize = {
                rank: eventReference.prizeRank,
                type: eventReference.prizeType,
                description: eventReference.prizeDescription,
            };
        }
        if (betResponse.serverMessage) {
            var ids = betResponse.serverMessage.map(function (e) { return e.id; }).filter(function (id) { return id !== "NO_ACTION"; });
            if (ids.length !== 0) {
                ticket.action = ids[0];
            }
        }
        return ticket;
    };
    Object.defineProperty(Express.prototype, "betMode", {
        get: function () {
            return (this.gameConfig.selectedBetMode || "").toLowerCase().indexOf("manual") >= 0
                ? "BET_MANUAL_CLAIM"
                : "BET_AUTO_CLAIM";
        },
        enumerable: false,
        configurable: true
    });
    return Express;
}(_abstractGame__WEBPACK_IMPORTED_MODULE_2__["AbstractGame"]));



/***/ }),

/***/ "./src/game/express/ticket.ts":
/*!************************************!*\
  !*** ./src/game/express/ticket.ts ***!
  \************************************/
/*! exports provided: ETicketStatus, ETicketMode, EBetResponseAction, Ticket */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ETicketStatus", function() { return ETicketStatus; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ETicketMode", function() { return ETicketMode; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "EBetResponseAction", function() { return EBetResponseAction; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Ticket", function() { return Ticket; });
/* harmony import */ var _gdk_core__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @gdk/core */ "@gdk/core");
/* harmony import */ var _gdk_core__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_gdk_core__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var _tweenUtils__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../tweenUtils */ "./src/game/tweenUtils.ts");
var __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};
var __generator = (undefined && undefined.__generator) || function (thisArg, body) {
    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;
    return g = { next: verb(0), "throw": verb(1), "return": verb(2) }, typeof Symbol === "function" && (g[Symbol.iterator] = function() { return this; }), g;
    function verb(n) { return function (v) { return step([n, v]); }; }
    function step(op) {
        if (f) throw new TypeError("Generator is already executing.");
        while (g && (g = 0, op[0] && (_ = 0)), _) try {
            if (f = 1, y && (t = op[0] & 2 ? y["return"] : op[0] ? y["throw"] || ((t = y["return"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;
            if (y = 0, t) op = [op[0] & 2, t.value];
            switch (op[0]) {
                case 0: case 1: t = op; break;
                case 4: _.label++; return { value: op[1], done: false };
                case 5: _.label++; y = op[1]; op = [0]; continue;
                case 7: op = _.ops.pop(); _.trys.pop(); continue;
                default:
                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }
                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }
                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }
                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }
                    if (t[2]) _.ops.pop();
                    _.trys.pop(); continue;
            }
            op = body.call(thisArg, _);
        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }
        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };
    }
};


var ETicketStatus;
(function (ETicketStatus) {
    ETicketStatus["CLAIMED"] = "CLAIMED";
    ETicketStatus["OPENED"] = "OPENED";
})(ETicketStatus || (ETicketStatus = {}));
var ETicketMode;
(function (ETicketMode) {
    ETicketMode[ETicketMode["DEFAULT"] = 0] = "DEFAULT";
    ETicketMode[ETicketMode["RESUME"] = 1] = "RESUME";
    ETicketMode[ETicketMode["REPLAY"] = 2] = "REPLAY";
})(ETicketMode || (ETicketMode = {}));
var EBetResponseAction;
(function (EBetResponseAction) {
    EBetResponseAction["NO_ACTION"] = "NO_ACTION";
    EBetResponseAction["SUSPENSION_TRIGGERED"] = "SUSPENSION_TRIGGERED";
    EBetResponseAction["AUTOWITHDRAWAL_TRIGGERED"] = "AUTOWITHDRAWAL_TRIGGERED";
})(EBetResponseAction || (EBetResponseAction = {}));
var Ticket = /** @class */ (function () {
    /**
     * Constructor
     * @param ticket an IItgTicket
     * @param demo wether or not the ticket is in demo mode.
     */
    function Ticket(ticket, mode, _game) {
        if (mode === void 0) { mode = ETicketMode.DEFAULT; }
        this._game = _game;
        this._updateInProgress = false;
        this.ticket = ticket;
        this.serviceName = ticket.serviceName;
        this.stake = new _gdk_core__WEBPACK_IMPORTED_MODULE_0__["Amount"](ticket.betAmount);
        this.demo = ticket.demo;
        this.wonAmount = ticket.wonAmount ? new _gdk_core__WEBPACK_IMPORTED_MODULE_0__["Amount"](ticket.wonAmount) : null;
        this.symbol = ticket.symbol;
        this.receiptId = ticket.receiptId;
        this.platformBetId = ticket.platformBetId;
        this.ticketId = ticket.id;
        this.mode = mode;
        // parse symbol
        this.parse();
        // check revelationDataValidity so that resume don't get stuck
        var revelationData = ticket.revelationData;
        if (revelationData !== null) {
            var invalidReason = "areRevelationDataValid returned false";
            var revelationDataValid = void 0;
            try {
                revelationDataValid = this.areRevelationDataValid(revelationData);
            }
            catch (e) {
                invalidReason = "areRevelationDataValid error: ".concat(e.message);
                revelationDataValid = false;
            }
            if (!revelationDataValid) {
                _gdk_core__WEBPACK_IMPORTED_MODULE_0__["Logger"].getLogger().error("".concat(invalidReason, " with data: \n\n").concat(JSON.stringify(revelationData)));
                revelationData = null;
            }
        }
        this.revelationData = revelationData;
        if (ticket.action) {
            this.action = ticket.action;
        }
        this.status = ticket.status;
    }
    /**
     * Claim ITG ticket
     */
    Ticket.prototype.claim = function () {
        return __awaiter(this, void 0, void 0, function () {
            var response;
            return __generator(this, function (_a) {
                switch (_a.label) {
                    case 0:
                        // if ticket is already claimed, don't call claim
                        if (this.status === ETicketStatus.CLAIMED &&
                            (this._game.betMode === "BET_MANUAL_CLAIM" || this.mode === ETicketMode.REPLAY)) {
                            return [2 /*return*/, this.ticket];
                        }
                        return [4 /*yield*/, this._game.claim({
                                applicationId: "ITG",
                                serviceName: this._game.gameConfig.lotteryGameCode,
                                stake: {
                                    currency: this.stake.currency,
                                    value: this.stake.value,
                                },
                                demo: this.demo,
                            }, this.ticketId)];
                    case 1:
                        response = _a.sent();
                        this.status = response.status;
                        this.wonAmount = response.wonAmount ? new _gdk_core__WEBPACK_IMPORTED_MODULE_0__["Amount"](response.wonAmount) : null;
                        if (response.action) {
                            this.action = response.action;
                        }
                        return [2 /*return*/, response];
                }
            });
        });
    };
    /**
     * Update ticket by sending revelation data to the server
     * @param showError display an error message on request failure (default: true)
     */
    Ticket.prototype.update = function (showError) {
        if (showError === void 0) { showError = true; }
        return __awaiter(this, void 0, void 0, function () {
            return __generator(this, function (_a) {
                switch (_a.label) {
                    case 0:
                        if (this._updateInProgress || this.mode === ETicketMode.REPLAY) {
                            return [2 /*return*/, this._updatePromise];
                        }
                        this._updateInProgress = true;
                        return [4 /*yield*/, _tweenUtils__WEBPACK_IMPORTED_MODULE_1__["TweenUtils"].wait(0.5)];
                    case 1:
                        _a.sent();
                        return [4 /*yield*/, this._updateTicketNow(showError)];
                    case 2:
                        _a.sent();
                        return [2 /*return*/];
                }
            });
        });
    };
    Ticket.prototype._updateTicketNow = function (showError) {
        if (showError === void 0) { showError = true; }
        return __awaiter(this, void 0, void 0, function () {
            return __generator(this, function (_a) {
                switch (_a.label) {
                    case 0:
                        this._updateInProgress = false;
                        // never update a claimed ticket
                        if (this.status === ETicketStatus.CLAIMED) {
                            return [2 /*return*/];
                        }
                        return [4 /*yield*/, this._game.updateTicket({
                                applicationId: "ITG",
                                demo: this.ticket.demo,
                                serviceName: this._game.gameConfig.lotteryGameCode,
                                stake: {
                                    currency: this.stake.currency,
                                    value: this.stake.value,
                                },
                                revelationData: this.revelationData,
                            }, this.ticketId, showError)];
                    case 1:
                        _a.sent();
                        return [2 /*return*/];
                }
            });
        });
    };
    Object.defineProperty(Ticket.prototype, "prize", {
        /**
         * Return the prize object of the ticket
         */
        get: function () {
            return this.ticket.prize;
        },
        enumerable: false,
        configurable: true
    });
    return Ticket;
}());



/***/ }),

/***/ "./src/game/gameEvents.ts":
/*!********************************!*\
  !*** ./src/game/gameEvents.ts ***!
  \********************************/
/*! exports provided: EGameEvents */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "EGameEvents", function() { return EGameEvents; });
var EGameEvents;
(function (EGameEvents) {
    EGameEvents["GameStart"] = "gamestart";
    EGameEvents["GameEnd"] = "gameend";
    EGameEvents["RulesOpen"] = "rulesopen";
    EGameEvents["RulesQuit"] = "rulesquit";
    EGameEvents["GamePaused"] = "gamepaused";
    EGameEvents["GameMuted"] = "gamemuted";
})(EGameEvents || (EGameEvents = {}));


/***/ }),

/***/ "./src/game/inactivity.ts":
/*!********************************!*\
  !*** ./src/game/inactivity.ts ***!
  \********************************/
/*! exports provided: Inactivity */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Inactivity", function() { return Inactivity; });
/* harmony import */ var gsap__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! gsap */ "gsap");
/* harmony import */ var gsap__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(gsap__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var _gameEvents__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./gameEvents */ "./src/game/gameEvents.ts");
/* harmony import */ var _adaptativeVisualIdentity_events__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../adaptativeVisualIdentity/events */ "./src/adaptativeVisualIdentity/events.ts");
var __assign = (undefined && undefined.__assign) || function () {
    __assign = Object.assign || function(t) {
        for (var s, i = 1, n = arguments.length; i < n; i++) {
            s = arguments[i];
            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))
                t[p] = s[p];
        }
        return t;
    };
    return __assign.apply(this, arguments);
};
var __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};
var __generator = (undefined && undefined.__generator) || function (thisArg, body) {
    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;
    return g = { next: verb(0), "throw": verb(1), "return": verb(2) }, typeof Symbol === "function" && (g[Symbol.iterator] = function() { return this; }), g;
    function verb(n) { return function (v) { return step([n, v]); }; }
    function step(op) {
        if (f) throw new TypeError("Generator is already executing.");
        while (g && (g = 0, op[0] && (_ = 0)), _) try {
            if (f = 1, y && (t = op[0] & 2 ? y["return"] : op[0] ? y["throw"] || ((t = y["return"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;
            if (y = 0, t) op = [op[0] & 2, t.value];
            switch (op[0]) {
                case 0: case 1: t = op; break;
                case 4: _.label++; return { value: op[1], done: false };
                case 5: _.label++; y = op[1]; op = [0]; continue;
                case 7: op = _.ops.pop(); _.trys.pop(); continue;
                default:
                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }
                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }
                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }
                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }
                    if (t[2]) _.ops.pop();
                    _.trys.pop(); continue;
            }
            op = body.call(thisArg, _);
        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }
        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };
    }
};



var defaultInactivityOptions = {
    delay: 5,
    autoStart: true,
};
var Inactivity = /** @class */ (function () {
    /* LIFECYCLE */
    /**
     * @constructor
     */
    function Inactivity(game, onInactivity, onEndInactivity, options) {
        if (options === void 0) { options = {}; }
        var _this = this;
        /* ATTRIBUTES */
        /**
         * Set to true to call event every delay exceed
         */
        this.loop = false;
        /**
         * Check if the click is maintained
         */
        this.isClickMaintained = false;
        /**
         * Check if settings is opened
         */
        this.isSettingsOpened = false;
        /**
         * Check if rules are opened
         */
        this.isRulesOpened = false;
        /**
         * Check if it has been subscribed to event listener of the document
         */
        this.subscribed = false;
        /**
         * Check if inactivity event has been called
         */
        this.inactive = false;
        /**
         * Options of the inactivity
         */
        this.options = {};
        /**
         * Event called to start the inactivity event
         */
        this.onDelayExceeded = function () { return __awaiter(_this, void 0, void 0, function () {
            return __generator(this, function (_a) {
                switch (_a.label) {
                    case 0:
                        this.stopTimeOut();
                        this.inactive = true;
                        if (!this.onInactivity) return [3 /*break*/, 2];
                        return [4 /*yield*/, this.onInactivity()];
                    case 1:
                        _a.sent();
                        _a.label = 2;
                    case 2:
                        if (this.loop) {
                            this.startTimeOut(this.options.loopDelay);
                        }
                        return [2 /*return*/];
                }
            });
        }); };
        /**
         * Event trigger when click is maintained
         */
        this.onClickMaintained = function () { return __awaiter(_this, void 0, void 0, function () {
            return __generator(this, function (_a) {
                switch (_a.label) {
                    case 0:
                        this.isClickMaintained = true;
                        return [4 /*yield*/, this.pause()];
                    case 1:
                        _a.sent();
                        return [2 /*return*/];
                }
            });
        }); };
        /**
         * Event trigger when click is ended
         */
        this.onClickEnd = function () { return __awaiter(_this, void 0, void 0, function () {
            return __generator(this, function (_a) {
                switch (_a.label) {
                    case 0:
                        if (!(this.isClickMaintained && !this.isSettingsOpened && !this.isRulesOpened)) return [3 /*break*/, 2];
                        return [4 /*yield*/, this.start()];
                    case 1:
                        _a.sent();
                        _a.label = 2;
                    case 2: return [2 /*return*/];
                }
            });
        }); };
        /**
         * Event trigger when pointer is moving
         */
        this.onPointerMove = function () { return __awaiter(_this, void 0, void 0, function () {
            return __generator(this, function (_a) {
                switch (_a.label) {
                    case 0:
                        if (!(!this.isClickMaintained && !this.isSettingsOpened && !this.isRulesOpened)) return [3 /*break*/, 2];
                        return [4 /*yield*/, this.start()];
                    case 1:
                        _a.sent();
                        _a.label = 2;
                    case 2: return [2 /*return*/];
                }
            });
        }); };
        /**
         * Event trigger when settings are shown
         */
        this.onShowSettings = function () { return __awaiter(_this, void 0, void 0, function () {
            return __generator(this, function (_a) {
                switch (_a.label) {
                    case 0:
                        this.isSettingsOpened = true;
                        return [4 /*yield*/, this.pause()];
                    case 1:
                        _a.sent();
                        return [2 /*return*/];
                }
            });
        }); };
        /**
         * Event trigger when rules are shown
         */
        this.onShowRules = function () { return __awaiter(_this, void 0, void 0, function () {
            return __generator(this, function (_a) {
                switch (_a.label) {
                    case 0:
                        this.isRulesOpened = true;
                        return [4 /*yield*/, this.pause()];
                    case 1:
                        _a.sent();
                        return [2 /*return*/];
                }
            });
        }); };
        /**
         * Event trigger when settings are hide
         */
        this.onHideSettings = function () { return __awaiter(_this, void 0, void 0, function () {
            return __generator(this, function (_a) {
                switch (_a.label) {
                    case 0:
                        this.isSettingsOpened = false;
                        if (!!this.isRulesOpened) return [3 /*break*/, 2];
                        return [4 /*yield*/, this.start()];
                    case 1:
                        _a.sent();
                        _a.label = 2;
                    case 2: return [2 /*return*/];
                }
            });
        }); };
        /**
         * Event trigger when settings are hide
         */
        this.onHideRules = function () { return __awaiter(_this, void 0, void 0, function () {
            return __generator(this, function (_a) {
                switch (_a.label) {
                    case 0:
                        this.isRulesOpened = false;
                        this.isSettingsOpened = false;
                        return [4 /*yield*/, this.start()];
                    case 1:
                        _a.sent();
                        return [2 /*return*/];
                }
            });
        }); };
        /**
         * Event trigger when game is paused / unpaused
         */
        this.onGamePaused = function (paused) { return __awaiter(_this, void 0, void 0, function () {
            return __generator(this, function (_a) {
                if (paused) {
                    this.pause();
                }
                else {
                    this.start();
                }
                return [2 /*return*/];
            });
        }); };
        /**
         * Start/Restart the timer
         */
        this.start = function () { return __awaiter(_this, void 0, void 0, function () {
            return __generator(this, function (_a) {
                switch (_a.label) {
                    case 0:
                        if (!this.inactive) return [3 /*break*/, 2];
                        return [4 /*yield*/, this.onEndInactivity()];
                    case 1:
                        _a.sent();
                        _a.label = 2;
                    case 2:
                        this.isClickMaintained = false;
                        this.isSettingsOpened = false;
                        this.isRulesOpened = false;
                        this.inactive = false;
                        this.startTimeOut();
                        this.subscribe();
                        return [2 /*return*/];
                }
            });
        }); };
        this.pause = function () { return __awaiter(_this, void 0, void 0, function () {
            return __generator(this, function (_a) {
                switch (_a.label) {
                    case 0:
                        if (!this.inactive) return [3 /*break*/, 2];
                        return [4 /*yield*/, this.onEndInactivity()];
                    case 1:
                        _a.sent();
                        _a.label = 2;
                    case 2:
                        this.inactive = false;
                        this.stopTimeOut();
                        return [2 /*return*/];
                }
            });
        }); };
        /**
         * Stop the current timer
         */
        this.stop = function () { return __awaiter(_this, void 0, void 0, function () {
            return __generator(this, function (_a) {
                switch (_a.label) {
                    case 0:
                        this.unsubscribe();
                        this.stopTimeOut();
                        if (!this.onEndInactivity) return [3 /*break*/, 2];
                        return [4 /*yield*/, this.onEndInactivity()];
                    case 1:
                        _a.sent();
                        _a.label = 2;
                    case 2: return [2 /*return*/];
                }
            });
        }); };
        this.game = game;
        this.onInactivity = onInactivity;
        this.onEndInactivity = onEndInactivity;
        this.options = __assign(__assign({}, defaultInactivityOptions), options);
        Object.keys(options).forEach(function (key) { return (_this[key] = options[key]); });
        if (this.options.autoStart) {
            this.start();
        }
    }
    /* METHODS */
    /**
     * Stop the TweenMax timeout
     */
    Inactivity.prototype.stopTimeOut = function () {
        if (this.timeOut) {
            this.timeOut.kill();
        }
    };
    /**
     * Start the TweenMax timeout
     */
    Inactivity.prototype.startTimeOut = function (customDelay) {
        this.stopTimeOut();
        this.timeOut = gsap__WEBPACK_IMPORTED_MODULE_0__["TweenMax"].delayedCall(customDelay && !isNaN(parseInt(customDelay.toString(), 10))
            ? customDelay
            : this.options.delay, this.onDelayExceeded);
    };
    /**
     * Subscribe to all document events
     */
    Inactivity.prototype.subscribe = function () {
        if (!this.subscribed) {
            this.subscribed = true;
            document.addEventListener("pointerdown", this.onClickMaintained, false);
            document.addEventListener("touchstart", this.onClickMaintained, false);
            document.addEventListener("pointerup", this.onClickEnd, false);
            document.addEventListener("touchend", this.onClickEnd, false);
            document.addEventListener("touchmove", this.onPointerMove, false);
            document.addEventListener("mousemove", this.onPointerMove, false);
            document.addEventListener("mouseend", this.onPointerMove, false);
            this.game.vi.emitter.on(_adaptativeVisualIdentity_events__WEBPACK_IMPORTED_MODULE_2__["EVisualIdentityEvent"].ShowSettings, this.onShowSettings);
            this.game.vi.emitter.on(_adaptativeVisualIdentity_events__WEBPACK_IMPORTED_MODULE_2__["EVisualIdentityEvent"].ShowRules, this.onShowRules);
            this.game.vi.emitter.on(_adaptativeVisualIdentity_events__WEBPACK_IMPORTED_MODULE_2__["EVisualIdentityEvent"].ShowMainRules, this.onShowRules);
            this.game.vi.emitter.on(_adaptativeVisualIdentity_events__WEBPACK_IMPORTED_MODULE_2__["EVisualIdentityEvent"].HideSettings, this.onHideSettings);
            this.game.events.on(_gameEvents__WEBPACK_IMPORTED_MODULE_1__["EGameEvents"].GamePaused, this.onGamePaused);
            this.game.events.on(_gameEvents__WEBPACK_IMPORTED_MODULE_1__["EGameEvents"].RulesQuit, this.onHideRules);
        }
    };
    /**
     * Unsubscribe from all document events
     */
    Inactivity.prototype.unsubscribe = function () {
        if (this.subscribed) {
            document.removeEventListener("pointerdown", this.onClickMaintained, false);
            document.removeEventListener("touchstart", this.onClickMaintained, false);
            document.removeEventListener("pointerup", this.onClickEnd, false);
            document.removeEventListener("touchend", this.onClickEnd, false);
            document.removeEventListener("touchmove", this.onPointerMove, false);
            document.removeEventListener("mousemove", this.onPointerMove, false);
            document.removeEventListener("mouseend", this.onPointerMove, false);
            this.subscribed = false;
            this.game.vi.emitter.off(_adaptativeVisualIdentity_events__WEBPACK_IMPORTED_MODULE_2__["EVisualIdentityEvent"].ShowSettings, this.onShowSettings);
            this.game.vi.emitter.off(_adaptativeVisualIdentity_events__WEBPACK_IMPORTED_MODULE_2__["EVisualIdentityEvent"].ShowRules, this.onShowRules);
            this.game.vi.emitter.off(_adaptativeVisualIdentity_events__WEBPACK_IMPORTED_MODULE_2__["EVisualIdentityEvent"].ShowMainRules, this.onShowRules);
            this.game.vi.emitter.off(_adaptativeVisualIdentity_events__WEBPACK_IMPORTED_MODULE_2__["EVisualIdentityEvent"].HideSettings, this.onHideSettings);
            this.game.events.off(_gameEvents__WEBPACK_IMPORTED_MODULE_1__["EGameEvents"].GamePaused, this.onGamePaused);
            this.game.events.off(_gameEvents__WEBPACK_IMPORTED_MODULE_1__["EGameEvents"].RulesQuit, this.onHideRules);
        }
    };
    /* PUBLIC */
    /**
     * Change the delay before calling the inactivity event
     * @param delay: The delay to change
     */
    Inactivity.prototype.setDelay = function (delay) {
        this.options.delay = delay;
        this.start();
    };
    /* GETTERS */
    /**
     * True if inactivity event has been called
     */
    Inactivity.prototype.isInactive = function () {
        return this.inactive;
    };
    return Inactivity;
}());



/***/ }),

/***/ "./src/game/index.ts":
/*!***************************!*\
  !*** ./src/game/index.ts ***!
  \***************************/
/*! exports provided: AbstractGame, EGameEvents, Express, Ticket, ETicketMode, ETicketStatus, EBetResponseAction, Action, MotorsModel, MotorsSession, ESessionMode, Multipass, MultipassSession, MultipassNotifications, EMultipassGameState, EMultipassNotificationType, TweenUtils, Rules, Slide, TextSlide, ELayout, BaseSlide, AgreementSlide, Home, ResultBox, EResultBoxEvents, ResultStage, ScratchStage, TextResultStage, AmountResultStage, Timer, CrossSell, EAvatarStatus, Inactivity, Carousel */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _abstractGame__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./abstractGame */ "./src/game/abstractGame.ts");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "AbstractGame", function() { return _abstractGame__WEBPACK_IMPORTED_MODULE_0__["AbstractGame"]; });

/* harmony import */ var _gameEvents__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./gameEvents */ "./src/game/gameEvents.ts");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "EGameEvents", function() { return _gameEvents__WEBPACK_IMPORTED_MODULE_1__["EGameEvents"]; });

/* harmony import */ var _express_express__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./express/express */ "./src/game/express/express.ts");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "Express", function() { return _express_express__WEBPACK_IMPORTED_MODULE_2__["Express"]; });

/* harmony import */ var _express_ticket__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./express/ticket */ "./src/game/express/ticket.ts");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "Ticket", function() { return _express_ticket__WEBPACK_IMPORTED_MODULE_3__["Ticket"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "ETicketMode", function() { return _express_ticket__WEBPACK_IMPORTED_MODULE_3__["ETicketMode"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "ETicketStatus", function() { return _express_ticket__WEBPACK_IMPORTED_MODULE_3__["ETicketStatus"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "EBetResponseAction", function() { return _express_ticket__WEBPACK_IMPORTED_MODULE_3__["EBetResponseAction"]; });

/* harmony import */ var _action_action__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./action/action */ "./src/game/action/action.ts");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "Action", function() { return _action_action__WEBPACK_IMPORTED_MODULE_4__["Action"]; });

/* harmony import */ var _action_model__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./action/model */ "./src/game/action/model.ts");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "MotorsModel", function() { return _action_model__WEBPACK_IMPORTED_MODULE_5__["MotorsModel"]; });

/* harmony import */ var _action_session__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./action/session */ "./src/game/action/session.ts");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "MotorsSession", function() { return _action_session__WEBPACK_IMPORTED_MODULE_6__["MotorsSession"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "ESessionMode", function() { return _action_session__WEBPACK_IMPORTED_MODULE_6__["ESessionMode"]; });

/* harmony import */ var _multipass_multipass__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./multipass/multipass */ "./src/game/multipass/multipass.ts");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "Multipass", function() { return _multipass_multipass__WEBPACK_IMPORTED_MODULE_7__["Multipass"]; });

/* harmony import */ var _multipass_session__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ./multipass/session */ "./src/game/multipass/session.ts");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "MultipassSession", function() { return _multipass_session__WEBPACK_IMPORTED_MODULE_8__["MultipassSession"]; });

/* harmony import */ var _multipass_notifications__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ./multipass/notifications */ "./src/game/multipass/notifications.ts");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "MultipassNotifications", function() { return _multipass_notifications__WEBPACK_IMPORTED_MODULE_9__["MultipassNotifications"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "EMultipassGameState", function() { return _multipass_notifications__WEBPACK_IMPORTED_MODULE_9__["EMultipassGameState"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "EMultipassNotificationType", function() { return _multipass_notifications__WEBPACK_IMPORTED_MODULE_9__["EMultipassNotificationType"]; });

/* harmony import */ var _tweenUtils__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ./tweenUtils */ "./src/game/tweenUtils.ts");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "TweenUtils", function() { return _tweenUtils__WEBPACK_IMPORTED_MODULE_10__["TweenUtils"]; });

/* harmony import */ var _ui__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ./ui */ "./src/game/ui/index.ts");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "Rules", function() { return _ui__WEBPACK_IMPORTED_MODULE_11__["Rules"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "Slide", function() { return _ui__WEBPACK_IMPORTED_MODULE_11__["Slide"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "TextSlide", function() { return _ui__WEBPACK_IMPORTED_MODULE_11__["TextSlide"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "ELayout", function() { return _ui__WEBPACK_IMPORTED_MODULE_11__["ELayout"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "BaseSlide", function() { return _ui__WEBPACK_IMPORTED_MODULE_11__["BaseSlide"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "AgreementSlide", function() { return _ui__WEBPACK_IMPORTED_MODULE_11__["AgreementSlide"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "Home", function() { return _ui__WEBPACK_IMPORTED_MODULE_11__["Home"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "ResultBox", function() { return _ui__WEBPACK_IMPORTED_MODULE_11__["ResultBox"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "EResultBoxEvents", function() { return _ui__WEBPACK_IMPORTED_MODULE_11__["EResultBoxEvents"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "ResultStage", function() { return _ui__WEBPACK_IMPORTED_MODULE_11__["ResultStage"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "ScratchStage", function() { return _ui__WEBPACK_IMPORTED_MODULE_11__["ScratchStage"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "TextResultStage", function() { return _ui__WEBPACK_IMPORTED_MODULE_11__["TextResultStage"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "AmountResultStage", function() { return _ui__WEBPACK_IMPORTED_MODULE_11__["AmountResultStage"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "Timer", function() { return _ui__WEBPACK_IMPORTED_MODULE_11__["Timer"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "CrossSell", function() { return _ui__WEBPACK_IMPORTED_MODULE_11__["CrossSell"]; });

/* harmony import */ var _wizz__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ./wizz */ "./src/game/wizz/index.ts");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "EAvatarStatus", function() { return _wizz__WEBPACK_IMPORTED_MODULE_12__["EAvatarStatus"]; });

/* harmony import */ var _inactivity__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ./inactivity */ "./src/game/inactivity.ts");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "Inactivity", function() { return _inactivity__WEBPACK_IMPORTED_MODULE_13__["Inactivity"]; });

/* harmony import */ var _carousel__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ./carousel */ "./src/game/carousel.ts");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "Carousel", function() { return _carousel__WEBPACK_IMPORTED_MODULE_14__["Carousel"]; });





// Motors



// Multipass










/***/ }),

/***/ "./src/game/multipass/multipass.ts":
/*!*****************************************!*\
  !*** ./src/game/multipass/multipass.ts ***!
  \*****************************************/
/*! exports provided: Multipass */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Multipass", function() { return Multipass; });
/* harmony import */ var pixi_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! pixi.js */ "pixi.js");
/* harmony import */ var pixi_js__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(pixi_js__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var _gdk_core_pixi__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @gdk/core-pixi */ "@gdk/core-pixi");
/* harmony import */ var _gdk_core_pixi__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(_gdk_core_pixi__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var _abstractGame__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../abstractGame */ "./src/game/abstractGame.ts");
var __extends = (undefined && undefined.__extends) || (function () {
    var extendStatics = function (d, b) {
        extendStatics = Object.setPrototypeOf ||
            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||
            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };
        return extendStatics(d, b);
    };
    return function (d, b) {
        if (typeof b !== "function" && b !== null)
            throw new TypeError("Class extends value " + String(b) + " is not a constructor or null");
        extendStatics(d, b);
        function __() { this.constructor = d; }
        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
    };
})();
var __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};
var __generator = (undefined && undefined.__generator) || function (thisArg, body) {
    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;
    return g = { next: verb(0), "throw": verb(1), "return": verb(2) }, typeof Symbol === "function" && (g[Symbol.iterator] = function() { return this; }), g;
    function verb(n) { return function (v) { return step([n, v]); }; }
    function step(op) {
        if (f) throw new TypeError("Generator is already executing.");
        while (g && (g = 0, op[0] && (_ = 0)), _) try {
            if (f = 1, y && (t = op[0] & 2 ? y["return"] : op[0] ? y["throw"] || ((t = y["return"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;
            if (y = 0, t) op = [op[0] & 2, t.value];
            switch (op[0]) {
                case 0: case 1: t = op; break;
                case 4: _.label++; return { value: op[1], done: false };
                case 5: _.label++; y = op[1]; op = [0]; continue;
                case 7: op = _.ops.pop(); _.trys.pop(); continue;
                default:
                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }
                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }
                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }
                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }
                    if (t[2]) _.ops.pop();
                    _.trys.pop(); continue;
            }
            op = body.call(thisArg, _);
        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }
        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };
    }
};



var Multipass = /** @class */ (function (_super) {
    __extends(Multipass, _super);
    /**
     * Constructor
     * @param gameConfig: the game configuration (game.conf.json)
     * @param width: the canvas width
     * @param height: the canvas height
     * @param noWebGL: enable/disable WebGL (to force Canvas)
     * @param options: the Pixi.js applicaiton options
     */
    function Multipass(gameConfig, width, height, noWebGL, options) {
        var _this = 
        // Initialize
        _super.call(this, gameConfig, width, height, noWebGL, options) || this;
        // Public members
        _this.room = null;
        _this.session = null;
        _this.notifications = null;
        _this.wasHidden = false;
        // Events for visibility change. If was hidden, update from the session
        document.addEventListener("visibilitychange", function () { return __awaiter(_this, void 0, void 0, function () {
            var notificationsWasMuted;
            return __generator(this, function (_a) {
                switch (_a.label) {
                    case 0:
                        if (!(this.wasHidden && this.notifications && this.session)) return [3 /*break*/, 2];
                        // Mute notifications in order to update game session
                        // and draw an overlay on top of the stage
                        this.stage.addChild(this.wasHiddenOverlay);
                        notificationsWasMuted = this.notifications.muted;
                        this.notifications.muted = true;
                        return [4 /*yield*/, this.updateSession()];
                    case 1:
                        _a.sent();
                        // Then, unmute notifications and remove overlay
                        this.notifications.muted = notificationsWasMuted;
                        this.stage.removeChild(this.wasHiddenOverlay);
                        _a.label = 2;
                    case 2:
                        this.wasHidden = document.visibilityState === "hidden";
                        return [2 /*return*/];
                }
            });
        }); });
        // When updating the session becuase the browser was hidden, draw an overlay
        _this.wasHiddenOverlay = new pixi_js__WEBPACK_IMPORTED_MODULE_0__["Graphics"]();
        _this.wasHiddenOverlay.beginFill(0x0, 0.6);
        _this.wasHiddenOverlay.drawRect(0, 0, 1, 1);
        _this.wasHiddenOverlay.resize = new _gdk_core_pixi__WEBPACK_IMPORTED_MODULE_1__["Resize"](_gdk_core_pixi__WEBPACK_IMPORTED_MODULE_1__["Resize"].cover);
        // Override default events for visual identity which pauses the game on the user
        // opens the settings or wants to see the rules
        _this.vi.emitter.removeAllListeners("showsettings");
        _this.vi.emitter.removeAllListeners("hidesettings");
        _this.vi.emitter.removeAllListeners("showrules");
        _this.vi.emitter.removeAllListeners("showmainrules");
        return _this;
    }
    /**
     * To be implemented by the game: it asks to update the game session. This can be called automatically
     * by notifications when a notification has been lost so the game has to be re-synchronized
     * by calling "updateSession"
     */
    Multipass.prototype.updateSession = function () {
        this.notifications.lastMessageId = this.session.lastPlayerNotificationId;
        this.notifications.lastMessageBroadcastId = this.session.lastGameSessionNotificationId;
    };
    /**
     * Return the player's rooms
     * @param parameters: the get rooms parameters (values to send to multipass)
     * @param done: callback containing the player's rooms
     */
    Multipass.prototype.getRooms = function (parameters) {
        if (!parameters) {
            parameters = {
                applicationId: this.gameConfig.engine,
                serviceName: this.gameConfig.lotteryGameCode,
            };
        }
        return this.com.getMtpRooms(parameters);
    };
    /**
     * Enters the given room identified by its id
     * @param parameters: the enter room parameters (values to send to multipass
     * @param done: callback once the player entered the room
     */
    Multipass.prototype.enterRoom = function (parameters) {
        return __awaiter(this, void 0, void 0, function () {
            return __generator(this, function (_a) {
                return [2 /*return*/, this.com.enterMtpRoom(parameters)];
            });
        });
    };
    /**
     * Gets the current session object of the given MTP game at the given roomId.
     * @param parameters: the parameters containing the service name.
     * @param roomId the id of the room containing the session to retrieve.
     */
    Multipass.prototype.getSession = function (parameters, roomId) {
        return __awaiter(this, void 0, void 0, function () {
            return __generator(this, function (_a) {
                return [2 /*return*/, this.com.getMtpSession(parameters, roomId)];
            });
        });
    };
    /**
     * Retrieve room parameters (min/max players, variant parameters etc.)
     * @param parameters: the request parameters (applicationId and service name with room id)
     * @param done: callback once request done
     */
    Multipass.prototype.getParameters = function (parameters) {
        if (!parameters) {
            parameters = {
                applicationId: this.gameConfig.engine,
                serviceName: this.gameConfig.lotteryGameCode,
            };
        }
        return this.com.getMtpParameters(parameters);
    };
    /**
     * Creates a bet
     * @param parameters: the bet request parameters
     * @param done: the callback when bet is done givng the bet response
     */
    Multipass.prototype.bet = function (parameters) {
        return __awaiter(this, void 0, void 0, function () {
            var bet;
            return __generator(this, function (_a) {
                switch (_a.label) {
                    case 0: return [4 /*yield*/, this.com.createMtpBet(parameters)];
                    case 1:
                        bet = _a.sent();
                        return [4 /*yield*/, this.getPurse(true)];
                    case 2:
                        _a.sent();
                        return [2 /*return*/, bet];
                }
            });
        });
    };
    /**
     * Enters to a room and bets according to the given bet informations.
     * @param options the options containing the room informations to enter and the bet informations.
     */
    Multipass.prototype.enterAndBet = function (parameters) {
        return __awaiter(this, void 0, void 0, function () {
            var bet;
            return __generator(this, function (_a) {
                switch (_a.label) {
                    case 0: return [4 /*yield*/, this.com.enterMtpRoomAndBet(parameters)];
                    case 1:
                        bet = _a.sent();
                        return [4 /*yield*/, this.getPurse(true)];
                    case 2:
                        _a.sent();
                        return [2 /*return*/, bet];
                }
            });
        });
    };
    /**
     * Excutes an action
     * @param parameters the execute parameters
     * @param done callback once request is done
     */
    Multipass.prototype.execute = function (parameters) {
        // const applicationId = parameters.applicationId || this.gameConfig.gameType;
        // const serviceName = parameters.serviceName || this.gameConfig.stakes[0].serviceName;
        // // Set player id game session
        // parameters.data.playerGameSessionId = this.session.playerGameSessionId;
        // await this.com.execute({
        // 	roomId: parameters.roomId || this.room.roomId,
        // 	sessionId: parameters.sessionId || this.session.id,
        // 	applicationId,
        // 	serviceName,
        // 	parameters: parameters.data,
        // }, parameters.showError);
        return this.com.updateMtpBet(parameters);
    };
    return Multipass;
}(_abstractGame__WEBPACK_IMPORTED_MODULE_2__["AbstractGame"]));



/***/ }),

/***/ "./src/game/multipass/notifications.ts":
/*!*********************************************!*\
  !*** ./src/game/multipass/notifications.ts ***!
  \*********************************************/
/*! exports provided: EMultipassGameState, EMultipassNotificationType, MultipassNotifications */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "EMultipassGameState", function() { return EMultipassGameState; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "EMultipassNotificationType", function() { return EMultipassNotificationType; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "MultipassNotifications", function() { return MultipassNotifications; });
/* harmony import */ var _com_popin_popin__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../com/popin/popin */ "./src/com/popin/popin.ts");
/* harmony import */ var _com_popin_definitions__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../com/popin/definitions */ "./src/com/popin/definitions.ts");
/* harmony import */ var _com_messageManager_definitions__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../com/messageManager/definitions */ "./src/com/messageManager/definitions.ts");
var __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};
var __generator = (undefined && undefined.__generator) || function (thisArg, body) {
    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;
    return g = { next: verb(0), "throw": verb(1), "return": verb(2) }, typeof Symbol === "function" && (g[Symbol.iterator] = function() { return this; }), g;
    function verb(n) { return function (v) { return step([n, v]); }; }
    function step(op) {
        if (f) throw new TypeError("Generator is already executing.");
        while (g && (g = 0, op[0] && (_ = 0)), _) try {
            if (f = 1, y && (t = op[0] & 2 ? y["return"] : op[0] ? y["throw"] || ((t = y["return"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;
            if (y = 0, t) op = [op[0] & 2, t.value];
            switch (op[0]) {
                case 0: case 1: t = op; break;
                case 4: _.label++; return { value: op[1], done: false };
                case 5: _.label++; y = op[1]; op = [0]; continue;
                case 7: op = _.ops.pop(); _.trys.pop(); continue;
                default:
                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }
                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }
                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }
                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }
                    if (t[2]) _.ops.pop();
                    _.trys.pop(); continue;
            }
            op = body.call(thisArg, _);
        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }
        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };
    }
};



var EMultipassGameState;
(function (EMultipassGameState) {
    EMultipassGameState["PENDING"] = "PENDING";
    EMultipassGameState["ONGOING"] = "ONGOING";
    EMultipassGameState["FINISHED"] = "FINISHED";
})(EMultipassGameState || (EMultipassGameState = {}));
var EMultipassNotificationType;
(function (EMultipassNotificationType) {
    EMultipassNotificationType["SESSION_INITIALIZED"] = "SESSION_INITIALIZED";
    EMultipassNotificationType["PLAYER_ENTER"] = "PLAYER_ENTER";
    EMultipassNotificationType["PAYOUT"] = "PAYOUT";
    EMultipassNotificationType["PLAYER_EXIT"] = "PLAYER_EXIT";
    EMultipassNotificationType["SCRIPT"] = "SCRIPT";
    EMultipassNotificationType["SESSION_CANCELLED"] = "SESSION_CANCELLED";
    EMultipassNotificationType["SESSION_STOPPED"] = "SESSION_STOPPED";
    EMultipassNotificationType["PLAYER_REMOVED"] = "PLAYER_REMOVED";
    EMultipassNotificationType["TRANSACTION_EVENT"] = "FALCON_TRANSACTION_EVENT";
})(EMultipassNotificationType || (EMultipassNotificationType = {}));
var MultipassNotifications = /** @class */ (function () {
    /**
     * Constructor
     * @param gameVariantName the game variant name to listen
     * @param roomId the room id running the session with the given game variant name
     */
    function MultipassNotifications(game, roomId) {
        this.channel = null;
        this.lastMessageId = null;
        this.lastMessageBroadcastId = null;
        // Private members
        this._muted = false;
        this._closed = true;
        this._timerId = null;
        this._timerBroadcastId = null;
        this._pendingNotifications = [];
        this._pendingNotificationsBroadcast = [];
        this._connectionPopin = null;
        this._connectionRetryCount = 0;
        // Misc.
        this.game = game;
        // Connect?
        if (roomId) {
            this.createChannel(roomId);
        }
        // Connection popin
        this._connectionPopin = new _com_popin_popin__WEBPACK_IMPORTED_MODULE_0__["Popin"]({
            level: _com_popin_definitions__WEBPACK_IMPORTED_MODULE_1__["EPopinLevel"].Info,
            text: this.game.com.t("sse_connection_try", "multiplayer"),
            closable: false,
            buttons: [],
        }, null);
    }
    /**
     * Creates the notifications channel
     * @param roomId the room id running the session with the given game variant name
     */
    MultipassNotifications.prototype.createChannel = function (roomId) {
        return __awaiter(this, void 0, void 0, function () {
            var _a;
            var _this = this;
            return __generator(this, function (_b) {
                switch (_b.label) {
                    case 0:
                        // this.source = new EventSource(`mtp/games/${gameVariantName}/rooms/${roomId}/notifications`);
                        /*this.source = new EventSource("https://mtp-qa-01.lotsys.corp:9991/mtp/" + roomId, {
                            withCredentials: true
                        });*/
                        // Create channel
                        _a = this;
                        return [4 /*yield*/, this.game.com.getNotificationsChannel({
                                transport: 2,
                                topic: {
                                    type: "mtp",
                                    id: roomId,
                                },
                            })];
                    case 1:
                        // this.source = new EventSource(`mtp/games/${gameVariantName}/rooms/${roomId}/notifications`);
                        /*this.source = new EventSource("https://mtp-qa-01.lotsys.corp:9991/mtp/" + roomId, {
                            withCredentials: true
                        });*/
                        // Create channel
                        _a.channel = _b.sent();
                        // Check disconnected
                        this.channel.addEventListener("disconnected", function () { return __awaiter(_this, void 0, void 0, function () { return __generator(this, function (_a) {
                            return [2 /*return*/, (this._closed = true)];
                        }); }); });
                        // Callback on receive a message
                        this.channel.addEventListener("message", function (e) {
                            // Parse message data
                            if (!e.detail || !e.detail.content) {
                                return;
                            }
                            var data = e.detail.content;
                            _this.dispatchNotification(data);
                        });
                        // Configure
                        if (this._muted) {
                            this.channel.mute();
                        }
                        this._closed = false;
                        return [2 /*return*/];
                }
            });
        });
    };
    /**
     * Starts the notifications by connecting to the server
     * @param retryCount the number of retries if connection failed
     */
    MultipassNotifications.prototype.start = function (retryCount) {
        if (retryCount === void 0) { retryCount = 3; }
        return __awaiter(this, void 0, void 0, function () {
            var e_1;
            return __generator(this, function (_a) {
                switch (_a.label) {
                    case 0:
                        if (!this.channel) {
                            return [2 /*return*/];
                        }
                        // Show connection popin?
                        if (this._connectionRetryCount > 0) {
                            this._connectionPopin.display();
                        }
                        else {
                            this._connectionPopin.close();
                        }
                        _a.label = 1;
                    case 1:
                        _a.trys.push([1, 3, , 8]);
                        // Connect
                        return [4 /*yield*/, this.channel.start()];
                    case 2:
                        // Connect
                        _a.sent();
                        this._connectionPopin.close();
                        return [3 /*break*/, 8];
                    case 3:
                        e_1 = _a.sent();
                        retryCount--;
                        this._connectionRetryCount++;
                        if (!(retryCount > 0)) return [3 /*break*/, 5];
                        return [4 /*yield*/, this.start(retryCount)];
                    case 4: return [2 /*return*/, _a.sent()];
                    case 5:
                        this._connectionPopin.close();
                        return [4 /*yield*/, this.game.com.messageManager.display({
                                code: "SSE.CONNECTION.FAILED",
                                type: _com_messageManager_definitions__WEBPACK_IMPORTED_MODULE_2__["EMessageType"].Immediate,
                                popup: {
                                    level: _com_popin_definitions__WEBPACK_IMPORTED_MODULE_1__["EPopinLevel"].Error,
                                    text: this.game.com.t("sse_connection_failed", "multiplayer"),
                                    buttons: [
                                        {
                                            label: this.game.com.t("close", "ui") || " Close",
                                            action: _com_popin_definitions__WEBPACK_IMPORTED_MODULE_1__["PopinButtonAction"].CloseGame,
                                        },
                                        {
                                            label: this.game.com.t("retry", "ui"),
                                            action: _com_popin_definitions__WEBPACK_IMPORTED_MODULE_1__["PopinButtonAction"].ClosePopin,
                                        },
                                    ],
                                },
                            })];
                    case 6:
                        _a.sent();
                        return [4 /*yield*/, this.start()];
                    case 7:
                        _a.sent();
                        return [3 /*break*/, 8];
                    case 8: return [2 /*return*/];
                }
            });
        });
    };
    /**
     * Closes the notifications by disconnecting from the server
     */
    MultipassNotifications.prototype.close = function () {
        return __awaiter(this, void 0, void 0, function () {
            return __generator(this, function (_a) {
                switch (_a.label) {
                    case 0:
                        if (this._closed) {
                            return [2 /*return*/];
                        }
                        if (!this.channel) return [3 /*break*/, 2];
                        return [4 /*yield*/, this.channel.stop()];
                    case 1:
                        _a.sent();
                        _a.label = 2;
                    case 2:
                        this._closed = true;
                        return [2 /*return*/];
                }
            });
        });
    };
    Object.defineProperty(MultipassNotifications.prototype, "muted", {
        /**
         * Returns if the notifications are muted or not
         */
        get: function () {
            return this._muted;
        },
        /**
         * Mutes the notifications
         */
        set: function (muted) {
            this._muted = muted;
            if (!this.channel) {
                return;
            }
            muted ? this.channel.mute() : this.channel.unmute();
        },
        enumerable: false,
        configurable: true
    });
    /**
     * Dispatches the given data by checking the last message id etc.
     * @param data the data to dispatch
     */
    MultipassNotifications.prototype.dispatchNotification = function (data) {
        if (data.sequenceNumber === undefined) {
            return this.emitNotification(data);
        }
        // Setup first message Id
        if (this.lastMessageId === null && !data.broadcast) {
            this.lastMessageId = data.sequenceNumber;
        }
        if (this.lastMessageBroadcastId === null && data.broadcast) {
            this.lastMessageBroadcastId = data.sequenceNumber;
        }
        // If old notification, bypass notification
        if (data.broadcast && data.sequenceNumber <= this.lastMessageBroadcastId) {
            return;
        }
        if (!data.broadcast && data.sequenceNumber <= this.lastMessageId) {
            return;
        }
        // Determine if there is a hole in notifications
        var shouldWait = (data.broadcast && data.sequenceNumber - this.lastMessageBroadcastId >= 2) ||
            (!data.broadcast && data.sequenceNumber - this.lastMessageId >= 2);
        if (shouldWait) {
            this._setupNotification(data);
            // Broadcast notifications
            if (this._pendingNotificationsBroadcast.length > 0) {
                this._shiftNotifications(this._pendingNotificationsBroadcast, this.lastMessageBroadcastId, "_timerBroadcastId");
            }
            // Private notifications
            if (this._pendingNotifications.length > 0) {
                this._shiftNotifications(this._pendingNotifications, this.lastMessageBroadcastId, "_timerId");
            }
            return;
        }
        // Emit
        this.emitNotification(data);
    };
    /**
     * Emits the given notification and updates the last message Id
     * for private messages and broadcasts
     * @param data the notification data
     */
    MultipassNotifications.prototype.emitNotification = function (data) {
        if (this.onMessage) {
            if (data.type === EMultipassNotificationType.TRANSACTION_EVENT) {
                this.game.com.populateNotifications(data.content);
                return;
            }
            if (data.sessionId !== undefined && this.game.session.id !== data.sessionId) {
                return;
            }
            if (data.sequenceNumber === undefined) {
                return this.onMessage(data);
            }
            // Update last message Id
            if (data.broadcast) {
                this.lastMessageBroadcastId = data.sequenceNumber;
            }
            else {
                this.lastMessageId = data.sequenceNumber;
            }
            this.onMessage(data);
        }
    };
    /**
     * Reset the notifications datas
     */
    MultipassNotifications.prototype.reset = function () {
        this.lastMessageId = null;
        this.lastMessageBroadcastId = null;
    };
    /**
     * Setups pending notifications (reset tempo, create tempo etc.)
     */
    MultipassNotifications.prototype._setupNotification = function (notification) {
        // Broadcast notification
        if (notification.broadcast) {
            return this._setupPendingNotifications(this._pendingNotificationsBroadcast, notification, "_timerBroadcastId");
        }
        return this._setupPendingNotifications(this._pendingNotifications, notification, "_timerId");
    };
    /**
     * Setups the pending notifications by adding the given notification to the pending
     * list. If the timer wasn't created, the timer is created
     */
    MultipassNotifications.prototype._setupPendingNotifications = function (notifications, notifiation, timerKey) {
        var _this = this;
        if (this[timerKey] === null) {
            // Create timer
            notifications.splice(0, notifications.length - 1);
            notifications.push(notifiation);
            this[timerKey] = setTimeout(function () { return __awaiter(_this, void 0, void 0, function () {
                return __generator(this, function (_a) {
                    switch (_a.label) {
                        case 0: 
                        // Update game session
                        return [4 /*yield*/, this._updateSession()];
                        case 1:
                            // Update game session
                            _a.sent();
                            this[timerKey] = null;
                            return [2 /*return*/];
                    }
                });
            }); }, MultipassNotifications.tempo);
        }
        else {
            // Add notification + sort
            notifications.push(notifiation);
            notifications.sort(function (a, b) { return a.sequenceNumber - b.sequenceNumber; });
        }
    };
    /**
     * Shifts all the pending notifications until we find a hole
     * in sequence number. If the count of pending notifications is equal
     * to 0, then the associated timer is cleared
     */
    MultipassNotifications.prototype._shiftNotifications = function (pendingNotifications, lastMessageId, timerKey) {
        // Emit until we find a hole in sequence number
        while (pendingNotifications.length &&
            pendingNotifications[0].sequenceNumber === lastMessageId + 1) {
            var notification = pendingNotifications.shift();
            this.emitNotification(notification);
        }
        // If empty, clear timeout to update session
        if (pendingNotifications.length === 0) {
            clearTimeout(this[timerKey]);
        }
    };
    // Updates the game session. This will mute the notifications
    MultipassNotifications.prototype._updateSession = function () {
        return __awaiter(this, void 0, void 0, function () {
            var notificationsWasMuted;
            return __generator(this, function (_a) {
                switch (_a.label) {
                    case 0:
                        notificationsWasMuted = this.game.notifications.muted;
                        this.game.notifications.muted = true;
                        return [4 /*yield*/, this.game.updateSession()];
                    case 1:
                        _a.sent();
                        // Then, unmute notifications
                        this.game.notifications.muted = notificationsWasMuted;
                        return [2 /*return*/];
                }
            });
        });
    };
    // Static members
    MultipassNotifications.tempo = 500;
    return MultipassNotifications;
}());



/***/ }),

/***/ "./src/game/multipass/session.ts":
/*!***************************************!*\
  !*** ./src/game/multipass/session.ts ***!
  \***************************************/
/*! exports provided: MultipassSession */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "MultipassSession", function() { return MultipassSession; });
var MultipassSession = /** @class */ (function () {
    /**
     * Constructor
     * @param response the "getSession" response JSON object.
     */
    function MultipassSession(response) {
        this.players = [];
        this.data = null;
        this.isInSession = false;
        if (response) {
            this.updateFrom(response);
        }
    }
    /**
     * Update the session from the given response
     * @param response the "getSession" response
     */
    MultipassSession.prototype.updateFrom = function (response) {
        this.id = response.id;
        var sessionData = response.data;
        var data = sessionData.data;
        this.data = data.public;
        this.players = data.players;
        this.timestamp = sessionData.time;
        this.playerGameSessionId = sessionData.playerGameSessionId;
        this.lastPlayerNotificationId = sessionData.lastPlayerNotificationId;
        this.lastGameSessionNotificationId = sessionData.lastGameSessionNotificationId;
        this.playerId = sessionData.playerId;
        this.totalUserInRoom = sessionData.totalUserInRoom;
        this.totalActivePlayerInRoom = sessionData.totalActivePlayerInRoom;
        this.roomId = sessionData.roomId;
        if (data.currentPlayer) {
            this.publicData = data.currentPlayer.public;
            this.protectedData = data.currentPlayer.protected;
            this.isInSession = true;
        }
    };
    return MultipassSession;
}());



/***/ }),

/***/ "./src/game/notifier/notifier.ts":
/*!***************************************!*\
  !*** ./src/game/notifier/notifier.ts ***!
  \***************************************/
/*! exports provided: Notifier */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Notifier", function() { return Notifier; });
/* harmony import */ var _gdk_core__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @gdk/core */ "@gdk/core");
/* harmony import */ var _gdk_core__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_gdk_core__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var _adaptativeVisualIdentity__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../adaptativeVisualIdentity */ "./src/adaptativeVisualIdentity/index.ts");


var Notifier = /** @class */ (function () {
    /**
     * Constructor.
     * @param game defines the reference to the game itself. Used to dispatch notifications across targeted components.
     */
    function Notifier(game) {
        this._game = game;
    }
    /**
     * Notifies the game that the purse information changed.
     * @param purseInformation defines the new purse information to display in the game.
     */
    Notifier.prototype.notifyPurseInformationChange = function (purseInformation) {
        if (purseInformation) {
            this._game.vi.emit(_adaptativeVisualIdentity__WEBPACK_IMPORTED_MODULE_1__["EVisualIdentityAction"].SetPurse, new _gdk_core__WEBPACK_IMPORTED_MODULE_0__["Amount"](purseInformation.displayedAmount));
        }
        else {
            this._game.getPurse(true);
        }
    };
    /**
     * Notifies the game that the sound status changed.
     * @param soundEnabled defines the sound status.
     */
    Notifier.prototype.notifySoundStatus = function (soundEnabled) {
        this._game.vi.emit(_adaptativeVisualIdentity__WEBPACK_IMPORTED_MODULE_1__["EVisualIdentityAction"].SoundEnabled, soundEnabled !== null && soundEnabled !== void 0 ? soundEnabled : false);
    };
    /**
     * Notifies the game about pause/resume status.
     * @param isPaused defines the pause/resume status.
     * @param reason reason the game is paused for
     */
    Notifier.prototype.notifyPause = function (message) {
        var isPaused = message.isPaused, reason = message.reason;
        if (isPaused) {
            this._game.pause("notifier_".concat(reason));
        }
        else {
            this._game.unpause("notifier_".concat(reason));
        }
    };
    return Notifier;
}());



/***/ }),

/***/ "./src/game/tweenUtils.ts":
/*!********************************!*\
  !*** ./src/game/tweenUtils.ts ***!
  \********************************/
/*! exports provided: TweenUtils */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* WEBPACK VAR INJECTION */(function(global) {/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "TweenUtils", function() { return TweenUtils; });
/* harmony import */ var gsap__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! gsap */ "gsap");
/* harmony import */ var gsap__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(gsap__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var _gdk_core_pixi__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @gdk/core-pixi */ "@gdk/core-pixi");
/* harmony import */ var _gdk_core_pixi__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(_gdk_core_pixi__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var howler__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! howler */ "howler");
/* harmony import */ var howler__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(howler__WEBPACK_IMPORTED_MODULE_2__);



var TweenUtils = /** @class */ (function () {
    function TweenUtils() {
    }
    Object.defineProperty(TweenUtils, "globalTimeScale", {
        /**
         * get the TweenMax global time scale.
         */
        get: function () {
            return gsap__WEBPACK_IMPORTED_MODULE_0__["TweenMax"].globalTimeScale();
        },
        /**
         * sets the TweenMax global time scale and apply that change to all Howler sounds speed rate.
         */
        set: function (value) {
            howler__WEBPACK_IMPORTED_MODULE_2__["Howler"]["_howls"].forEach(function (howl) {
                howl.rate(value);
            });
            gsap__WEBPACK_IMPORTED_MODULE_0__["TweenMax"].globalTimeScale(value);
        },
        enumerable: false,
        configurable: true
    });
    /**
     * Pauses all the active tweens
     * @param forcedPause whether or not the user forced the pause and will have to manually resume all
     */
    TweenUtils.pauseAllTweens = function (forcedPause) {
        var _this = this;
        if (forcedPause === void 0) { forcedPause = true; }
        if (this.pausedTweens.length !== 0) {
            return;
        }
        this._forcedPause = forcedPause;
        var tweens = gsap__WEBPACK_IMPORTED_MODULE_0__["TweenMax"].getAllTweens(true);
        tweens.forEach(function (tween) {
            // Delayed calls can be determined if the animated target is the callback itself.
            // If the tween is a delayed call, pause it.
            var isDelayedCall = (tween.vars.delay || 0) > 0 || tween.target === tween.vars.onComplete;
            if (!tween.paused() && (tween.isActive() || isDelayedCall)) {
                _this.pausedTweens.push(tween);
                tween.pause();
            }
        });
    };
    /**
     * Resumes all the given tweens (which was previously paused)
     * @param forcedResume whether or not the user forced the pause so should force resume to resume all tweens
     */
    TweenUtils.resumeAllTweens = function (forcedResume) {
        if (forcedResume === void 0) { forcedResume = true; }
        if (this._forcedPause && !forcedResume) {
            return;
        }
        this._forcedPause = false;
        this.pausedTweens.forEach(function (tween) { return tween.resume(); });
        this.pausedTweens = [];
    };
    /**
     * Pauses all tweens of the rules view
     */
    TweenUtils.pauseRulesTweens = function () {
        this.rulesTweens.forEach(function (t) {
            if (t instanceof _gdk_core_pixi__WEBPACK_IMPORTED_MODULE_1__["Timeline"]) {
                t.timeline.pause();
                t.animations.forEach(function (a) { return a.tween.pause(); });
            }
            else {
                t.pause();
            }
        });
    };
    /**
     * Resumes all the tweens of the rules view
     */
    TweenUtils.resumeRulesTweens = function () {
        this.rulesTweens.forEach(function (t) {
            if (t instanceof _gdk_core_pixi__WEBPACK_IMPORTED_MODULE_1__["Timeline"]) {
                t.timeline.resume();
                t.animations.forEach(function (a) { return a.tween.resume(); });
            }
            else {
                t.resume();
            }
        });
    };
    /**
     * Waits for the given duration before the promise is resolved.
     * @param duration the time to wait in seconds.
     */
    TweenUtils.wait = function (duration) {
        return new Promise(function (resolve) { return gsap__WEBPACK_IMPORTED_MODULE_0__["TweenMax"].delayedCall(duration, resolve); });
    };
    /**
     * Static method for creating a TweenMax instance that animates to the specified destination values (from the current values).
     * @param args the TweenMax.to arguments.
     * @returns only the promise resolved when tween has been completed.
     */
    TweenUtils.to = function () {
        var args = [];
        for (var _i = 0; _i < arguments.length; _i++) {
            args[_i] = arguments[_i];
        }
        return new Promise(function (resolve) {
            var onComplete = null;
            if (args[2].onComplete) {
                onComplete = args[2].onComplete;
            }
            args[2].onComplete = function () {
                if (onComplete) {
                    onComplete();
                }
                resolve();
            };
            gsap__WEBPACK_IMPORTED_MODULE_0__["TweenMax"].to.apply(global, args);
        });
    };
    /**
     * Static method for creating a TweenMax instance that allows you to define both the starting and ending
     * values (as opposed to to() and from() tweens which are based on the target's current values at one end or the other).
     * @param args the TweenMax.fromTo arguments.
     * @returns only the promise resolved when tween has been completed.
     */
    TweenUtils.fromTo = function () {
        var args = [];
        for (var _i = 0; _i < arguments.length; _i++) {
            args[_i] = arguments[_i];
        }
        return new Promise(function (resolve) {
            var onComplete = null;
            var vars = args[3]; // Due to bad types of Tween.d.ts :)
            if (vars.onComplete) {
                onComplete = vars.onComplete;
            }
            vars.onComplete = function () {
                if (onComplete) {
                    onComplete();
                }
                resolve();
            };
            gsap__WEBPACK_IMPORTED_MODULE_0__["TweenMax"].fromTo.apply(global, args);
        });
    };
    /**
     * Make a TweenMax / TimelineMax functions into a promise
     * @param anim: The anim data
     * @param includeDelay: Include delay when restarting the animation
     * @Return Promise which is resolved when TweenMax / TimelineMax animation is completed
     */
    TweenUtils.playTween = function (anim, includeDelay) {
        if (includeDelay === void 0) { includeDelay = false; }
        return new Promise(function (resolve) {
            anim.eventCallback("onComplete", resolve);
            anim.restart(includeDelay);
        });
    };
    /**
     * List of all paused tweens when calling TweenUtils.pauseAllTweens()
     */
    TweenUtils.pausedTweens = [];
    /**
     * List of spine timelines
     */
    TweenUtils.rulesTweens = [];
    TweenUtils._forcedPause = false;
    return TweenUtils;
}());


/* WEBPACK VAR INJECTION */}.call(this, __webpack_require__(/*! ./../../../../node_modules/webpack/buildin/global.js */ "../../node_modules/webpack/buildin/global.js")))

/***/ }),

/***/ "./src/game/ui/crossSell/crossSell.ts":
/*!********************************************!*\
  !*** ./src/game/ui/crossSell/crossSell.ts ***!
  \********************************************/
/*! exports provided: CrossSell */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "CrossSell", function() { return CrossSell; });
/* harmony import */ var gsap__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! gsap */ "gsap");
/* harmony import */ var gsap__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(gsap__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var pixi_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! pixi.js */ "pixi.js");
/* harmony import */ var pixi_js__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(pixi_js__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var _gdk_core_pixi__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @gdk/core-pixi */ "@gdk/core-pixi");
/* harmony import */ var _gdk_core_pixi__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(_gdk_core_pixi__WEBPACK_IMPORTED_MODULE_2__);
/* harmony import */ var _carousel__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../carousel */ "./src/game/carousel.ts");
/* harmony import */ var _tweenUtils__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../tweenUtils */ "./src/game/tweenUtils.ts");
var __extends = (undefined && undefined.__extends) || (function () {
    var extendStatics = function (d, b) {
        extendStatics = Object.setPrototypeOf ||
            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||
            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };
        return extendStatics(d, b);
    };
    return function (d, b) {
        if (typeof b !== "function" && b !== null)
            throw new TypeError("Class extends value " + String(b) + " is not a constructor or null");
        extendStatics(d, b);
        function __() { this.constructor = d; }
        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
    };
})();
var __assign = (undefined && undefined.__assign) || function () {
    __assign = Object.assign || function(t) {
        for (var s, i = 1, n = arguments.length; i < n; i++) {
            s = arguments[i];
            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))
                t[p] = s[p];
        }
        return t;
    };
    return __assign.apply(this, arguments);
};
var __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};
var __generator = (undefined && undefined.__generator) || function (thisArg, body) {
    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;
    return g = { next: verb(0), "throw": verb(1), "return": verb(2) }, typeof Symbol === "function" && (g[Symbol.iterator] = function() { return this; }), g;
    function verb(n) { return function (v) { return step([n, v]); }; }
    function step(op) {
        if (f) throw new TypeError("Generator is already executing.");
        while (g && (g = 0, op[0] && (_ = 0)), _) try {
            if (f = 1, y && (t = op[0] & 2 ? y["return"] : op[0] ? y["throw"] || ((t = y["return"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;
            if (y = 0, t) op = [op[0] & 2, t.value];
            switch (op[0]) {
                case 0: case 1: t = op; break;
                case 4: _.label++; return { value: op[1], done: false };
                case 5: _.label++; y = op[1]; op = [0]; continue;
                case 7: op = _.ops.pop(); _.trys.pop(); continue;
                default:
                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }
                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }
                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }
                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }
                    if (t[2]) _.ops.pop();
                    _.trys.pop(); continue;
            }
            op = body.call(thisArg, _);
        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }
        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };
    }
};





var CrossSell = /** @class */ (function (_super) {
    __extends(CrossSell, _super);
    /* LIFECYCLE */
    /**
     * @constructor
     * @param game - The reference to the game
     */
    function CrossSell(game, options) {
        if (options === void 0) { options = {}; }
        var _this = _super.call(this) || this;
        _this.game = game;
        /**
         * Force animation to be stopped
         */
        _this._animationStopped = false;
        /**
         * Disable the carousel interactivity
         */
        _this._carouselDisabled = false;
        /**
         * Create a wave animation base on the "idleLoop" animation of all cards
         */
        _this.playIdleWaveAnimation = function () { return __awaiter(_this, void 0, void 0, function () {
            var animationIsStopped, isSimpleMode, waitTimings, activeCard, orderCards, cardAnimation;
            var _this = this;
            return __generator(this, function (_a) {
                switch (_a.label) {
                    case 0:
                        animationIsStopped = (this._animationStopped = false);
                        isSimpleMode = this.carousel.isSimpleMode();
                        waitTimings = this.carousel.computeArray([0, 0.5, 1]);
                        activeCard = this.carousel.getActiveCard();
                        orderCards = this.carousel.getCards();
                        cardAnimation = function (card, animation, wait) {
                            if (wait === void 0) { wait = 0; }
                            return __awaiter(_this, void 0, void 0, function () {
                                return __generator(this, function (_a) {
                                    switch (_a.label) {
                                        case 0:
                                            if (!(wait > 0)) return [3 /*break*/, 2];
                                            return [4 /*yield*/, _tweenUtils__WEBPACK_IMPORTED_MODULE_4__["TweenUtils"].wait(wait)];
                                        case 1:
                                            _a.sent();
                                            _a.label = 2;
                                        case 2:
                                            animationIsStopped = this._animationStopped || animationIsStopped;
                                            return [2 /*return*/, !animationIsStopped && card.playDirect(animation)];
                                    }
                                });
                            });
                        };
                        return [4 /*yield*/, Promise.all(orderCards.map(function (card, i) {
                                cardAnimation(card, card === activeCard || isSimpleMode
                                    ? _this.options.idleLoopAnimation
                                    : _this.options.idleLoopBackAnimation, waitTimings[i]);
                            }))];
                    case 1:
                        _a.sent();
                        return [2 /*return*/];
                }
            });
        }); };
        _this.options = __assign(__assign({}, options), { mainCardName: options.mainCardName || "mainCard", defaultSpineTimelineButtonId: options.defaultSpineTimelineButtonId || "99_crosssell.json", upAnimation: options.upAnimation || "up", outAnimation: options.outAnimation || "out", overAnimation: options.overAnimation || "over", downAnimation: options.downAnimation || "down", enterAnimation: options.enterAnimation || "enter", idleLoopAnimation: options.idleLoopAnimation || "idleLoop", enterBackAnimation: options.enterBackAnimation || "back_enter", frontToBackAnimation: options.frontToBackAnimation || "front_to_back", backToFrontAnimation: options.backToFrontAnimation || "back_to_front", idleLoopBackAnimation: options.idleLoopBackAnimation || "idleLoop_back" });
        return _this;
    }
    /**
     * On Loaded
     */
    CrossSell.prototype.onLoaded = function () {
        this.cards = this.children.filter(function (child) { return child.visible; });
        this.mainCard = this.getChildByName(this.options.mainCardName);
        this.playButton = this.mainCard.getSlotContainerByName("button").getChildByName("playButton");
    };
    /* METHODS */
    /**
     * Create a card in the card container
     * @param options - Options to pass to the card container
     */
    CrossSell.prototype.createCard = function (option) {
        var _this = this;
        var card = new _gdk_core_pixi__WEBPACK_IMPORTED_MODULE_2__["SpineTimelineButton"](option.spineTimelineButtonId || this.options.defaultSpineTimelineButtonId, { default: {} });
        if (option.skinName) {
            card.setSkinByName(option.skinName);
        }
        card.animationsNames.up = this.options.upAnimation;
        card.animationsNames.out = this.options.outAnimation;
        card.animationsNames.over = this.options.overAnimation;
        card.animationsNames.down = this.options.downAnimation;
        card.animationsNames.enter = this.options.enterAnimation;
        card.animationsNames.idleLoop = this.options.idleLoopAnimation;
        card.docking = new _gdk_core_pixi__WEBPACK_IMPORTED_MODULE_2__["Docking"](_gdk_core_pixi__WEBPACK_IMPORTED_MODULE_2__["Docking"].centerAll, 0, 0);
        this.cards.push(card);
        this.addChildAt(card, 0);
        card.on("pointerover", function () { return _this.stopIdleWaveAnimation(); });
        card.on("pointerout", function () { return _this.startTimeoutIdleWave(); });
        return card;
    };
    /**
     * Initialize the carousel
     * @param options - Options of the carousel
     */
    CrossSell.prototype.initializeCarousel = function (options) {
        var _this = this;
        if (options === void 0) { options = {}; }
        this.carousel = new _carousel__WEBPACK_IMPORTED_MODULE_3__["Carousel"]({
            game: this.game,
            container: this,
            nextArrow: options.nextArrow,
            previousArrow: options.previousArrow,
        }, options.settings);
        var isSimpleMode = this.carousel.isSimpleMode();
        this.carousel
            .getCards()
            .forEach(function (card) { return (card.interactive = isSimpleMode && card !== _this.mainCard); });
        // Events
        this.carousel.on("beforeChangeCard", function (nextCard, previousCard) {
            if (previousCard) {
                previousCard.interactive = false;
                if (previousCard === _this.mainCard) {
                    _this.playButton.interactive = false;
                }
                previousCard.playDirect(_this.options.frontToBackAnimation);
            }
            _this.stopIdleWaveAnimation();
            nextCard.playDirect(_this.options.backToFrontAnimation);
        });
        this.carousel.on("changeCard", function (nextCard) {
            nextCard.interactive = nextCard instanceof _gdk_core_pixi__WEBPACK_IMPORTED_MODULE_2__["SpineTimelineButton"] && nextCard !== _this.mainCard;
            _this.playButton.interactive = nextCard === _this.mainCard;
            _this.startTimeoutIdleWave();
        });
        this.carousel.on("cardPositionsUpdate", function () {
            if (_this.isCarouselDisabled()) {
                _this.disableCarousel();
            }
        });
    };
    /**
     * Appear the cross sell
     */
    CrossSell.prototype.appear = function () {
        return __awaiter(this, void 0, void 0, function () {
            var arrows, timeline, promises;
            var _this = this;
            return __generator(this, function (_a) {
                switch (_a.label) {
                    case 0:
                        arrows = [this.carousel.previousArrow, this.carousel.nextArrow].filter(function (container) { return Boolean(container); });
                        timeline = new gsap__WEBPACK_IMPORTED_MODULE_0__["TimelineMax"]({ paused: true });
                        this.carousel.setActiveCard(this.mainCard, true);
                        arrows.forEach(function (arrow) {
                            arrow.alpha = 0;
                            arrow.visible = false;
                            timeline.add(gsap__WEBPACK_IMPORTED_MODULE_0__["TweenMax"].fromTo(arrow, 0.7, {
                                alpha: 0,
                            }, {
                                alpha: 1,
                                onStart: function () { return (arrow.visible = true); },
                            }), 0);
                        });
                        return [4 /*yield*/, _tweenUtils__WEBPACK_IMPORTED_MODULE_4__["TweenUtils"].wait(0.5)];
                    case 1:
                        _a.sent();
                        promises = this.cards.map(function (card) {
                            var isActive = _this.carousel.isSimpleMode()
                                ? true
                                : card === _this.carousel.getActiveCard();
                            return card.playDirect(isActive ? "enter" : "back_enter");
                        });
                        this.visible = true;
                        if (!(this.carousel.getCards().length > 2)) return [3 /*break*/, 3];
                        promises.push(_tweenUtils__WEBPACK_IMPORTED_MODULE_4__["TweenUtils"].playTween(timeline));
                        return [4 /*yield*/, Promise.all(promises)];
                    case 2:
                        _a.sent();
                        _a.label = 3;
                    case 3:
                        this.interactive = true;
                        this.enableCarousel();
                        this.startTimeoutIdleWave();
                        return [2 /*return*/];
                }
            });
        });
    };
    /**
     * Disappear animation of the cross sell
     */
    CrossSell.prototype.disappear = function () {
        this.visible = false;
        this.stopIdleWaveAnimation();
    };
    /**
     * Disable carousel interactivity
     */
    CrossSell.prototype.disableCarousel = function () {
        this._carouselDisabled = true;
        this.interactive = false;
        this.carousel.isDragging = false;
        this.carousel.setButtonActive(false);
        this.carousel.getCards().forEach(function (card) {
            card.interactive = false;
        });
        this.stopIdleWaveAnimation();
    };
    /**
     * Enable the carousel
     */
    CrossSell.prototype.enableCarousel = function () {
        this._carouselDisabled = false;
        this.interactive = true;
        this.carousel.setButtonActive(true);
        if (this.carousel.getCards().length === 2) {
            this.carousel.getCards().forEach(function (card) {
                card.interactive = true;
            });
        }
    };
    /**
     * Stop the IdleWave animation of the main card
     */
    CrossSell.prototype.stopIdleWaveAnimation = function () {
        if (this.tweenIdleWave) {
            this.tweenIdleWave.kill();
        }
        this._animationStopped = true;
    };
    /**
     * Create a timer to restart the idle wave animation
     */
    CrossSell.prototype.startTimeoutIdleWave = function () {
        this.stopIdleWaveAnimation();
        this.tweenIdleWave = gsap__WEBPACK_IMPORTED_MODULE_0__["TweenMax"].fromTo(this, 2, { idleWaveTiming: 0 }, {
            repeat: -1,
            idleWaveTiming: 2,
            onRepeat: this.playIdleWaveAnimation,
        });
    };
    /* GETTERS */
    /**
     * Returns true if the carousel should be disabled
     */
    CrossSell.prototype.isCarouselDisabled = function () {
        return this._carouselDisabled;
    };
    return CrossSell;
}(pixi_js__WEBPACK_IMPORTED_MODULE_1__["Container"]));



/***/ }),

/***/ "./src/game/ui/game/timer.ts":
/*!***********************************!*\
  !*** ./src/game/ui/game/timer.ts ***!
  \***********************************/
/*! exports provided: Timer */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Timer", function() { return Timer; });
/* harmony import */ var pixi_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! pixi.js */ "pixi.js");
/* harmony import */ var pixi_js__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(pixi_js__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var gsap__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! gsap */ "gsap");
/* harmony import */ var gsap__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(gsap__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var i18next__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! i18next */ "i18next");
/* harmony import */ var i18next__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(i18next__WEBPACK_IMPORTED_MODULE_2__);
var __extends = (undefined && undefined.__extends) || (function () {
    var extendStatics = function (d, b) {
        extendStatics = Object.setPrototypeOf ||
            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||
            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };
        return extendStatics(d, b);
    };
    return function (d, b) {
        if (typeof b !== "function" && b !== null)
            throw new TypeError("Class extends value " + String(b) + " is not a constructor or null");
        extendStatics(d, b);
        function __() { this.constructor = d; }
        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
    };
})();
var __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};
var __generator = (undefined && undefined.__generator) || function (thisArg, body) {
    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;
    return g = { next: verb(0), "throw": verb(1), "return": verb(2) }, typeof Symbol === "function" && (g[Symbol.iterator] = function() { return this; }), g;
    function verb(n) { return function (v) { return step([n, v]); }; }
    function step(op) {
        if (f) throw new TypeError("Generator is already executing.");
        while (g && (g = 0, op[0] && (_ = 0)), _) try {
            if (f = 1, y && (t = op[0] & 2 ? y["return"] : op[0] ? y["throw"] || ((t = y["return"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;
            if (y = 0, t) op = [op[0] & 2, t.value];
            switch (op[0]) {
                case 0: case 1: t = op; break;
                case 4: _.label++; return { value: op[1], done: false };
                case 5: _.label++; y = op[1]; op = [0]; continue;
                case 7: op = _.ops.pop(); _.trys.pop(); continue;
                default:
                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }
                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }
                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }
                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }
                    if (t[2]) _.ops.pop();
                    _.trys.pop(); continue;
            }
            op = body.call(thisArg, _);
        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }
        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };
    }
};



var Timer = /** @class */ (function (_super) {
    __extends(Timer, _super);
    function Timer() {
        var _this = _super !== null && _super.apply(this, arguments) || this;
        /**
         * timer text with the countdown
         */
        _this.timerText = null;
        /**
         * "game canceled after" text
         */
        _this.txt = null;
        /**
         * "let's go!" text
         */
        _this.txtGo = null;
        return _this;
    }
    Object.defineProperty(Timer.prototype, "startTime", {
        /**
         * Set the starting time in seconds
         * @param time in seconds
         */
        set: function (time) {
            this._startTime = time;
            this.timerText.visible = true;
            this.timerText.text = Math.floor(time).toString();
        },
        enumerable: false,
        configurable: true
    });
    Object.defineProperty(Timer.prototype, "key", {
        /**
         * Set the formating string key (count var used for time display)
         * @param key the i18n key
         */
        set: function (key) {
            this._key = key;
        },
        enumerable: false,
        configurable: true
    });
    /**
     * Start the timer
     * @param time, optional, set the start time in seconds
     */
    Timer.prototype.start = function (time) {
        return __awaiter(this, void 0, void 0, function () {
            var _this = this;
            return __generator(this, function (_a) {
                if (time) {
                    this.startTime = time;
                }
                this.reset();
                this.timerText.visible = true;
                this.time = this._startTime;
                this.tweenPromise = new Promise(function (solve) {
                    _this.tween = gsap__WEBPACK_IMPORTED_MODULE_1__["TweenMax"].to(_this, time, {
                        time: 0,
                        ease: gsap__WEBPACK_IMPORTED_MODULE_1__["Linear"].easeNone,
                        onUpdate: function () {
                            if (_this._key) {
                                _this.timerText.text = i18next__WEBPACK_IMPORTED_MODULE_2__["t"](_this._key, { count: Math.floor(_this.time) });
                            }
                            else {
                                _this.timerText.text = Math.floor(_this.time).toString(10);
                            }
                        },
                        onComplete: solve,
                    });
                });
                return [2 /*return*/];
            });
        });
    };
    /**
     * Reset the timer to the startTime without start
     */
    Timer.prototype.reset = function () {
        this.startTime = this._startTime;
        if (this.tween) {
            this.tween.kill();
        }
    };
    /**
     * Pause the timer
     */
    Timer.prototype.pause = function () {
        this.tween.pause();
    };
    /**
     * Unpause the timer
     */
    Timer.prototype.unpause = function () {
        return __awaiter(this, void 0, void 0, function () {
            return __generator(this, function (_a) {
                switch (_a.label) {
                    case 0:
                        this.tween.play();
                        return [4 /*yield*/, this.tweenPromise];
                    case 1:
                        _a.sent();
                        return [2 /*return*/];
                }
            });
        });
    };
    return Timer;
}(pixi_js__WEBPACK_IMPORTED_MODULE_0__["Container"]));



/***/ }),

/***/ "./src/game/ui/home/home.ts":
/*!**********************************!*\
  !*** ./src/game/ui/home/home.ts ***!
  \**********************************/
/*! exports provided: Home */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Home", function() { return Home; });
/* harmony import */ var pixi_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! pixi.js */ "pixi.js");
/* harmony import */ var pixi_js__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(pixi_js__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var _gdk_core_pixi__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @gdk/core-pixi */ "@gdk/core-pixi");
/* harmony import */ var _gdk_core_pixi__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(_gdk_core_pixi__WEBPACK_IMPORTED_MODULE_1__);
var __extends = (undefined && undefined.__extends) || (function () {
    var extendStatics = function (d, b) {
        extendStatics = Object.setPrototypeOf ||
            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||
            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };
        return extendStatics(d, b);
    };
    return function (d, b) {
        if (typeof b !== "function" && b !== null)
            throw new TypeError("Class extends value " + String(b) + " is not a constructor or null");
        extendStatics(d, b);
        function __() { this.constructor = d; }
        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
    };
})();


var Home = /** @class */ (function (_super) {
    __extends(Home, _super);
    /**
     * Constructor
     * @param config The home style
     */
    function Home(config) {
        var _this = 
        // PIXI.Container
        _super.call(this) || this;
        // Game name
        if (typeof config.gameName === "string") {
            // We should build the sprite
            _this.gameName = pixi_js__WEBPACK_IMPORTED_MODULE_0__["Sprite"].fromFrame(config.gameName);
            _this.gameName.pivot.x = _this.gameName.texture.width / 2;
            _this.gameName.pivot.y = _this.gameName.texture.height / 2;
            _this.gameName.docking = new _gdk_core_pixi__WEBPACK_IMPORTED_MODULE_1__["Docking"](_gdk_core_pixi__WEBPACK_IMPORTED_MODULE_1__["Docking"].centerAll);
        }
        else if (config.gameName instanceof pixi_js__WEBPACK_IMPORTED_MODULE_0__["Container"]) {
            // It is a sprite
            _this.gameName = config.gameName;
        }
        else {
            // Should be a textfield
            _this.gameName = new _gdk_core_pixi__WEBPACK_IMPORTED_MODULE_1__["TextArea"](config.gameName.text || "", config.gameName.styles, {
                align: _gdk_core_pixi__WEBPACK_IMPORTED_MODULE_1__["EAlign"].Center,
            });
            _this.gameName.docking = new _gdk_core_pixi__WEBPACK_IMPORTED_MODULE_1__["Docking"](_gdk_core_pixi__WEBPACK_IMPORTED_MODULE_1__["Docking"].centerAll);
        }
        _this.addChild(_this.gameName);
        // Claim
        if (typeof config.claim === "string") {
            // We should build the sprite
            _this.claim = pixi_js__WEBPACK_IMPORTED_MODULE_0__["Sprite"].fromFrame(config.claim);
            _this.claim.docking = new _gdk_core_pixi__WEBPACK_IMPORTED_MODULE_1__["Docking"](_gdk_core_pixi__WEBPACK_IMPORTED_MODULE_1__["Docking"].centerAll);
        }
        else if (config.claim instanceof pixi_js__WEBPACK_IMPORTED_MODULE_0__["Container"]) {
            // It is a sprite
            _this.claim = config.claim;
        }
        else {
            // Should be a textfield
            _this.claim = new _gdk_core_pixi__WEBPACK_IMPORTED_MODULE_1__["TextArea"](config.claim.text || "", config.claim.styles, {
                align: _gdk_core_pixi__WEBPACK_IMPORTED_MODULE_1__["EAlign"].Center,
            });
            _this.claim.docking = new _gdk_core_pixi__WEBPACK_IMPORTED_MODULE_1__["Docking"](_gdk_core_pixi__WEBPACK_IMPORTED_MODULE_1__["Docking"].centerAll);
        }
        _this.addChild(_this.claim);
        // Button
        if (config.playButton instanceof _gdk_core_pixi__WEBPACK_IMPORTED_MODULE_1__["Button"]) {
            _this.playButton = config.playButton;
        }
        else {
            _this.playButton = new _gdk_core_pixi__WEBPACK_IMPORTED_MODULE_1__["Button"](config.playButton.style, config.playButton.text.styles, config.playButton.text.text);
            _this.playButton.docking = new _gdk_core_pixi__WEBPACK_IMPORTED_MODULE_1__["Docking"](_gdk_core_pixi__WEBPACK_IMPORTED_MODULE_1__["Docking"].centerAll);
        }
        // Because of tracking, the play button must always have the same name, so we force the name
        _this.playButton.setName("play");
        _this.addChild(_this.playButton);
        // Placing elements
        _this.gameName.docking.y = -_this.claim.height / 2 - _this.gameName.height / 2 - 35;
        _this.playButton.docking.y =
            _this.claim.height / 2 + _this.playButton.background.texture.height / 2 + 35;
        return _this;
    }
    return Home;
}(pixi_js__WEBPACK_IMPORTED_MODULE_0__["Container"]));



/***/ }),

/***/ "./src/game/ui/index.ts":
/*!******************************!*\
  !*** ./src/game/ui/index.ts ***!
  \******************************/
/*! exports provided: Rules, Slide, TextSlide, ELayout, BaseSlide, AgreementSlide, Home, ResultBox, EResultBoxEvents, ResultStage, ScratchStage, TextResultStage, AmountResultStage, Timer, CrossSell */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _rules__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./rules */ "./src/game/ui/rules/index.ts");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "Rules", function() { return _rules__WEBPACK_IMPORTED_MODULE_0__["Rules"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "Slide", function() { return _rules__WEBPACK_IMPORTED_MODULE_0__["Slide"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "TextSlide", function() { return _rules__WEBPACK_IMPORTED_MODULE_0__["TextSlide"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "ELayout", function() { return _rules__WEBPACK_IMPORTED_MODULE_0__["ELayout"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "BaseSlide", function() { return _rules__WEBPACK_IMPORTED_MODULE_0__["BaseSlide"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "AgreementSlide", function() { return _rules__WEBPACK_IMPORTED_MODULE_0__["AgreementSlide"]; });

/* harmony import */ var _home_home__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./home/home */ "./src/game/ui/home/home.ts");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "Home", function() { return _home_home__WEBPACK_IMPORTED_MODULE_1__["Home"]; });

/* harmony import */ var _result__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./result */ "./src/game/ui/result/index.ts");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "ResultBox", function() { return _result__WEBPACK_IMPORTED_MODULE_2__["ResultBox"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "EResultBoxEvents", function() { return _result__WEBPACK_IMPORTED_MODULE_2__["EResultBoxEvents"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "ResultStage", function() { return _result__WEBPACK_IMPORTED_MODULE_2__["ResultStage"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "ScratchStage", function() { return _result__WEBPACK_IMPORTED_MODULE_2__["ScratchStage"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "TextResultStage", function() { return _result__WEBPACK_IMPORTED_MODULE_2__["TextResultStage"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "AmountResultStage", function() { return _result__WEBPACK_IMPORTED_MODULE_2__["AmountResultStage"]; });

/* harmony import */ var _game_timer__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./game/timer */ "./src/game/ui/game/timer.ts");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "Timer", function() { return _game_timer__WEBPACK_IMPORTED_MODULE_3__["Timer"]; });

/* harmony import */ var _crossSell_crossSell__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./crossSell/crossSell */ "./src/game/ui/crossSell/crossSell.ts");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "CrossSell", function() { return _crossSell_crossSell__WEBPACK_IMPORTED_MODULE_4__["CrossSell"]; });








/***/ }),

/***/ "./src/game/ui/result/amountCoinWizzStage.ts":
/*!***************************************************!*\
  !*** ./src/game/ui/result/amountCoinWizzStage.ts ***!
  \***************************************************/
/*! exports provided: AmountCoinWizzStage */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "AmountCoinWizzStage", function() { return AmountCoinWizzStage; });
/* harmony import */ var pixi_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! pixi.js */ "pixi.js");
/* harmony import */ var pixi_js__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(pixi_js__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var _gdk_core_pixi__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @gdk/core-pixi */ "@gdk/core-pixi");
/* harmony import */ var _gdk_core_pixi__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(_gdk_core_pixi__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var _gdk_core__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @gdk/core */ "@gdk/core");
/* harmony import */ var _gdk_core__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(_gdk_core__WEBPACK_IMPORTED_MODULE_2__);
/* harmony import */ var gsap__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! gsap */ "gsap");
/* harmony import */ var gsap__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(gsap__WEBPACK_IMPORTED_MODULE_3__);
/* harmony import */ var howler__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! howler */ "howler");
/* harmony import */ var howler__WEBPACK_IMPORTED_MODULE_4___default = /*#__PURE__*/__webpack_require__.n(howler__WEBPACK_IMPORTED_MODULE_4__);
/* harmony import */ var _resultStage__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./resultStage */ "./src/game/ui/result/resultStage.ts");
/* harmony import */ var _resultBox__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./resultBox */ "./src/game/ui/result/resultBox.ts");
/* harmony import */ var _adaptativeVisualIdentity__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../../adaptativeVisualIdentity */ "./src/adaptativeVisualIdentity/index.ts");
var __extends = (undefined && undefined.__extends) || (function () {
    var extendStatics = function (d, b) {
        extendStatics = Object.setPrototypeOf ||
            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||
            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };
        return extendStatics(d, b);
    };
    return function (d, b) {
        if (typeof b !== "function" && b !== null)
            throw new TypeError("Class extends value " + String(b) + " is not a constructor or null");
        extendStatics(d, b);
        function __() { this.constructor = d; }
        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
    };
})();
var __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};
var __generator = (undefined && undefined.__generator) || function (thisArg, body) {
    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;
    return g = { next: verb(0), "throw": verb(1), "return": verb(2) }, typeof Symbol === "function" && (g[Symbol.iterator] = function() { return this; }), g;
    function verb(n) { return function (v) { return step([n, v]); }; }
    function step(op) {
        if (f) throw new TypeError("Generator is already executing.");
        while (g && (g = 0, op[0] && (_ = 0)), _) try {
            if (f = 1, y && (t = op[0] & 2 ? y["return"] : op[0] ? y["throw"] || ((t = y["return"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;
            if (y = 0, t) op = [op[0] & 2, t.value];
            switch (op[0]) {
                case 0: case 1: t = op; break;
                case 4: _.label++; return { value: op[1], done: false };
                case 5: _.label++; y = op[1]; op = [0]; continue;
                case 7: op = _.ops.pop(); _.trys.pop(); continue;
                default:
                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }
                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }
                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }
                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }
                    if (t[2]) _.ops.pop();
                    _.trys.pop(); continue;
            }
            op = body.call(thisArg, _);
        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }
        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };
    }
};








var AmountCoinWizzStage = /** @class */ (function (_super) {
    __extends(AmountCoinWizzStage, _super);
    /**
     * Constructor
     */
    function AmountCoinWizzStage(config) {
        var _this = _super.call(this) || this;
        _this._amount = new _gdk_core_pixi__WEBPACK_IMPORTED_MODULE_1__["TextArea"]("+100", config.amountStyle);
        _this._amount.keepCanvasReference = true; // Performances, keep canvas reference to avoid re-creating a canvas each update.
        _this._amount.docking = new _gdk_core_pixi__WEBPACK_IMPORTED_MODULE_1__["Docking"](_gdk_core_pixi__WEBPACK_IMPORTED_MODULE_1__["Docking"].centerAll);
        _this._amount.wordWrap = true;
        _this._amount.align = _gdk_core_pixi__WEBPACK_IMPORTED_MODULE_1__["EAlign"].Center;
        _this._amount.width = 240;
        _this._amount.docking.x = -15;
        _this._amount.docking.y = 292;
        _this._amount.scaleXY = 1;
        // Sounds
        config.sounds = config.sounds || {};
        if (typeof config.sounds.loser === "string") {
            _this._loseSound = _gdk_core__WEBPACK_IMPORTED_MODULE_2__["Loader"].get(config.sounds.loser);
        }
        else if (config.sounds.loser instanceof howler__WEBPACK_IMPORTED_MODULE_4__["Howl"]) {
            _this._loseSound = config.sounds.loser;
        }
        if (typeof config.sounds.winner === "string") {
            _this._winSound = _gdk_core__WEBPACK_IMPORTED_MODULE_2__["Loader"].get(config.sounds.winner);
        }
        else if (config.sounds.winner instanceof howler__WEBPACK_IMPORTED_MODULE_4__["Howl"]) {
            _this._winSound = config.sounds.winner;
        }
        if (typeof config.sounds.incrementation === "string") {
            _this._incrementationSound = _gdk_core__WEBPACK_IMPORTED_MODULE_2__["Loader"].get(config.sounds.incrementation);
        }
        else if (config.sounds.incrementation instanceof howler__WEBPACK_IMPORTED_MODULE_4__["Howl"]) {
            _this._incrementationSound = config.sounds.incrementation;
        }
        config.winnerDuration = config.winnerDuration || 6;
        config.loserDuration = config.loserDuration || 4;
        // animations
        config.animationSpine = config.animationSpine || {};
        // winning Animation
        if (config.animationSpine.winner instanceof _gdk_core_pixi__WEBPACK_IMPORTED_MODULE_1__["SpineTimeline"]) {
            _this._winAnimation = config.animationSpine.winner;
        }
        else {
            // instanciate a new spineTimeline
            if (typeof config.animationSpine.winner === "string") {
                _this._winAnimation = new _gdk_core_pixi__WEBPACK_IMPORTED_MODULE_1__["SpineTimeline"](config.animationSpine.winner);
            }
            else {
                _this._winAnimation = new _gdk_core_pixi__WEBPACK_IMPORTED_MODULE_1__["SpineTimeline"]("result_win.json");
            }
            _this._winAnimation.docking = new _gdk_core_pixi__WEBPACK_IMPORTED_MODULE_1__["Docking"](_gdk_core_pixi__WEBPACK_IMPORTED_MODULE_1__["Docking"].centerAll);
            _this._winAnimation.docking.x = -38;
            _this._winAnimation.docking.y = -140;
            _this._winAnimation.pivot.x = 651;
            _this._winAnimation.pivot.y = 614;
        }
        _this._winAnimation.visible = false;
        _this.addChild(_this._winAnimation);
        // lost animation
        if (config.animationSpine.loser instanceof _gdk_core_pixi__WEBPACK_IMPORTED_MODULE_1__["SpineTimeline"]) {
            _this._lostAnimation = config.animationSpine.loser;
        }
        else {
            // instanciate a new spineTimeline
            if (typeof config.animationSpine.loser === "string") {
                _this._lostAnimation = new _gdk_core_pixi__WEBPACK_IMPORTED_MODULE_1__["SpineTimeline"](config.animationSpine.loser);
            }
            else {
                _this._lostAnimation = new _gdk_core_pixi__WEBPACK_IMPORTED_MODULE_1__["SpineTimeline"]("result_lost.json");
            }
            _this._lostAnimation.docking = new _gdk_core_pixi__WEBPACK_IMPORTED_MODULE_1__["Docking"](_gdk_core_pixi__WEBPACK_IMPORTED_MODULE_1__["Docking"].centerAll);
            _this._lostAnimation.docking.x = 0;
            _this._lostAnimation.docking.y = 0;
            _this._lostAnimation.pivot.x = 288;
            _this._lostAnimation.pivot.y = 288;
            _this._lostAnimation.scaleXY = 1.1;
        }
        _this._lostAnimation.visible = false;
        _this.addChild(_this._lostAnimation);
        _this.addChild(_this._amount);
        // coin animation
        if (config.hasCoinsAnimation) {
            var mustSetCoins = true;
            if (config.animationSpine.coin instanceof _gdk_core_pixi__WEBPACK_IMPORTED_MODULE_1__["SpineTimeline"]) {
                _this._coinAnimation = config.animationSpine.coin;
                mustSetCoins = false;
            }
            else if (typeof config.animationSpine.coin === "string") {
                _this._coinAnimation = new _gdk_core_pixi__WEBPACK_IMPORTED_MODULE_1__["SpineTimeline"](config.animationSpine.coin);
            }
            else {
                // standard animation
                _this._coinAnimation = new _gdk_core_pixi__WEBPACK_IMPORTED_MODULE_1__["SpineTimeline"]("result_win_coin.json");
            }
            if (mustSetCoins) {
                // a new SpineTimeline was created, must set it
                _this._coinAnimation.docking = new _gdk_core_pixi__WEBPACK_IMPORTED_MODULE_1__["Docking"](_gdk_core_pixi__WEBPACK_IMPORTED_MODULE_1__["Docking"].centerAll);
                _this._coinAnimation.pivot.x = _this._coinAnimation.width / 2;
                _this._coinAnimation.pivot.y = _this._coinAnimation.height / 2;
                _this._coinAnimation.docking.x = 0;
                _this._coinAnimation.docking.y = 0;
            }
            _this.coinsContainer = new pixi_js__WEBPACK_IMPORTED_MODULE_0__["Container"]();
            _this.coinsContainer.dockingBounds = new _gdk_core_pixi__WEBPACK_IMPORTED_MODULE_1__["DockingBounds"](576, 1024);
            _this.coinsContainer.docking = new _gdk_core_pixi__WEBPACK_IMPORTED_MODULE_1__["Docking"](_gdk_core_pixi__WEBPACK_IMPORTED_MODULE_1__["Docking"].centerAll);
            _this.coinsContainer.docking.x = 0;
            _this.coinsContainer.docking.y = 0;
            _this._coins = [];
            for (var i = 0; i < 10; i++) {
                _this._coins[i] = _this._coinAnimation.clone();
                _this.coinsContainer.addChild(_this._coins[i]);
            }
            _this.addChild(_this.coinsContainer);
        }
        // Misc.
        config.game.vi.emitter.emit(_adaptativeVisualIdentity__WEBPACK_IMPORTED_MODULE_7__["EVisualIdentityAction"].WizzGetPursesContainers, function (containers) {
            _this.purse = containers.standard;
        });
        _this.config = config;
        _this.dockAsPoint = true;
        _this.visible = false;
        return _this;
    }
    /**
     * On show the result box
     * @param box the result box reference
     * @param done the callback to call when stage animation done
     */
    AmountCoinWizzStage.prototype.onShow = function (box, done) {
        var _this = this;
        if (box.amount.value === 0) {
            // Looser
            this._winAnimation.visible = false;
            this._lostAnimation.visible = false;
            this.coinsContainer.visible = false;
            this._amount.visible = false;
            this._amount.docking.x = -13;
            this._amount.docking.y = 209;
            // texts
            this._amount.text = "0";
            // sounds
            if (this._loseSound) {
                this._loseSound.play();
            }
            // animations
            (function () { return __awaiter(_this, void 0, void 0, function () {
                var _this = this;
                return __generator(this, function (_a) {
                    switch (_a.label) {
                        case 0:
                            this._lostAnimation.on(_gdk_core_pixi__WEBPACK_IMPORTED_MODULE_1__["ESpineTimelineEvent"].Start, function () {
                                _this._lostAnimation.visible = true;
                                _this._amount.visible = true;
                            });
                            return [4 /*yield*/, this._lostAnimation.playDirect("enter")];
                        case 1:
                            _a.sent();
                            return [4 /*yield*/, this._lostAnimation.playDirect("idle")];
                        case 2:
                            _a.sent();
                            this._amount.visible = false;
                            this._lostAnimation.visible = false;
                            return [2 /*return*/];
                    }
                });
            }); })();
        }
        else {
            // Winner
            // @TODO
            this._winAnimation.visible = true;
            this._lostAnimation.visible = false;
            this.coinsContainer.visible = true;
            this._amount.docking.x = -15;
            this._amount.docking.y = 292;
            // texts
            this._amount.text = "+ ".concat(box.amount.value);
            // sounds
            if (this._winSound) {
                this._winSound.play();
            }
            // animations
            // coins animations
            if (this.config.hasCoinsAnimation) {
                // set coins to default
                for (var i = 0; i < this._coins.length; i++) {
                    var element = this._coins[i];
                    element.docking.x = AmountCoinWizzStage.coinsPosition[i].x;
                    element.docking.y = AmountCoinWizzStage.coinsPosition[i].y;
                    element.playDirect("coin", true);
                    element.play();
                    element.timeScale = 0;
                    element.rotation = AmountCoinWizzStage.coinsPosition[i].rotation;
                    element.seek(AmountCoinWizzStage.coinsPosition[i].startTime);
                    element.seek(AmountCoinWizzStage.coinsPosition[i].startTime);
                    element.seek(AmountCoinWizzStage.coinsPosition[i].startTime);
                    element.seek(AmountCoinWizzStage.coinsPosition[i].startTime);
                    element.scaleXY = 1;
                    element.visible = true;
                }
            }
            // phase one
            this._winAnimation.visible = true;
            this._winAnimation.playDirect("enter");
            this.scaleXY = 0;
            var firstTween = new gsap__WEBPACK_IMPORTED_MODULE_3__["TimelineMax"]();
            firstTween.to(this, 0.5, { scaleXY: 1.1 }, 0);
            firstTween.to(this, 0.1, {
                scaleXY: 1,
                onComplete: function () {
                    box.emit(_resultBox__WEBPACK_IMPORTED_MODULE_6__["EResultBoxEvents"].StageHasEntered, _this);
                    // phase two
                    var secondTween = new gsap__WEBPACK_IMPORTED_MODULE_3__["TimelineMax"]();
                    secondTween.to(_this, 3.5, {}, 0);
                    if (_this.config.hasCoinsAnimation) {
                        var coinFinalPos = _this.coinsContainer.toLocal(new pixi_js__WEBPACK_IMPORTED_MODULE_0__["Point"](_this.purse.dockingBounds.width + 15, 50), _this.purse, new pixi_js__WEBPACK_IMPORTED_MODULE_0__["Point"](0, 0), true);
                        var _loop_1 = function (i) {
                            var element = _this._coins[i];
                            // turning coin animation
                            var timeCoin = { float: AmountCoinWizzStage.coinsPosition[i].startTime };
                            var endTime = Math.ceil(AmountCoinWizzStage.coinsPosition[i].startTime / (1.605 + 0.48)) *
                                1.605 +
                                0.48;
                            secondTween.to(timeCoin, 1.75, {
                                float: endTime,
                                onUpdate: function () {
                                    element.seek(timeCoin.float);
                                },
                                onComplete: function () {
                                    element.seek(1.605 + 0.48);
                                },
                                ease: gsap__WEBPACK_IMPORTED_MODULE_3__["Linear"].easeNone,
                            }, 0);
                            // movement/rotation coin animation
                            secondTween.to(element.docking, 1.65 + (i % 3) * 0.1, {
                                x: coinFinalPos.x - element.x + element.docking.x,
                                delay: (i % 3) * 0.1,
                                ease: gsap__WEBPACK_IMPORTED_MODULE_3__["Cubic"].easeIn,
                            }, 0);
                            secondTween.to(element.docking, 1.7 + (i % 3) * 0.1, {
                                y: coinFinalPos.y - element.y + element.docking.y,
                                delay: (i % 3) * 0.1,
                                ease: gsap__WEBPACK_IMPORTED_MODULE_3__["Cubic"].easeIn,
                            }, 0);
                            secondTween.to(element, 1.7 + (i % 3) * 0.1, {
                                rotation: 0,
                                scaleXY: 0.5,
                                delay: (i % 3) * 0.1,
                                ease: gsap__WEBPACK_IMPORTED_MODULE_3__["Linear"].easeNone,
                                onComplete: function () {
                                    element.visible = false;
                                    if (_this._incrementationSound) {
                                        _this._incrementationSound.play();
                                    }
                                },
                            }, 0);
                        };
                        for (var i = 0; i < _this._coins.length; i++) {
                            _loop_1(i);
                        }
                    }
                    secondTween.play();
                },
            }, 0.5);
            firstTween.play();
        }
        // set the overall time of the animation
        var duration = box.amount.value === 0 ? this.config.loserDuration : this.config.winnerDuration;
        gsap__WEBPACK_IMPORTED_MODULE_3__["TweenMax"].to(this, duration, {
            onComplete: function () {
                box.emit(_resultBox__WEBPACK_IMPORTED_MODULE_6__["EResultBoxEvents"].StageWillExit, _this);
                done(true);
            },
        });
    };
    AmountCoinWizzStage.coinsPosition = [
        { x: 67, y: -223, startTime: 0.01, rotation: 0.6 },
        { x: 180, y: -128, startTime: 0.2, rotation: 2.3 },
        { x: 199, y: -3, startTime: 0.8, rotation: 3.25 },
        { x: 195, y: 181, startTime: 0.4, rotation: 0.35 },
        { x: 89, y: 247, startTime: 1.4, rotation: 1.8 },
        { x: -77, y: 254, startTime: 1, rotation: 0.45 },
        { x: -185, y: 162, startTime: 1.6, rotation: -2 },
        { x: -208, y: 26, startTime: 1.2, rotation: -3.6 },
        { x: -187, y: -109, startTime: 0.6, rotation: 1.4 },
        { x: -102, y: -215, startTime: 1.4, rotation: 0.8 },
    ];
    return AmountCoinWizzStage;
}(_resultStage__WEBPACK_IMPORTED_MODULE_5__["ResultStage"]));



/***/ }),

/***/ "./src/game/ui/result/amountCurrencyWizzStage.ts":
/*!*******************************************************!*\
  !*** ./src/game/ui/result/amountCurrencyWizzStage.ts ***!
  \*******************************************************/
/*! exports provided: AmountCurrencyWizzStage */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "AmountCurrencyWizzStage", function() { return AmountCurrencyWizzStage; });
/* harmony import */ var pixi_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! pixi.js */ "pixi.js");
/* harmony import */ var pixi_js__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(pixi_js__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var _gdk_core_pixi__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @gdk/core-pixi */ "@gdk/core-pixi");
/* harmony import */ var _gdk_core_pixi__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(_gdk_core_pixi__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var _gdk_core__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @gdk/core */ "@gdk/core");
/* harmony import */ var _gdk_core__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(_gdk_core__WEBPACK_IMPORTED_MODULE_2__);
/* harmony import */ var gsap__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! gsap */ "gsap");
/* harmony import */ var gsap__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(gsap__WEBPACK_IMPORTED_MODULE_3__);
/* harmony import */ var howler__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! howler */ "howler");
/* harmony import */ var howler__WEBPACK_IMPORTED_MODULE_4___default = /*#__PURE__*/__webpack_require__.n(howler__WEBPACK_IMPORTED_MODULE_4__);
/* harmony import */ var _resultStage__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./resultStage */ "./src/game/ui/result/resultStage.ts");
/* harmony import */ var _resultBox__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./resultBox */ "./src/game/ui/result/resultBox.ts");
/* harmony import */ var _adaptativeVisualIdentity__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../../adaptativeVisualIdentity */ "./src/adaptativeVisualIdentity/index.ts");
var __extends = (undefined && undefined.__extends) || (function () {
    var extendStatics = function (d, b) {
        extendStatics = Object.setPrototypeOf ||
            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||
            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };
        return extendStatics(d, b);
    };
    return function (d, b) {
        if (typeof b !== "function" && b !== null)
            throw new TypeError("Class extends value " + String(b) + " is not a constructor or null");
        extendStatics(d, b);
        function __() { this.constructor = d; }
        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
    };
})();
var __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};
var __generator = (undefined && undefined.__generator) || function (thisArg, body) {
    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;
    return g = { next: verb(0), "throw": verb(1), "return": verb(2) }, typeof Symbol === "function" && (g[Symbol.iterator] = function() { return this; }), g;
    function verb(n) { return function (v) { return step([n, v]); }; }
    function step(op) {
        if (f) throw new TypeError("Generator is already executing.");
        while (g && (g = 0, op[0] && (_ = 0)), _) try {
            if (f = 1, y && (t = op[0] & 2 ? y["return"] : op[0] ? y["throw"] || ((t = y["return"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;
            if (y = 0, t) op = [op[0] & 2, t.value];
            switch (op[0]) {
                case 0: case 1: t = op; break;
                case 4: _.label++; return { value: op[1], done: false };
                case 5: _.label++; y = op[1]; op = [0]; continue;
                case 7: op = _.ops.pop(); _.trys.pop(); continue;
                default:
                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }
                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }
                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }
                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }
                    if (t[2]) _.ops.pop();
                    _.trys.pop(); continue;
            }
            op = body.call(thisArg, _);
        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }
        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };
    }
};








var AmountCurrencyWizzStage = /** @class */ (function (_super) {
    __extends(AmountCurrencyWizzStage, _super);
    /**
     * Constructor
     */
    function AmountCurrencyWizzStage(config) {
        var _this = _super.call(this) || this;
        // texts
        _this._amount = new _gdk_core_pixi__WEBPACK_IMPORTED_MODULE_1__["TextArea"]("", config.amountStyle);
        _this._amount.keepCanvasReference = true; // Performances, keep canvas reference to avoid re-creating a canvas each update.
        _this._amount.docking = new _gdk_core_pixi__WEBPACK_IMPORTED_MODULE_1__["Docking"](_gdk_core_pixi__WEBPACK_IMPORTED_MODULE_1__["Docking"].centerAll);
        _this._amount.wordWrap = true;
        _this._amount.docking.cancelPivot = true;
        _this._amount.align = _gdk_core_pixi__WEBPACK_IMPORTED_MODULE_1__["EAlign"].Center;
        _this._amount.width = 500;
        _this._amount.docking.x = 0;
        _this._amount.docking.y = 0;
        _this._amount.scaleXY = 1;
        _this._amountStroke = new _gdk_core_pixi__WEBPACK_IMPORTED_MODULE_1__["TextArea"]("", config.amountStrokeStyle);
        _this._amountStroke.keepCanvasReference = true; // Performances, keep canvas reference to avoid re-creating a canvas each update.
        _this._amountStroke.docking = new _gdk_core_pixi__WEBPACK_IMPORTED_MODULE_1__["Docking"](_gdk_core_pixi__WEBPACK_IMPORTED_MODULE_1__["Docking"].centerAll);
        _this._amountStroke.wordWrap = true;
        _this._amountStroke.docking.cancelPivot = true;
        _this._amountStroke.align = _gdk_core_pixi__WEBPACK_IMPORTED_MODULE_1__["EAlign"].Center;
        _this._amountStroke.width = 500;
        _this._amountStroke.docking.x = 0;
        _this._amountStroke.docking.y = 0;
        _this._amountStroke.scaleXY = 1;
        // Sounds
        config.sounds = config.sounds || {};
        if (typeof config.sounds.loser === "string") {
            _this._loseSound = _gdk_core__WEBPACK_IMPORTED_MODULE_2__["Loader"].get(config.sounds.loser);
        }
        else if (config.sounds.loser instanceof howler__WEBPACK_IMPORTED_MODULE_4__["Howl"]) {
            _this._loseSound = config.sounds.loser;
        }
        if (typeof config.sounds.winner === "string") {
            _this._winSound = _gdk_core__WEBPACK_IMPORTED_MODULE_2__["Loader"].get(config.sounds.winner);
        }
        else if (config.sounds.winner instanceof howler__WEBPACK_IMPORTED_MODULE_4__["Howl"]) {
            _this._winSound = config.sounds.winner;
        }
        if (typeof config.sounds.increment === "string") {
            _this._incrementSound = _gdk_core__WEBPACK_IMPORTED_MODULE_2__["Loader"].get(config.sounds.increment);
        }
        else if (config.sounds.increment instanceof howler__WEBPACK_IMPORTED_MODULE_4__["Howl"]) {
            _this._incrementSound = config.sounds.increment;
        }
        // animations
        config.animationSpine = config.animationSpine || {};
        // rollingFX Animation
        if (config.animationSpine.rollingFX instanceof _gdk_core_pixi__WEBPACK_IMPORTED_MODULE_1__["SpineTimeline"]) {
            _this._rollingFX = config.animationSpine.rollingFX;
        }
        else {
            if (typeof config.animationSpine.rollingFX === "string") {
                _this._rollingFX = new _gdk_core_pixi__WEBPACK_IMPORTED_MODULE_1__["SpineTimeline"](config.animationSpine.rollingFX);
            }
            else {
                _this._rollingFX = new _gdk_core_pixi__WEBPACK_IMPORTED_MODULE_1__["SpineTimeline"]("rollingFX.json");
            }
            _this._rollingFX.docking = new _gdk_core_pixi__WEBPACK_IMPORTED_MODULE_1__["Docking"](_gdk_core_pixi__WEBPACK_IMPORTED_MODULE_1__["Docking"].centerAll);
            _this._rollingFX.docking.x = 0;
            _this._rollingFX.docking.y = 100;
            _this._rollingFX.pivot.x = 620;
            _this._rollingFX.pivot.y = 580;
            _this._rollingFX.scaleXY = 0.5;
        }
        _this._rollingFX.timeScale = 3;
        _this._rollingFX.visible = false;
        // lost animation
        if (config.animationSpine.loser instanceof _gdk_core_pixi__WEBPACK_IMPORTED_MODULE_1__["SpineTimeline"]) {
            _this._lostAnimation = config.animationSpine.loser;
        }
        else {
            if (typeof config.animationSpine.loser === "string") {
                _this._lostAnimation = new _gdk_core_pixi__WEBPACK_IMPORTED_MODULE_1__["SpineTimeline"](config.animationSpine.loser);
            }
            else {
                _this._lostAnimation = new _gdk_core_pixi__WEBPACK_IMPORTED_MODULE_1__["SpineTimeline"]("result_lost.json");
            }
            _this._lostAnimation.docking = new _gdk_core_pixi__WEBPACK_IMPORTED_MODULE_1__["Docking"](_gdk_core_pixi__WEBPACK_IMPORTED_MODULE_1__["Docking"].centerAll);
            _this._lostAnimation.docking.x = 0;
            _this._lostAnimation.docking.y = 100;
            _this._lostAnimation.pivot.x = 280;
            _this._lostAnimation.pivot.y = 260;
            _this._lostAnimation.scaleXY = 0.95;
        }
        _this._lostAnimation.visible = false;
        // sprites
        config.sprites = config.sprites || {};
        // backgroundCoin sprite
        if (config.sprites.currencyBackSprite instanceof pixi_js__WEBPACK_IMPORTED_MODULE_0__["Sprite"]) {
            _this._referenceBackgroundCoin = config.sprites.currencyBackSprite;
        }
        else {
            if (typeof config.sprites.currencyBackSprite === "string") {
                _this._referenceBackgroundCoin = pixi_js__WEBPACK_IMPORTED_MODULE_0__["Sprite"].fromImage(config.sprites.currencyBackSprite);
            }
            else {
                _this._referenceBackgroundCoin = pixi_js__WEBPACK_IMPORTED_MODULE_0__["Sprite"].fromImage("fx_euro_big.png");
            }
            _this._referenceBackgroundCoin.docking = new _gdk_core_pixi__WEBPACK_IMPORTED_MODULE_1__["Docking"](_gdk_core_pixi__WEBPACK_IMPORTED_MODULE_1__["Docking"].centerAll);
            _this._referenceBackgroundCoin.docking.x = 0;
            _this._referenceBackgroundCoin.docking.y = 0;
            _this._referenceBackgroundCoin.pivot.x = 18;
            _this._referenceBackgroundCoin.pivot.y = 46;
            _this._referenceBackgroundCoin.scaleXY = 0.38;
        }
        // moving coin sprite
        if (config.sprites.currencyMovingSprite instanceof pixi_js__WEBPACK_IMPORTED_MODULE_0__["Sprite"]) {
            _this._referenceCoin = config.sprites.currencyMovingSprite;
        }
        else {
            if (typeof config.sprites.currencyMovingSprite === "string") {
                _this._referenceCoin = pixi_js__WEBPACK_IMPORTED_MODULE_0__["Sprite"].fromImage(config.sprites.currencyMovingSprite);
            }
            else {
                _this._referenceCoin = pixi_js__WEBPACK_IMPORTED_MODULE_0__["Sprite"].fromImage("fx_euro_00.png");
            }
            _this._referenceCoin.docking = new _gdk_core_pixi__WEBPACK_IMPORTED_MODULE_1__["Docking"](_gdk_core_pixi__WEBPACK_IMPORTED_MODULE_1__["Docking"].centerAll);
            _this._referenceCoin.docking.x = 0;
            _this._referenceCoin.docking.y = 0;
            _this._referenceCoin.pivot.x = 40;
            _this._referenceCoin.pivot.y = 40;
            _this._referenceCoin.scaleXY = 1.3;
            _this._referenceCoin.visible = false;
        }
        // sparkles sprite
        var sparkleReference = pixi_js__WEBPACK_IMPORTED_MODULE_0__["Sprite"].fromImage("result_fx_sparkles.png");
        sparkleReference.docking = new _gdk_core_pixi__WEBPACK_IMPORTED_MODULE_1__["Docking"](_gdk_core_pixi__WEBPACK_IMPORTED_MODULE_1__["Docking"].centerAll);
        sparkleReference.docking.x = 0;
        sparkleReference.docking.y = 0;
        sparkleReference.pivot.x = 24;
        sparkleReference.pivot.y = 76;
        // sparkles container
        _this.sparkles = new pixi_js__WEBPACK_IMPORTED_MODULE_0__["Container"]();
        _this.sparkles.dockingBounds = new _gdk_core_pixi__WEBPACK_IMPORTED_MODULE_1__["DockingBounds"](256, 512);
        _this.sparkles.docking = new _gdk_core_pixi__WEBPACK_IMPORTED_MODULE_1__["Docking"](_gdk_core_pixi__WEBPACK_IMPORTED_MODULE_1__["Docking"].centerAll);
        _this.sparkles.docking.cancelPivot = true;
        _this.sparkles.docking.x = 0;
        _this.sparkles.docking.y = 32;
        _this.sparkles.pivot.x = 128;
        _this.sparkles.pivot.y = 256;
        _this._sparkles = [];
        for (var i = 0; i < 8; i++) {
            _this._sparkles[i] = sparkleReference.clone();
            _this._sparkles[i].rotation = AmountCurrencyWizzStage.sparkleRotation[i];
            _this.sparkles.addChild(_this._sparkles[i]);
        }
        // resultWin container
        _this.resultWin = new pixi_js__WEBPACK_IMPORTED_MODULE_0__["Container"]();
        _this.resultWin.dockingBounds = new _gdk_core_pixi__WEBPACK_IMPORTED_MODULE_1__["DockingBounds"](256, 512);
        _this.resultWin.docking = new _gdk_core_pixi__WEBPACK_IMPORTED_MODULE_1__["Docking"](_gdk_core_pixi__WEBPACK_IMPORTED_MODULE_1__["Docking"].centerAll);
        _this.resultWin.docking.cancelPivot = true;
        _this.resultWin.docking.x = 0;
        _this.resultWin.docking.y = 50;
        _this.resultWin.pivot.x = 128;
        _this.resultWin.pivot.y = 256;
        _this._fxRayon = pixi_js__WEBPACK_IMPORTED_MODULE_0__["Sprite"].fromFrame("result_fx_rayons.png");
        _this._fxRayon.docking = new _gdk_core_pixi__WEBPACK_IMPORTED_MODULE_1__["Docking"](_gdk_core_pixi__WEBPACK_IMPORTED_MODULE_1__["Docking"].centerAll);
        _this._fxRayon.width = 512;
        _this._fxRayon.height = 512;
        _this._fxRayon.pivot.x = 256;
        _this._fxRayon.pivot.y = 256;
        _this.resultWin.addChild(_this._fxRayon);
        var resultTXT = pixi_js__WEBPACK_IMPORTED_MODULE_0__["Sprite"].fromFrame("result_txt_win.png");
        resultTXT.docking = new _gdk_core_pixi__WEBPACK_IMPORTED_MODULE_1__["Docking"](_gdk_core_pixi__WEBPACK_IMPORTED_MODULE_1__["Docking"].centerAll);
        resultTXT.docking.cancelPivot = true;
        resultTXT.width = 461;
        resultTXT.height = 122;
        resultTXT.docking.y = -300;
        resultTXT.scaleXY = 0.8;
        resultTXT.pivot.x = 94;
        resultTXT.pivot.y = 58;
        _this.resultWin.addChild(resultTXT);
        // background coins
        _this._backgroundCoins = [];
        var totalBackgroundCoins = AmountCurrencyWizzStage.numberPerRayon *
            AmountCurrencyWizzStage.backgroundCoinsPosition.length;
        for (var i = 0; i < totalBackgroundCoins; i++) {
            var elem = (_this._backgroundCoins[i] = _this._referenceBackgroundCoin.clone());
            var rayonNumber = Math.floor(i / AmountCurrencyWizzStage.numberPerRayon);
            var rayon = AmountCurrencyWizzStage.backgroundCoinsPosition[rayonNumber];
            var placeInRayon = i - rayonNumber * AmountCurrencyWizzStage.numberPerRayon;
            elem.docking.x = rayon.x + Math.cos(rayon.angle + Math.PI / 2) * rayon.force * placeInRayon;
            elem.docking.y = rayon.y + Math.sin(rayon.angle + Math.PI / 2) * rayon.force * placeInRayon;
            elem.rotation = rayon.startRotation + rayon.rotationForce * placeInRayon;
            elem.scaleXY = rayon.startScale + rayon.scaleForce * placeInRayon;
            _this.resultWin.addChild(_this._backgroundCoins[i]);
        }
        // coins container
        _this._coinsContainer = new pixi_js__WEBPACK_IMPORTED_MODULE_0__["Container"]();
        _this._coinsContainer.dockingBounds = new _gdk_core_pixi__WEBPACK_IMPORTED_MODULE_1__["DockingBounds"](576, 1024);
        _this._coinsContainer.docking = new _gdk_core_pixi__WEBPACK_IMPORTED_MODULE_1__["Docking"](_gdk_core_pixi__WEBPACK_IMPORTED_MODULE_1__["Docking"].centerAll);
        _this._coinsContainer.docking.x = 0;
        _this._coinsContainer.docking.y = 50;
        _this._movingCoins = [];
        for (var i = 0; i < 10; i++) {
            _this._movingCoins[i] = _this._referenceCoin.clone();
            _this._coinsContainer.addChild(_this._movingCoins[i]);
        }
        config.game.vi.emitter.emit(_adaptativeVisualIdentity__WEBPACK_IMPORTED_MODULE_7__["EVisualIdentityAction"].WizzGetPursesContainers, function (containers) {
            _this.purse = containers.standard;
        });
        _this.addChild(_this._rollingFX);
        _this.addChild(_this.sparkles);
        _this.addChild(_this.resultWin);
        _this.addChild(_this._lostAnimation);
        _this.addChild(_this._coinsContainer);
        _this.resultWin.addChild(_this._amountStroke);
        _this.resultWin.addChild(_this._amount);
        // Misc.
        _this.config = config;
        _this.dockAsPoint = true;
        _this.visible = false;
        return _this;
    }
    /**
     * On show the result box
     * @param box the result box reference
     * @param done the callback to call when stage animation done
     */
    AmountCurrencyWizzStage.prototype.onShow = function (box, done) {
        var _this = this;
        if (box.amount.value === 0) {
            // Looser
            this.scaleXY = 1;
            this._rollingFX.visible = false;
            this.sparkles.visible = false;
            this.resultWin.visible = false;
            this._amount.visible = false;
            this._amountStroke.visible = false;
            this._lostAnimation.visible = false;
            // sounds
            if (this._loseSound) {
                this._loseSound.play();
            }
            // animations
            (function () { return __awaiter(_this, void 0, void 0, function () {
                var _this = this;
                return __generator(this, function (_a) {
                    switch (_a.label) {
                        case 0:
                            this._lostAnimation.on(_gdk_core_pixi__WEBPACK_IMPORTED_MODULE_1__["ESpineTimelineEvent"].Start, function () {
                                _this._lostAnimation.visible = true;
                            });
                            return [4 /*yield*/, this._lostAnimation.playDirect("enter")];
                        case 1:
                            _a.sent();
                            return [4 /*yield*/, this._lostAnimation.playDirect("idle", true)];
                        case 2:
                            _a.sent();
                            return [2 /*return*/];
                    }
                });
            }); })();
        }
        else {
            // Winner
            this.scaleXY = 0;
            this._rollingFX.visible = true;
            this.sparkles.visible = true;
            this.resultWin.visible = true;
            this._amount.visible = true;
            this._amountStroke.visible = true;
            this._lostAnimation.visible = false;
            // texts
            this._amount.text = _gdk_core__WEBPACK_IMPORTED_MODULE_2__["Numeral"].currency(box.amount, {
                minimumFractionDigits: this.config.minimumFractionDigits,
            });
            this._amountStroke.text = _gdk_core__WEBPACK_IMPORTED_MODULE_2__["Numeral"].currency(box.amount, {
                minimumFractionDigits: this.config.minimumFractionDigits,
            });
            // sounds
            if (this._winSound) {
                this._winSound.play();
            }
            // reset animations
            // reset coins animations
            if (this.config.hasCoinsAnimation) {
                // set coins to default
                for (var i = 0; i < this._movingCoins.length; i++) {
                    var element = this._movingCoins[i];
                    element.docking.x = AmountCurrencyWizzStage.coinsPosition[i].x;
                    element.docking.y = AmountCurrencyWizzStage.coinsPosition[i].y;
                    element.rotation = AmountCurrencyWizzStage.coinsPosition[i].rotation;
                    element.scaleXY = 1;
                    element.visible = true;
                }
            }
            // reset background coins animation
            var totalBackgroundCoins = AmountCurrencyWizzStage.numberPerRayon *
                AmountCurrencyWizzStage.backgroundCoinsPosition.length;
            for (var i = 0; i < totalBackgroundCoins; i++) {
                var elem = this._backgroundCoins[i];
                var rayonNumber = Math.floor(i / AmountCurrencyWizzStage.numberPerRayon);
                var rayon = AmountCurrencyWizzStage.backgroundCoinsPosition[rayonNumber];
                elem.docking.x = rayon.x;
                elem.docking.y = rayon.y;
                elem.rotation = rayon.startRotation;
            }
            // animations
            // phase one
            this._rollingFX.playDirect("enter", true);
            var firstTween = new gsap__WEBPACK_IMPORTED_MODULE_3__["TimelineMax"]();
            // size up
            firstTween.to(this, 0.5, { scaleXY: 1.1, ease: gsap__WEBPACK_IMPORTED_MODULE_3__["Back"].easeOut }, 0);
            firstTween.to(this, 0.1, {
                scaleXY: 1,
                ease: gsap__WEBPACK_IMPORTED_MODULE_3__["Back"].easeOut,
                onComplete: function () {
                    box.emit(_resultBox__WEBPACK_IMPORTED_MODULE_6__["EResultBoxEvents"].StageHasEntered, _this);
                    // phase two
                    if (_this.config.hasCoinsAnimation) {
                        var movingCoinTween = new gsap__WEBPACK_IMPORTED_MODULE_3__["TimelineMax"]();
                        // find the coins destination
                        var coinFinalPos = _this._coinsContainer.toLocal(new pixi_js__WEBPACK_IMPORTED_MODULE_0__["Point"](_this.purse.dockingBounds.width - 20, 0), _this.purse, new pixi_js__WEBPACK_IMPORTED_MODULE_0__["Point"](0, 0), true);
                        var _loop_1 = function (i) {
                            var element = _this._movingCoins[i];
                            // movement/rotation coin animation
                            movingCoinTween.to(element.docking, 1.65 + (i % 3) * 0.1, {
                                x: coinFinalPos.x - element.x + element.docking.x,
                                delay: (i % 3) * 0.1,
                                ease: gsap__WEBPACK_IMPORTED_MODULE_3__["Cubic"].easeIn,
                            }, 0);
                            movingCoinTween.to(element.docking, 1.7 + (i % 3) * 0.1, {
                                y: coinFinalPos.y - element.y + element.docking.y,
                                delay: (i % 3) * 0.1,
                                ease: gsap__WEBPACK_IMPORTED_MODULE_3__["Cubic"].easeIn,
                            }, 0);
                            movingCoinTween.to(element, 1.65 + (i % 3) * 0.1, { scaleXY: 0.5, delay: (i % 3) * 0.1, ease: gsap__WEBPACK_IMPORTED_MODULE_3__["Expo"].easeIn }, 0);
                            movingCoinTween.to(movingCoinTween, 1.65 + (i % 3) * 0.1, { timeScale: 0.8, delay: (i % 3) * 0.1, ease: gsap__WEBPACK_IMPORTED_MODULE_3__["Expo"].easeIn }, 0);
                            movingCoinTween.to(element, 1.7 + (i % 3) * 0.1, {
                                rotation: 0,
                                scaleXY: 0.5,
                                delay: (i % 3) * 0.1,
                                ease: gsap__WEBPACK_IMPORTED_MODULE_3__["Linear"].easeNone,
                                onComplete: function () {
                                    element.visible = false;
                                },
                            }, 0);
                        };
                        for (var i = 0; i < _this._movingCoins.length; i++) {
                            _loop_1(i);
                        }
                        movingCoinTween.play();
                    }
                },
            }, 0.5);
            // fxRayons rotating
            firstTween.to(this._fxRayon, 20, { rotation: Math.PI * 2 });
            // background coins
            for (var i = 0; i < totalBackgroundCoins; i++) {
                var elem = this._backgroundCoins[i];
                var rayonNumber = Math.floor(i / AmountCurrencyWizzStage.numberPerRayon);
                var rayon = AmountCurrencyWizzStage.backgroundCoinsPosition[rayonNumber];
                var placeInRayon = i - rayonNumber * AmountCurrencyWizzStage.numberPerRayon;
                var delayNumber = AmountCurrencyWizzStage.numberPerRayon - placeInRayon;
                var finalX = rayon.x + Math.cos(rayon.angle + Math.PI / 2) * rayon.force * placeInRayon;
                var finalY = rayon.y + Math.sin(rayon.angle + Math.PI / 2) * rayon.force * placeInRayon;
                firstTween.to(elem.docking, 0.6, { delay: delayNumber * 0.1, x: finalX, y: finalY, ease: gsap__WEBPACK_IMPORTED_MODULE_3__["Back"].easeOut }, 0);
                elem.rotation = rayon.startRotation + rayon.rotationForce * placeInRayon;
            }
            firstTween.play();
            this.sparkles.visible = true;
            this._sparkles.forEach(function (elem) {
                elem.scaleXY = 1;
                elem.alpha = 1;
                elem.docking.x = elem.docking.y = 0;
                gsap__WEBPACK_IMPORTED_MODULE_3__["TweenMax"].to(elem, 1, { scaleX: 2, scaleY: 8, delay: 0.1, ease: gsap__WEBPACK_IMPORTED_MODULE_3__["Power0"].easeNone });
                gsap__WEBPACK_IMPORTED_MODULE_3__["TweenMax"].to(elem.docking, 1, {
                    delay: 0.1,
                    ease: gsap__WEBPACK_IMPORTED_MODULE_3__["Power0"].easeNone,
                    x: 1000 * Math.cos(elem.rotation + Math.PI / 2),
                    y: 1000 * Math.sin(elem.rotation + Math.PI / 2),
                });
                gsap__WEBPACK_IMPORTED_MODULE_3__["TweenMax"].to(elem, 0.2, { alpha: 0, delay: 0.9 });
            });
        }
        // set the overall time of the animation
        gsap__WEBPACK_IMPORTED_MODULE_3__["TweenMax"].to(this, 6, {
            onComplete: function () {
                box.emit(_resultBox__WEBPACK_IMPORTED_MODULE_6__["EResultBoxEvents"].StageWillExit, _this);
                done(true);
            },
        });
    };
    AmountCurrencyWizzStage.coinsPosition = [
        { x: 67, y: -223, startTime: 0.01, rotation: 0.6 },
        { x: 180, y: -128, startTime: 0.2, rotation: 2.3 },
        { x: 199, y: -3, startTime: 0.8, rotation: 3.25 },
        { x: 195, y: 181, startTime: 0.4, rotation: 0.35 },
        { x: 89, y: 247, startTime: 1.4, rotation: 1.8 },
        { x: -77, y: 254, startTime: 1, rotation: 0.45 },
        { x: -185, y: 162, startTime: 1.6, rotation: -2 },
        { x: -208, y: 26, startTime: 1.2, rotation: -3.6 },
        { x: -187, y: -109, startTime: 0.6, rotation: 1.4 },
        { x: -102, y: -215, startTime: 1.4, rotation: 0.8 },
    ];
    AmountCurrencyWizzStage.sparkleRotation = [4, 2.9, 2, 0.64, 0, -0.93, 1.2, 4.5];
    AmountCurrencyWizzStage.backgroundCoinsPosition = [
        {
            x: -95,
            y: -10,
            angle: 1.74,
            force: 9,
            startRotation: -0.7,
            rotationForce: -0.08,
            startScale: 0.4,
            scaleForce: 0.1,
        },
        {
            x: -30,
            y: -40,
            angle: 2.62,
            force: 14,
            startRotation: 0,
            rotationForce: -0.2,
            startScale: 0.4,
            scaleForce: 0.1,
        },
        {
            x: 38,
            y: -45,
            angle: 3.48,
            force: 14,
            startRotation: 0.5,
            rotationForce: -0.1,
            startScale: 0.4,
            scaleForce: 0.1,
        },
        {
            x: 80,
            y: 0,
            angle: 4.36,
            force: 14,
            startRotation: 0.3,
            rotationForce: 0.05,
            startScale: 0.4,
            scaleForce: 0.1,
        },
    ];
    AmountCurrencyWizzStage.numberPerRayon = 6;
    return AmountCurrencyWizzStage;
}(_resultStage__WEBPACK_IMPORTED_MODULE_5__["ResultStage"]));



/***/ }),

/***/ "./src/game/ui/result/amountResultStage.ts":
/*!*************************************************!*\
  !*** ./src/game/ui/result/amountResultStage.ts ***!
  \*************************************************/
/*! exports provided: AmountResultStage */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "AmountResultStage", function() { return AmountResultStage; });
/* harmony import */ var pixi_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! pixi.js */ "pixi.js");
/* harmony import */ var pixi_js__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(pixi_js__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var _gdk_core_pixi__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @gdk/core-pixi */ "@gdk/core-pixi");
/* harmony import */ var _gdk_core_pixi__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(_gdk_core_pixi__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var _gdk_core__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @gdk/core */ "@gdk/core");
/* harmony import */ var _gdk_core__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(_gdk_core__WEBPACK_IMPORTED_MODULE_2__);
/* harmony import */ var gsap__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! gsap */ "gsap");
/* harmony import */ var gsap__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(gsap__WEBPACK_IMPORTED_MODULE_3__);
/* harmony import */ var howler__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! howler */ "howler");
/* harmony import */ var howler__WEBPACK_IMPORTED_MODULE_4___default = /*#__PURE__*/__webpack_require__.n(howler__WEBPACK_IMPORTED_MODULE_4__);
/* harmony import */ var _resultStage__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./resultStage */ "./src/game/ui/result/resultStage.ts");
/* harmony import */ var _resultBox__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./resultBox */ "./src/game/ui/result/resultBox.ts");
/* harmony import */ var ___WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../ */ "./src/game/index.ts");
var __extends = (undefined && undefined.__extends) || (function () {
    var extendStatics = function (d, b) {
        extendStatics = Object.setPrototypeOf ||
            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||
            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };
        return extendStatics(d, b);
    };
    return function (d, b) {
        if (typeof b !== "function" && b !== null)
            throw new TypeError("Class extends value " + String(b) + " is not a constructor or null");
        extendStatics(d, b);
        function __() { this.constructor = d; }
        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
    };
})();
var __values = (undefined && undefined.__values) || function(o) {
    var s = typeof Symbol === "function" && Symbol.iterator, m = s && o[s], i = 0;
    if (m) return m.call(o);
    if (o && typeof o.length === "number") return {
        next: function () {
            if (o && i >= o.length) o = void 0;
            return { value: o && o[i++], done: !o };
        }
    };
    throw new TypeError(s ? "Object is not iterable." : "Symbol.iterator is not defined.");
};








var AmountResultStage = /** @class */ (function (_super) {
    __extends(AmountResultStage, _super);
    /**
     * Constructor
     */
    function AmountResultStage(config) {
        var _this = _super.call(this) || this;
        // Public members
        _this.rays = [];
        // Protected members
        _this.currentAmount = 0;
        // Private members
        _this._totalRaysCount = 0;
        _this._averageRaysCount = 0;
        // Create rays
        _this._animatedThresholds = config.thresholds.filter(function (t) { return typeof t === "number" || t.animated !== false; });
        _this._totalRaysCount = config.raysPerThreshold * _this._animatedThresholds.length;
        _this._averageRaysCount = config.raysPerThreshold * (_this._animatedThresholds.length - 1);
        for (var i = 0; i < _this._totalRaysCount; i++) {
            // Add bigger rays when exceeding the average thresholds
            var big = i >= _this._averageRaysCount;
            var rayToUse = big ? config.bigRaySprite : config.smallRaySprite;
            var ray = null;
            ray = pixi_js__WEBPACK_IMPORTED_MODULE_0__["Sprite"].fromFrame(rayToUse);
            ray.pivot.y = ray.texture.height;
            ray.pivot.x = ray.texture.width / 2;
            _this.rays.push(ray);
        }
        _this.raysContainer = new pixi_js__WEBPACK_IMPORTED_MODULE_0__["Container"]();
        _this.raysContainer.dockAsPoint = true;
        _this.raysContainer.docking = new _gdk_core_pixi__WEBPACK_IMPORTED_MODULE_1__["Docking"](_gdk_core_pixi__WEBPACK_IMPORTED_MODULE_1__["Docking"].centerAll);
        _this.raysContainer.pivot.x = _this.raysContainer.width / 2;
        _this.raysContainer.pivot.y = _this.raysContainer.height / 2;
        _this.addChild(_this.raysContainer);
        _this.fastRaysContainer = new pixi_js__WEBPACK_IMPORTED_MODULE_0__["Container"]();
        _this.fastRaysContainer.dockAsPoint = true;
        _this.fastRaysContainer.docking = new _gdk_core_pixi__WEBPACK_IMPORTED_MODULE_1__["Docking"](_gdk_core_pixi__WEBPACK_IMPORTED_MODULE_1__["Docking"].centerAll);
        _this.fastRaysContainer.pivot.x = _this.fastRaysContainer.width / 2;
        _this.fastRaysContainer.pivot.y = _this.fastRaysContainer.height / 2;
        _this.addChild(_this.fastRaysContainer);
        // Middle sprite
        _this.middleSprite = pixi_js__WEBPACK_IMPORTED_MODULE_0__["Sprite"].fromFrame(config.middleSprite);
        _this.middleSprite.docking = new _gdk_core_pixi__WEBPACK_IMPORTED_MODULE_1__["Docking"](_gdk_core_pixi__WEBPACK_IMPORTED_MODULE_1__["Docking"].centerAll);
        _this.middleSprite.pivot.x = _this.middleSprite.texture.width / 2;
        _this.middleSprite.pivot.y = _this.middleSprite.texture.height / 2;
        // Main text
        _this.amount = new _gdk_core_pixi__WEBPACK_IMPORTED_MODULE_1__["TextArea"]("", config.amountStyle);
        _this.amount.docking = new _gdk_core_pixi__WEBPACK_IMPORTED_MODULE_1__["Docking"](_gdk_core_pixi__WEBPACK_IMPORTED_MODULE_1__["Docking"].centerAll);
        // Sound
        config.sounds = config.sounds || {};
        if (typeof config.sounds.incrementation === "string") {
            _this._incrementationSound = _gdk_core__WEBPACK_IMPORTED_MODULE_2__["Loader"].get(config.sounds.incrementation);
        }
        else if (config.sounds.incrementation instanceof howler__WEBPACK_IMPORTED_MODULE_4__["Howl"]) {
            _this._incrementationSound = config.sounds.incrementation;
        }
        // Misc.
        _this.config = config;
        _this.dockAsPoint = true;
        _this.visible = false;
        return _this;
    }
    /**
     * On show the result box
     * @param box the result box reference
     * @param done the callback to call when stage animation done
     */
    AmountResultStage.prototype.onShow = function (box, done) {
        var e_1, _a;
        // find matching threshold
        var threshold = { amount: 0 };
        try {
            for (var _b = __values(this.config.thresholds), _c = _b.next(); !_c.done; _c = _b.next()) {
                var _threshold = _c.value;
                var amount = _threshold instanceof Object ? _threshold.amount : _threshold;
                if (box.amount.value > amount) {
                    threshold = _threshold instanceof Object ? _threshold : { amount: _threshold };
                }
            }
        }
        catch (e_1_1) { e_1 = { error: e_1_1 }; }
        finally {
            try {
                if (_c && !_c.done && (_a = _b.return)) _a.call(_b);
            }
            finally { if (e_1) throw e_1.error; }
        }
        if (threshold.animated !== false) {
            this.showAnimated(box, done);
        }
        else {
            this.showStatic(box, threshold, done);
        }
    };
    AmountResultStage.prototype.showStatic = function (box, threshold, done) {
        var _a, _b, _c;
        this.amount.visible = false;
        this.amount.text = _gdk_core__WEBPACK_IMPORTED_MODULE_2__["Numeral"].currency(box.amount, {
            minimumFractionDigits: (_a = this.config.minimumFractionDigits) !== null && _a !== void 0 ? _a : 2,
        });
        this.amount.scaleXY = 1;
        this.amount.docking.y = 75 + ((_b = this.config.amountVerticalMargin) !== null && _b !== void 0 ? _b : 0);
        this.amount.visible = true;
        this.scaleXY = 1;
        this.removeChild(this.middleSprite);
        this.addChild(this.amount);
        var duration = (_c = threshold.duration) !== null && _c !== void 0 ? _c : 3;
        ___WEBPACK_IMPORTED_MODULE_7__["TweenUtils"].wait(duration).then(function () {
            done(false);
        });
    };
    AmountResultStage.prototype.showAnimated = function (box, done) {
        var _this = this;
        var _a;
        if (this._incrementationSound) {
            this._incrementationSound.play();
        }
        // Get threshold
        var thresholdIndex = 0;
        var currentThresholdIndex = thresholdIndex;
        var currentThreshold = this._animatedThresholds[currentThresholdIndex];
        // Get indexes of rays per thersholds
        var raysPerThreshold = this.config.raysPerThreshold;
        var startThresholdIndex = currentThresholdIndex * raysPerThreshold;
        var endThresholdIndex = (currentThresholdIndex + 1) * raysPerThreshold;
        // Set animations's duration
        var appearTime = this.config.appearTime || 2;
        var stayTime = this.config.stayTime || 1;
        var disappearTime = this.config.disappearTime || 1;
        var totalTime = -1;
        this._animatedThresholds.forEach(function (t, index) {
            var amount = t instanceof Object ? t.amount : t;
            if (box.amount.value > amount) {
                thresholdIndex = index;
                appearTime = 2 + 2 * index;
                if (t instanceof Object && "duration" in t) {
                    totalTime = t.duration;
                }
            }
        });
        if (totalTime > 0) {
            appearTime = totalTime - disappearTime - stayTime;
            if (appearTime < 3) {
                appearTime = 3;
                var actualTotalTime = appearTime + stayTime + disappearTime;
                var c = totalTime / actualTotalTime;
                stayTime *= c;
                disappearTime *= c;
                appearTime *= c;
            }
        }
        else {
            var actualTotalTime = appearTime + stayTime + disappearTime;
            totalTime = actualTotalTime;
        }
        this.amount.docking.y = (_a = this.config.amountVerticalMargin) !== null && _a !== void 0 ? _a : 0;
        // Add children
        this.middleSprite.scaleXY = 1;
        this.amount.scaleXY = 1;
        this.raysContainer.scaleXY = 0;
        this.fastRaysContainer.scaleXY = 0;
        this.raysContainer.rotation = 0;
        this.fastRaysContainer.rotation = 0;
        this.addChild(this.raysContainer);
        this.addChild(this.fastRaysContainer);
        this.addChild(this.middleSprite);
        this.addChild(box.particleSystem);
        this.addChild(this.amount);
        // Animate current amount (this)
        this.currentAmount = 0;
        gsap__WEBPACK_IMPORTED_MODULE_3__["TweenMax"].to(this, appearTime, {
            currentAmount: box.amount.value,
            onStart: function () {
                // Performances, keep canvas reference to avoid re-creating a canvas each update.
                _this.amount.keepCanvasReference = true;
            },
            onComplete: function () {
                _this.amount.keepCanvasReference = false;
            },
            onUpdate: function () {
                var _a;
                _this.amount.text = _gdk_core__WEBPACK_IMPORTED_MODULE_2__["Numeral"].currency(new _gdk_core__WEBPACK_IMPORTED_MODULE_2__["Amount"]({ value: _this.currentAmount, currency: box.amount.currency }), { minimumFractionDigits: (_a = _this.config.minimumFractionDigits) !== null && _a !== void 0 ? _a : 2 });
                _this.amount.pivot.x = _this.amount.width / 2;
                _this.amount.pivot.y = _this.amount.height / 2;
                var currentThresholdAmount = currentThreshold instanceof Object ? currentThreshold.amount : currentThreshold;
                // Add rays if current amount superior to curren threshold
                if ((currentThreshold && _this.currentAmount >= currentThresholdAmount) ||
                    currentThresholdIndex === 0) {
                    for (var i = startThresholdIndex; i < endThresholdIndex; i++) {
                        i < _this._averageRaysCount
                            ? _this.fastRaysContainer.addChild(_this.rays[i])
                            : _this.raysContainer.addChild(_this.rays[i]);
                    }
                    for (var i = 0; i < endThresholdIndex; i++) {
                        if ((startThresholdIndex < _this._averageRaysCount &&
                            i < _this._averageRaysCount &&
                            i % (endThresholdIndex / startThresholdIndex) > 0) ||
                            i >= _this._averageRaysCount) {
                            _this.rays[i].scaleXY = 0;
                            gsap__WEBPACK_IMPORTED_MODULE_3__["TweenMax"].to(_this.rays[i], 1, {
                                scaleXY: 1,
                            });
                        }
                    }
                    currentThreshold = _this._animatedThresholds[++currentThresholdIndex];
                    startThresholdIndex = currentThresholdIndex * raysPerThreshold;
                    endThresholdIndex = (currentThresholdIndex + 1) * raysPerThreshold;
                    var raysRotationDelta_1 = (Math.PI * 2) / _this.fastRaysContainer.children.length;
                    var rotation_1 = 0;
                    _this.fastRaysContainer.children.forEach(function (child) {
                        child.rotation = rotation_1;
                        rotation_1 += raysRotationDelta_1;
                    });
                    raysRotationDelta_1 = (Math.PI * 2) / _this.raysContainer.children.length;
                    rotation_1 = 0;
                    _this.raysContainer.children.forEach(function (child) {
                        child.rotation = rotation_1;
                        rotation_1 += raysRotationDelta_1;
                    });
                }
            },
        });
        // Animate "this" scale
        this.scaleXY = 0;
        gsap__WEBPACK_IMPORTED_MODULE_3__["TweenMax"].to(this, appearTime, {
            scaleXY: 1,
            onComplete: function () {
                box.emit(_resultBox__WEBPACK_IMPORTED_MODULE_6__["EResultBoxEvents"].StageHasEntered, _this);
                box.startParticleSystem();
                gsap__WEBPACK_IMPORTED_MODULE_3__["TweenMax"].to(box.particleSystem, 0.5, {
                    scaleXY: 1,
                });
            },
        });
        gsap__WEBPACK_IMPORTED_MODULE_3__["TweenMax"].to(this.raysContainer, appearTime, {
            scaleXY: 1,
        });
        gsap__WEBPACK_IMPORTED_MODULE_3__["TweenMax"].to(this.fastRaysContainer, appearTime, {
            scaleXY: 1,
        });
        gsap__WEBPACK_IMPORTED_MODULE_3__["TweenMax"].to(this.raysContainer, totalTime, {
            rotation: Math.PI * 3,
        });
        gsap__WEBPACK_IMPORTED_MODULE_3__["TweenMax"].to(this.fastRaysContainer, totalTime, {
            rotation: Math.PI * 6,
        });
        // Animate middle sprite
        this.middleSprite.rotation = 0;
        gsap__WEBPACK_IMPORTED_MODULE_3__["TweenMax"].to(this.middleSprite, totalTime, {
            ease: gsap__WEBPACK_IMPORTED_MODULE_3__["Back"].easeInOut.config(1.7),
            rotation: -Math.PI * 6,
        });
        var disappearingComponents = [this.raysContainer, this.fastRaysContainer, this.middleSprite];
        if (this.config.amountDisappears) {
            disappearingComponents.push(this.amount);
        }
        // Once done, animate ScaleXY from 1 to 0 of "this"
        gsap__WEBPACK_IMPORTED_MODULE_3__["TweenMax"].to(disappearingComponents, disappearTime, {
            ease: gsap__WEBPACK_IMPORTED_MODULE_3__["Back"].easeIn.config(1.7),
            scaleXY: 0,
            delay: appearTime + stayTime,
            onStart: function () {
                box.emit(_resultBox__WEBPACK_IMPORTED_MODULE_6__["EResultBoxEvents"].StageWillExit, _this);
            },
            onComplete: function () {
                _this.removeChild(box.particleSystem);
                for (var i = _this.raysContainer.children.length - 1; i >= 0; i--) {
                    _this.raysContainer.removeChild(_this.raysContainer.children[i]);
                }
                for (var i = _this.fastRaysContainer.children.length - 1; i >= 0; i--) {
                    _this.fastRaysContainer.removeChild(_this.fastRaysContainer.children[i]);
                }
                done(box.amount.value <= 0);
            },
        });
    };
    /**
     * Hide the stage
     * @param progressive: If true, stage is hidden in 0.3s, otherwise in 0s.
     */
    AmountResultStage.prototype.onHide = function (progressive) {
        if (this.config.amountDisappears === false) {
            return Promise.resolve();
        }
        return _super.prototype.onHide.call(this, progressive);
    };
    /**
     * Hide the stage immediatly
     */
    AmountResultStage.prototype.hide = function () {
        _super.prototype.hide.call(this);
        this.amount.text = "";
    };
    return AmountResultStage;
}(_resultStage__WEBPACK_IMPORTED_MODULE_5__["ResultStage"]));



/***/ }),

/***/ "./src/game/ui/result/index.ts":
/*!*************************************!*\
  !*** ./src/game/ui/result/index.ts ***!
  \*************************************/
/*! exports provided: ResultBox, EResultBoxEvents, ResultStage, ScratchStage, TextResultStage, AmountResultStage */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _resultBox__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./resultBox */ "./src/game/ui/result/resultBox.ts");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "ResultBox", function() { return _resultBox__WEBPACK_IMPORTED_MODULE_0__["ResultBox"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "EResultBoxEvents", function() { return _resultBox__WEBPACK_IMPORTED_MODULE_0__["EResultBoxEvents"]; });

/* harmony import */ var _resultStage__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./resultStage */ "./src/game/ui/result/resultStage.ts");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "ResultStage", function() { return _resultStage__WEBPACK_IMPORTED_MODULE_1__["ResultStage"]; });

/* harmony import */ var _scratchStage__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./scratchStage */ "./src/game/ui/result/scratchStage.ts");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "ScratchStage", function() { return _scratchStage__WEBPACK_IMPORTED_MODULE_2__["ScratchStage"]; });

/* harmony import */ var _textResultStage__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./textResultStage */ "./src/game/ui/result/textResultStage.ts");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "TextResultStage", function() { return _textResultStage__WEBPACK_IMPORTED_MODULE_3__["TextResultStage"]; });

/* harmony import */ var _amountResultStage__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./amountResultStage */ "./src/game/ui/result/amountResultStage.ts");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "AmountResultStage", function() { return _amountResultStage__WEBPACK_IMPORTED_MODULE_4__["AmountResultStage"]; });








/***/ }),

/***/ "./src/game/ui/result/resultBox.ts":
/*!*****************************************!*\
  !*** ./src/game/ui/result/resultBox.ts ***!
  \*****************************************/
/*! exports provided: EResultBoxEvents, ResultBox */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "EResultBoxEvents", function() { return EResultBoxEvents; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ResultBox", function() { return ResultBox; });
/* harmony import */ var gsap__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! gsap */ "gsap");
/* harmony import */ var gsap__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(gsap__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var pixi_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! pixi.js */ "pixi.js");
/* harmony import */ var pixi_js__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(pixi_js__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var i18next__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! i18next */ "i18next");
/* harmony import */ var i18next__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(i18next__WEBPACK_IMPORTED_MODULE_2__);
/* harmony import */ var _gdk_core_pixi__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @gdk/core-pixi */ "@gdk/core-pixi");
/* harmony import */ var _gdk_core_pixi__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(_gdk_core_pixi__WEBPACK_IMPORTED_MODULE_3__);
/* harmony import */ var _gdk_core__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @gdk/core */ "@gdk/core");
/* harmony import */ var _gdk_core__WEBPACK_IMPORTED_MODULE_4___default = /*#__PURE__*/__webpack_require__.n(_gdk_core__WEBPACK_IMPORTED_MODULE_4__);
/* harmony import */ var _textResultStage__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./textResultStage */ "./src/game/ui/result/textResultStage.ts");
/* harmony import */ var _amountResultStage__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./amountResultStage */ "./src/game/ui/result/amountResultStage.ts");
/* harmony import */ var _scratchStage__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./scratchStage */ "./src/game/ui/result/scratchStage.ts");
/* harmony import */ var _amountCoinWizzStage__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ./amountCoinWizzStage */ "./src/game/ui/result/amountCoinWizzStage.ts");
/* harmony import */ var _amountCurrencyWizzStage__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ./amountCurrencyWizzStage */ "./src/game/ui/result/amountCurrencyWizzStage.ts");
/* harmony import */ var _spineStage__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ./spineStage */ "./src/game/ui/result/spineStage.ts");
var __extends = (undefined && undefined.__extends) || (function () {
    var extendStatics = function (d, b) {
        extendStatics = Object.setPrototypeOf ||
            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||
            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };
        return extendStatics(d, b);
    };
    return function (d, b) {
        if (typeof b !== "function" && b !== null)
            throw new TypeError("Class extends value " + String(b) + " is not a constructor or null");
        extendStatics(d, b);
        function __() { this.constructor = d; }
        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
    };
})();
var __assign = (undefined && undefined.__assign) || function () {
    __assign = Object.assign || function(t) {
        for (var s, i = 1, n = arguments.length; i < n; i++) {
            s = arguments[i];
            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))
                t[p] = s[p];
        }
        return t;
    };
    return __assign.apply(this, arguments);
};
var __values = (undefined && undefined.__values) || function(o) {
    var s = typeof Symbol === "function" && Symbol.iterator, m = s && o[s], i = 0;
    if (m) return m.call(o);
    if (o && typeof o.length === "number") return {
        next: function () {
            if (o && i >= o.length) o = void 0;
            return { value: o && o[i++], done: !o };
        }
    };
    throw new TypeError(s ? "Object is not iterable." : "Symbol.iterator is not defined.");
};











var EResultBoxEvents;
(function (EResultBoxEvents) {
    EResultBoxEvents["StageAppear"] = "StageAppear";
    EResultBoxEvents["StageDisappear"] = "StageDisappear";
    EResultBoxEvents["StageHasEntered"] = "StageHasEntered";
    EResultBoxEvents["StageWillExit"] = "StageWillExit";
})(EResultBoxEvents || (EResultBoxEvents = {}));
var ResultBox = /** @class */ (function (_super) {
    __extends(ResultBox, _super);
    /**
     * Constructor
     * @param config the result box config (style)
     */
    function ResultBox() {
        var _this = 
        // PIXI.Container
        _super.call(this) || this;
        // Public members
        _this.particleSystem = null;
        // Protected members
        _this._amount = null;
        _this._stages = [];
        _this._currentStage = null;
        _this.particleTweens = [];
        // Misc.
        _this.docking = new _gdk_core_pixi__WEBPACK_IMPORTED_MODULE_3__["Docking"](_gdk_core_pixi__WEBPACK_IMPORTED_MODULE_3__["Docking"].centerAll);
        _this.dockingBounds = new _gdk_core_pixi__WEBPACK_IMPORTED_MODULE_3__["DockingBounds"](1, 1); // A point
        return _this;
    }
    Object.defineProperty(ResultBox.prototype, "stages", {
        /**
         * Returns the available stages (only get)
         */
        get: function () {
            return this._stages;
        },
        enumerable: false,
        configurable: true
    });
    Object.defineProperty(ResultBox.prototype, "amount", {
        /**
         * Returns the current amount won by the player
         */
        get: function () {
            return this._amount;
        },
        enumerable: false,
        configurable: true
    });
    /**
     * Animates the result box (automatically send the
     * matching tracking event)
     */
    ResultBox.prototype.animate = function (amount, done) {
        var e_1, _a;
        var _this = this;
        this._currentStage = this.stages[0];
        this._amount = amount;
        try {
            for (var _b = __values(this.stages), _c = _b.next(); !_c.done; _c = _b.next()) {
                var stage = _c.value;
                stage.hide();
            }
        }
        catch (e_1_1) { e_1 = { error: e_1_1 }; }
        finally {
            try {
                if (_c && !_c.done && (_a = _b.return)) _a.call(_b);
            }
            finally { if (e_1) throw e_1.error; }
        }
        this.next(function () {
            if (_this.particleSystem) {
                _this.removeChild(_this.particleSystem);
            }
            _this._amount = null;
            done();
        });
    };
    /**
     * Goes to the next stage
     */
    ResultBox.prototype.next = function (done) {
        var _this = this;
        var index = this._stages.indexOf(this._currentStage);
        this._currentStage.visible = true;
        this.emit(EResultBoxEvents.StageAppear, this._currentStage);
        this._currentStage.onShow(this, function (stop, hide) {
            var e_2, _a;
            if (hide === void 0) { hide = true; }
            if (hide) {
                var progressive = index === _this._stages.length - 1;
                try {
                    for (var _b = __values(_this.stages), _c = _b.next(); !_c.done; _c = _b.next()) {
                        var stage = _c.value;
                        stage.onHide(progressive);
                    }
                }
                catch (e_2_1) { e_2 = { error: e_2_1 }; }
                finally {
                    try {
                        if (_c && !_c.done && (_a = _b.return)) _a.call(_b);
                    }
                    finally { if (e_2) throw e_2.error; }
                }
            }
            _this.emit(EResultBoxEvents.StageDisappear, _this._currentStage);
            if (index + 1 >= _this._stages.length || stop) {
                _this._currentStage = _this._stages[0];
                done();
            }
            else {
                _this._currentStage = _this._stages[index + 1];
                _this.next(done);
            }
        });
        if (this.onNext) {
            this.onNext(this._currentStage);
        }
    };
    /**
     * Add a stage to the result box
     * @param stage the stage to add
     */
    ResultBox.prototype.addStage = function (stage, index) {
        if (!this._currentStage) {
            this._currentStage = stage;
        }
        if (index === undefined) {
            this._stages.push(stage);
        }
        else {
            this._stages.splice(index, 0, stage);
        }
        this.addChild(stage);
    };
    /**
     * Removes a stage from the result box
     * @param stage the stage reference to remove
     */
    ResultBox.prototype.removeStage = function (stage) {
        this.removeChild(stage);
        var index = this._stages.indexOf(stage);
        if (index !== -1) {
            this._stages.splice(index, 1);
        }
    };
    /**
     * Creates particles globally applied on the result box
     */
    ResultBox.prototype.createParticles = function (size, particleSprites, properties) {
        if (size === void 0) { size = 100; }
        this.particleSystem = new pixi_js__WEBPACK_IMPORTED_MODULE_1__["particles"].ParticleContainer(size, properties);
        this.particleSystem.docking = new _gdk_core_pixi__WEBPACK_IMPORTED_MODULE_3__["Docking"](_gdk_core_pixi__WEBPACK_IMPORTED_MODULE_3__["Docking"].centerAll);
        // Add particles
        for (var i = 0; i < size - 1; i++) {
            var index = (Math.random() * particleSprites.length) >> 0;
            var p = pixi_js__WEBPACK_IMPORTED_MODULE_1__["Sprite"].fromFrame(particleSprites[index]);
            this.particleSystem.addChild(p);
        }
        this.particleSystemConfig = {
            count: size,
            sprites: particleSprites,
            alpha: properties.alpha,
            scale: properties.scale,
            position: properties.position,
        };
    };
    /**
     * Starts the particle system
     */
    ResultBox.prototype.startParticleSystem = function (deltaTime) {
        var _this = this;
        if (deltaTime === void 0) { deltaTime = 37; }
        this.particleSystem.visible = true;
        this.particleTweens.forEach(function (t) { return t.kill(); });
        this.particleTweens = [];
        // Start animations
        this.particleSystem.children.forEach(function (p, index) {
            p.scaleXY = 0.5;
            p.x = p.y = p.alpha = 0;
            var cos = Math.cos(Math.PI * 2 * Math.random());
            var sin = Math.sin(Math.PI * 2 * Math.random());
            var tween = gsap__WEBPACK_IMPORTED_MODULE_0__["TweenMax"].to(p, 1, {
                delay: (deltaTime * index) / 1000,
                x: screen.width * cos,
                y: screen.height * sin,
                scaleXY: 1 + Math.random(),
                onStart: function () {
                    p.alpha = 1;
                    tween.updateTo({
                        alpha: 0,
                    });
                },
            });
            _this.particleTweens.push(tween);
        });
    };
    /**
     * Returns a result box following the wizz guidelines for game giving coins
     */
    ResultBox.createCoinWizz = function (config, stake) {
        if (stake === void 0) { stake = _gdk_core__WEBPACK_IMPORTED_MODULE_4__["Amount"].fromNumber(100); }
        var result = new ResultBox();
        result.addStage(new _amountCoinWizzStage__WEBPACK_IMPORTED_MODULE_8__["AmountCoinWizzStage"]({
            game: config.game,
            amountStyle: config.winAmountTextStyle,
            hasCoinsAnimation: config.hasCoinsAnimation || true,
            sounds: {
                loser: (config.sounds && config.sounds.loser) || null,
                winner: (config.sounds && config.sounds.winner) || null,
                incrementation: (config.sounds && config.sounds.incrementation) || null,
            },
            animationSpine: {
                loser: (config.animationSpine && config.animationSpine.assetIDLoser) || null,
                winner: (config.animationSpine && config.animationSpine.assetIDWinner) || null,
                coin: (config.animationSpine && config.animationSpine.assetIDCoins) || null,
            },
            loserDuration: config.loserDuration,
            winnerDuration: config.winnerDuration,
        }));
        return result;
    };
    /**
     * Returns a result box following the wizz guidelines for game giving true currency
     */
    ResultBox.createCurrencyWizz = function (config, stake) {
        if (stake === void 0) { stake = _gdk_core__WEBPACK_IMPORTED_MODULE_4__["Amount"].fromNumber(100); }
        var result = new ResultBox();
        result.addStage(new _amountCurrencyWizzStage__WEBPACK_IMPORTED_MODULE_9__["AmountCurrencyWizzStage"]({
            game: config.game,
            amountStyle: config.winAmountTextStyle,
            amountStrokeStyle: config.winAmountStrokeTextStyle,
            hasCoinsAnimation: config.hasCoinsAnimation || true,
            sounds: {
                loser: (config.sounds && config.sounds.loser) || null,
                winner: (config.sounds && config.sounds.winner) || null,
            },
            animationSpine: {
                loser: (config.animationSpine && config.animationSpine.assetIDLoser) || null,
                rollingFX: (config.animationSpine && config.animationSpine.assetIDRollingFX) || null,
            },
            sprites: {
                winTextSprite: (config.sprites && config.sprites.winTextSprite) || null,
                currencyBackSprite: (config.sprites && config.sprites.currencyBackSprite) || null,
                currencyMovingSprite: (config.sprites && config.sprites.currencyMovingSprite) || null,
            },
            minimumFractionDigits: config.minimumFractionDigits,
        }));
        return result;
    };
    /**
     * Returns a default result box following the Illiko guidelines
     */
    ResultBox.createDefault = function (config, stake) {
        var _a, _b, _c, _d, _e, _f, _g, _h, _j, _k, _l, _m, _o, _p, _q, _r, _s, _t, _u, _v, _w;
        if (stake === void 0) { stake = _gdk_core__WEBPACK_IMPORTED_MODULE_4__["Amount"].fromNumber(100); }
        var result = new ResultBox();
        // Particle systems
        config.particleSystems = config.particleSystems || {
            count: 200,
            alpha: true,
            position: true,
            scale: true,
            sprites: ["sp_particule_00.png", "sp_particule_01.png", "sp_particule_02.png"],
        };
        result.createParticles(config.particleSystems.count, (_a = config.particleSystems.sprites) !== null && _a !== void 0 ? _a : [
            "sp_particule_00.png",
            "sp_particule_01.png",
            "sp_particule_02.png",
        ], {
            alpha: config.particleSystems.alpha,
            position: config.particleSystems.position,
            scale: config.particleSystems.scale,
        });
        var thresholdsTexts = (_b = config.thresholdsTexts) !== null && _b !== void 0 ? _b : [];
        var looserTexts = (_c = config.looserTexts) !== null && _c !== void 0 ? _c : {};
        var textResultConfig = {
            mainTextWinner: config.textStyles.mainTextWinner,
            subText1Winner: config.textStyles.subText1Winner,
            mainTextLooser: config.textStyles.mainTextLooser,
            subText1Looser: config.textStyles.subText1Looser,
            subText2Looser: config.textStyles.subText2Looser,
            winningThresholds: [
                {
                    amount: Number(stake.value),
                    mainText: (_e = (_d = thresholdsTexts[0]) === null || _d === void 0 ? void 0 : _d.mainText) !== null && _e !== void 0 ? _e : i18next__WEBPACK_IMPORTED_MODULE_2__["t"]("result.winner1"),
                    subText1: (_g = (_f = thresholdsTexts[0]) === null || _f === void 0 ? void 0 : _f.subText) !== null && _g !== void 0 ? _g : i18next__WEBPACK_IMPORTED_MODULE_2__["t"]("result.winnerSubText"),
                },
                {
                    amount: 10 * stake.value,
                    mainText: (_j = (_h = thresholdsTexts[1]) === null || _h === void 0 ? void 0 : _h.mainText) !== null && _j !== void 0 ? _j : i18next__WEBPACK_IMPORTED_MODULE_2__["t"]("result.winner2"),
                    subText1: (_l = (_k = thresholdsTexts[1]) === null || _k === void 0 ? void 0 : _k.subText) !== null && _l !== void 0 ? _l : i18next__WEBPACK_IMPORTED_MODULE_2__["t"]("result.winnerSubText"),
                },
                {
                    amount: 49 * stake.value,
                    mainText: (_o = (_m = thresholdsTexts[2]) === null || _m === void 0 ? void 0 : _m.mainText) !== null && _o !== void 0 ? _o : i18next__WEBPACK_IMPORTED_MODULE_2__["t"]("result.winner3"),
                    subText1: (_q = (_p = thresholdsTexts[2]) === null || _p === void 0 ? void 0 : _p.subText) !== null && _q !== void 0 ? _q : i18next__WEBPACK_IMPORTED_MODULE_2__["t"]("result.winnerSubText"),
                },
            ],
            looserTexts: {
                disappears: (_r = config.amountDisappears) !== null && _r !== void 0 ? _r : true,
                mainText: (_s = looserTexts.mainText) !== null && _s !== void 0 ? _s : i18next__WEBPACK_IMPORTED_MODULE_2__["t"]("result.looser1"),
                subText1: (_t = looserTexts.subText1) !== null && _t !== void 0 ? _t : i18next__WEBPACK_IMPORTED_MODULE_2__["t"]("result.looser2"),
                subText2: (_u = looserTexts.subText2) !== null && _u !== void 0 ? _u : i18next__WEBPACK_IMPORTED_MODULE_2__["t"]("result.looser3"),
            },
            sounds: {
                loser: (config.sounds && config.sounds.loser) || null,
                winner: (config.sounds && config.sounds.winner) || null,
            },
            looserDuration: (_v = config.looserDuration) !== null && _v !== void 0 ? _v : 3,
        };
        var amountResultConfig = {
            amountDisappears: (_w = config.amountDisappears) !== null && _w !== void 0 ? _w : true,
            amountVerticalMargin: config.amountVerticalMargin,
            smallRaySprite: "sp_layon_s.png",
            bigRaySprite: "sp_layon_b.png",
            middleSprite: "sp_effect_win.png",
            amountStyle: config.winAmountTextStyle,
            raysPerThreshold: 6,
            thresholds: [Number(stake.value), 10 * stake.value, 50 * stake.value],
            sounds: {
                incrementation: (config.sounds && config.sounds.incrementation) || null,
            },
            minimumFractionDigits: config.minimumFractionDigits,
        };
        if (config.thresholds !== undefined) {
            textResultConfig.winningThresholds = config.thresholds.map(function (c, i) {
                var _a, _b, _c, _d, _e, _f;
                return ({
                    amount: ((_a = c.multiplier) !== null && _a !== void 0 ? _a : 0) * stake.value,
                    mainText: (_c = (_b = thresholdsTexts[i]) === null || _b === void 0 ? void 0 : _b.mainText) !== null && _c !== void 0 ? _c : i18next__WEBPACK_IMPORTED_MODULE_2__["t"]("result.winner".concat(i)),
                    subText1: (_e = (_d = thresholdsTexts[i]) === null || _d === void 0 ? void 0 : _d.subText) !== null && _e !== void 0 ? _e : i18next__WEBPACK_IMPORTED_MODULE_2__["t"]("result.winnerSubText"),
                    animated: (_f = c.animated) !== null && _f !== void 0 ? _f : true,
                    duration: 2,
                });
            });
            amountResultConfig.thresholds = config.thresholds.map(function (c) {
                var _a, _b, _c;
                return ({
                    amount: c.multiplier * stake.value,
                    animated: (_a = c.animated) !== null && _a !== void 0 ? _a : true,
                    duration: c.animated ? ((_b = c.duration) !== null && _b !== void 0 ? _b : 3) - 2 : (_c = c.duration) !== null && _c !== void 0 ? _c : 3,
                });
            });
        }
        // Stages
        result.addStage(new _textResultStage__WEBPACK_IMPORTED_MODULE_5__["TextResultStage"](textResultConfig));
        result.addStage(new _amountResultStage__WEBPACK_IMPORTED_MODULE_6__["AmountResultStage"](amountResultConfig));
        return result;
    };
    /**
     * Returns a result box containing a popup used for scratch games
     */
    ResultBox.createDefaultScratch = function (config, stake) {
        var _a, _b, _c, _d, _e, _f, _g, _h, _j, _k, _l, _m, _o, _p, _q, _r, _s, _t;
        if (stake === void 0) { stake = _gdk_core__WEBPACK_IMPORTED_MODULE_4__["Amount"].fromNumber(100); }
        var result = new ResultBox();
        var thresholdsTexts = (_a = config.thresholdsTexts) !== null && _a !== void 0 ? _a : [];
        var looserTexts = (_b = config.looserTexts) !== null && _b !== void 0 ? _b : {};
        var scratchConfig = {
            disappears: (_c = config.disappears) !== null && _c !== void 0 ? _c : true,
            mainTextWinner: config.textStyles.mainTextWinner,
            subText1Winner: config.textStyles.subText1Winner,
            mainTextLooser: config.textStyles.mainTextLooser,
            subText1Looser: config.textStyles.subText1Looser,
            subText2Looser: config.textStyles.subText2Looser,
            winningThresholds: [
                {
                    amount: Number(stake.value),
                    mainText: (_e = (_d = thresholdsTexts[0]) === null || _d === void 0 ? void 0 : _d.mainText) !== null && _e !== void 0 ? _e : i18next__WEBPACK_IMPORTED_MODULE_2__["t"]("result.winner1"),
                    subText1: (_g = (_f = thresholdsTexts[0]) === null || _f === void 0 ? void 0 : _f.subText) !== null && _g !== void 0 ? _g : i18next__WEBPACK_IMPORTED_MODULE_2__["t"]("result.winnerSubText"),
                },
                {
                    amount: 10 * stake.value,
                    mainText: (_j = (_h = thresholdsTexts[1]) === null || _h === void 0 ? void 0 : _h.mainText) !== null && _j !== void 0 ? _j : i18next__WEBPACK_IMPORTED_MODULE_2__["t"]("result.winner2"),
                    subText1: (_l = (_k = thresholdsTexts[1]) === null || _k === void 0 ? void 0 : _k.subText) !== null && _l !== void 0 ? _l : i18next__WEBPACK_IMPORTED_MODULE_2__["t"]("result.winnerSubText"),
                },
                {
                    amount: 49 * stake.value,
                    mainText: (_o = (_m = thresholdsTexts[2]) === null || _m === void 0 ? void 0 : _m.mainText) !== null && _o !== void 0 ? _o : i18next__WEBPACK_IMPORTED_MODULE_2__["t"]("result.winner3"),
                    subText1: (_q = (_p = thresholdsTexts[2]) === null || _p === void 0 ? void 0 : _p.subText) !== null && _q !== void 0 ? _q : i18next__WEBPACK_IMPORTED_MODULE_2__["t"]("result.winnerSubText"),
                },
            ],
            amountStyle: config.winAmountTextStyle,
            looserTexts: {
                mainText: (_r = looserTexts.mainText) !== null && _r !== void 0 ? _r : i18next__WEBPACK_IMPORTED_MODULE_2__["t"]("result.looser1"),
                subText1: (_s = looserTexts.subText1) !== null && _s !== void 0 ? _s : i18next__WEBPACK_IMPORTED_MODULE_2__["t"]("result.looser2"),
                subText2: (_t = looserTexts.subText2) !== null && _t !== void 0 ? _t : i18next__WEBPACK_IMPORTED_MODULE_2__["t"]("result.looser3"),
            },
            sounds: {
                loser: (config.sounds && config.sounds.loser) || null,
                winner: (config.sounds && config.sounds.winner) || null,
            },
            backgroundTexture: config.backgroundScratch,
            minimumFractionDigits: config.minimumFractionDigits,
        };
        if (config.thresholds !== undefined) {
            scratchConfig.winningThresholds = config.thresholds.map(function (c, i) {
                var _a, _b, _c, _d, _e, _f;
                return ({
                    amount: ((_a = c.multiplier) !== null && _a !== void 0 ? _a : 0) * stake.value,
                    mainText: (_c = (_b = thresholdsTexts[i]) === null || _b === void 0 ? void 0 : _b.mainText) !== null && _c !== void 0 ? _c : i18next__WEBPACK_IMPORTED_MODULE_2__["t"]("result.winner".concat(i)),
                    subText1: (_e = (_d = thresholdsTexts[i]) === null || _d === void 0 ? void 0 : _d.subText) !== null && _e !== void 0 ? _e : i18next__WEBPACK_IMPORTED_MODULE_2__["t"]("result.winnerSubText"),
                    duration: (_f = c.duration) !== null && _f !== void 0 ? _f : 3.4,
                });
            });
        }
        result.addStage(new _scratchStage__WEBPACK_IMPORTED_MODULE_7__["ScratchStage"](scratchConfig));
        return result;
    };
    /**
     * Returns a result box containing spines used for games using spines
     */
    ResultBox.createDefaultSpine = function (config, stake) {
        if (stake === void 0) { stake = _gdk_core__WEBPACK_IMPORTED_MODULE_4__["Amount"].fromNumber(100); }
        var result = new ResultBox();
        result.addStage(new _spineStage__WEBPACK_IMPORTED_MODULE_10__["SpineStage"](__assign({ thresholdsWinAmount: [Number(stake.value), 10 * stake.value, 49 * stake.value], winnerDuration: 5, loserDuration: 5, winEnterAnimationName: "enter", loseEnterAnimationName: "enter", winExitAnimationName: "exit", loseExitAnimationName: "exit", winMainText: config.winMainText
                ? config.winMainText
                : config.winSpineTimeline
                    .getSlotContainerByName("label_title")
                    .getChildByName("label"), winSubText: config.winSubText
                ? config.winSubText
                : config.winSpineTimeline
                    .getSlotContainerByName("label_text")
                    .getChildByName("label"), winAmountText: config.winAmountText
                ? config.winAmountText
                : config.winSpineTimeline
                    .getSlotContainerByName("label_amount")
                    .getChildByName("label"), loseMainText: config.loseMainText
                ? config.loseMainText
                : config.loseSpineTimeline
                    .getSlotContainerByName("label_title")
                    .getChildByName("label"), loseSubText: config.loseSubText
                ? config.loseSubText
                : config.loseSpineTimeline
                    .getSlotContainerByName("label_text")
                    .getChildByName("label") }, config)));
        return result;
    };
    ResultBox.prototype.export = function () {
        return _gdk_core__WEBPACK_IMPORTED_MODULE_4__["Tools"].assign(_gdk_core_pixi__WEBPACK_IMPORTED_MODULE_3__["ContainerExporter"].exportContainer(this, true), {
            type: "result.ResultBox",
            resultBox: __assign(__assign({}, (this.particleSystem !== null && { particleSystems: this.particleSystemConfig })), { stages: this.stages.map(function (stage) {
                    var type;
                    if (stage instanceof _amountCoinWizzStage__WEBPACK_IMPORTED_MODULE_8__["AmountCoinWizzStage"]) {
                        type = _amountCoinWizzStage__WEBPACK_IMPORTED_MODULE_8__["AmountCoinWizzStage"].name;
                    }
                    else if (stage instanceof _amountCurrencyWizzStage__WEBPACK_IMPORTED_MODULE_9__["AmountCurrencyWizzStage"]) {
                        type = _amountCurrencyWizzStage__WEBPACK_IMPORTED_MODULE_9__["AmountCurrencyWizzStage"].name;
                    }
                    else if (stage instanceof _amountResultStage__WEBPACK_IMPORTED_MODULE_6__["AmountResultStage"]) {
                        type = _amountResultStage__WEBPACK_IMPORTED_MODULE_6__["AmountResultStage"].name;
                    }
                    else if (stage instanceof _scratchStage__WEBPACK_IMPORTED_MODULE_7__["ScratchStage"]) {
                        type = _scratchStage__WEBPACK_IMPORTED_MODULE_7__["ScratchStage"].name;
                    }
                    else if (stage instanceof _spineStage__WEBPACK_IMPORTED_MODULE_10__["SpineStage"]) {
                        type = _spineStage__WEBPACK_IMPORTED_MODULE_10__["SpineStage"].name;
                    }
                    else if (stage instanceof _textResultStage__WEBPACK_IMPORTED_MODULE_5__["TextResultStage"]) {
                        type = _textResultStage__WEBPACK_IMPORTED_MODULE_5__["TextResultStage"].name;
                    }
                    return {
                        type: type,
                        config: stage.config,
                    };
                }) }),
        });
    };
    ResultBox.parse = function (config, baseUrl) {
        var e_3, _a;
        var resultBox = new ResultBox();
        var particleSystemConfig = config.resultBox.particleSystems;
        if (particleSystemConfig !== undefined) {
            resultBox.createParticles(particleSystemConfig.count, particleSystemConfig.sprites, {
                alpha: particleSystemConfig.alpha,
                scale: particleSystemConfig.scale,
                position: particleSystemConfig.position,
            });
        }
        try {
            for (var _b = __values(config.resultBox.stages), _c = _b.next(); !_c.done; _c = _b.next()) {
                var stage = _c.value;
                switch (stage.type) {
                    case _amountCoinWizzStage__WEBPACK_IMPORTED_MODULE_8__["AmountCoinWizzStage"].name:
                        resultBox.addStage(new _amountCoinWizzStage__WEBPACK_IMPORTED_MODULE_8__["AmountCoinWizzStage"](stage.config));
                        break;
                    case _amountCurrencyWizzStage__WEBPACK_IMPORTED_MODULE_9__["AmountCurrencyWizzStage"].name:
                        resultBox.addStage(new _amountCurrencyWizzStage__WEBPACK_IMPORTED_MODULE_9__["AmountCurrencyWizzStage"](stage.config));
                        break;
                    case _amountResultStage__WEBPACK_IMPORTED_MODULE_6__["AmountResultStage"].name:
                        resultBox.addStage(new _amountResultStage__WEBPACK_IMPORTED_MODULE_6__["AmountResultStage"](stage.config));
                        break;
                    case _scratchStage__WEBPACK_IMPORTED_MODULE_7__["ScratchStage"].name:
                        resultBox.addStage(new _scratchStage__WEBPACK_IMPORTED_MODULE_7__["ScratchStage"](stage.config));
                        break;
                    case _spineStage__WEBPACK_IMPORTED_MODULE_10__["SpineStage"].name:
                        resultBox.addStage(new _spineStage__WEBPACK_IMPORTED_MODULE_10__["SpineStage"](stage.config));
                        break;
                    case _textResultStage__WEBPACK_IMPORTED_MODULE_5__["TextResultStage"].name:
                        resultBox.addStage(new _textResultStage__WEBPACK_IMPORTED_MODULE_5__["TextResultStage"](stage.config));
                        break;
                }
            }
        }
        catch (e_3_1) { e_3 = { error: e_3_1 }; }
        finally {
            try {
                if (_c && !_c.done && (_a = _b.return)) _a.call(_b);
            }
            finally { if (e_3) throw e_3.error; }
        }
        resultBox = _gdk_core_pixi__WEBPACK_IMPORTED_MODULE_3__["ContainerImporter"].importContainer(config, baseUrl, resultBox);
        return resultBox;
    };
    return ResultBox;
}(pixi_js__WEBPACK_IMPORTED_MODULE_1__["Container"]));



/***/ }),

/***/ "./src/game/ui/result/resultStage.ts":
/*!*******************************************!*\
  !*** ./src/game/ui/result/resultStage.ts ***!
  \*******************************************/
/*! exports provided: ResultStage */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ResultStage", function() { return ResultStage; });
/* harmony import */ var pixi_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! pixi.js */ "pixi.js");
/* harmony import */ var pixi_js__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(pixi_js__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var gsap__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! gsap */ "gsap");
/* harmony import */ var gsap__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(gsap__WEBPACK_IMPORTED_MODULE_1__);
var __extends = (undefined && undefined.__extends) || (function () {
    var extendStatics = function (d, b) {
        extendStatics = Object.setPrototypeOf ||
            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||
            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };
        return extendStatics(d, b);
    };
    return function (d, b) {
        if (typeof b !== "function" && b !== null)
            throw new TypeError("Class extends value " + String(b) + " is not a constructor or null");
        extendStatics(d, b);
        function __() { this.constructor = d; }
        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
    };
})();


var ResultStage = /** @class */ (function (_super) {
    __extends(ResultStage, _super);
    function ResultStage() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    /**
     * Hide the stage
     * @param progressive: If true, stage is hidden in 0.3s, otherwise in 0s.
     */
    ResultStage.prototype.onHide = function (progressive) {
        var _this = this;
        if (!progressive) {
            this.hide();
            return Promise.resolve();
        }
        return new Promise(function (resolve) {
            gsap__WEBPACK_IMPORTED_MODULE_1__["TweenMax"].to(_this, 0.3, {
                alpha: 0,
                onComplete: function () {
                    _this.hide();
                    resolve();
                },
            });
        });
    };
    /**
     * Hide the stage immediatly
     */
    ResultStage.prototype.hide = function () {
        this.visible = false;
        this.alpha = 1;
    };
    return ResultStage;
}(pixi_js__WEBPACK_IMPORTED_MODULE_0__["Container"]));



/***/ }),

/***/ "./src/game/ui/result/scratchStage.ts":
/*!********************************************!*\
  !*** ./src/game/ui/result/scratchStage.ts ***!
  \********************************************/
/*! exports provided: ScratchStage */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ScratchStage", function() { return ScratchStage; });
/* harmony import */ var pixi_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! pixi.js */ "pixi.js");
/* harmony import */ var pixi_js__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(pixi_js__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var _gdk_core_pixi__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @gdk/core-pixi */ "@gdk/core-pixi");
/* harmony import */ var _gdk_core_pixi__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(_gdk_core_pixi__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var _gdk_core__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @gdk/core */ "@gdk/core");
/* harmony import */ var _gdk_core__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(_gdk_core__WEBPACK_IMPORTED_MODULE_2__);
/* harmony import */ var gsap__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! gsap */ "gsap");
/* harmony import */ var gsap__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(gsap__WEBPACK_IMPORTED_MODULE_3__);
/* harmony import */ var howler__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! howler */ "howler");
/* harmony import */ var howler__WEBPACK_IMPORTED_MODULE_4___default = /*#__PURE__*/__webpack_require__.n(howler__WEBPACK_IMPORTED_MODULE_4__);
/* harmony import */ var _resultStage__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./resultStage */ "./src/game/ui/result/resultStage.ts");
/* harmony import */ var _resultBox__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./resultBox */ "./src/game/ui/result/resultBox.ts");
var __extends = (undefined && undefined.__extends) || (function () {
    var extendStatics = function (d, b) {
        extendStatics = Object.setPrototypeOf ||
            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||
            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };
        return extendStatics(d, b);
    };
    return function (d, b) {
        if (typeof b !== "function" && b !== null)
            throw new TypeError("Class extends value " + String(b) + " is not a constructor or null");
        extendStatics(d, b);
        function __() { this.constructor = d; }
        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
    };
})();







var ScratchStage = /** @class */ (function (_super) {
    __extends(ScratchStage, _super);
    function ScratchStage(config) {
        var _this = _super.call(this) || this;
        // Get texture from config or set default texture
        var backgroundTexture = config.backgroundTexture.winner || "sp_popup_fin_00.png";
        _this.background = pixi_js__WEBPACK_IMPORTED_MODULE_0__["Sprite"].fromFrame(backgroundTexture);
        // Main text
        if (config.mainTextLooser instanceof pixi_js__WEBPACK_IMPORTED_MODULE_0__["Container"]) {
            _this.mainText = config.mainTextLooser;
        }
        else {
            _this.mainText = new _gdk_core_pixi__WEBPACK_IMPORTED_MODULE_1__["TextArea"]("", config.mainTextLooser);
            _this.mainText.docking = new _gdk_core_pixi__WEBPACK_IMPORTED_MODULE_1__["Docking"](_gdk_core_pixi__WEBPACK_IMPORTED_MODULE_1__["Docking"].centerAll);
        }
        // Sub text 1
        if (config.subText1Looser instanceof pixi_js__WEBPACK_IMPORTED_MODULE_0__["Container"]) {
            _this.subText1 = config.subText1Looser;
        }
        else {
            _this.subText1 = new _gdk_core_pixi__WEBPACK_IMPORTED_MODULE_1__["TextArea"]("", config.subText1Looser);
            _this.subText1.docking = new _gdk_core_pixi__WEBPACK_IMPORTED_MODULE_1__["Docking"](_gdk_core_pixi__WEBPACK_IMPORTED_MODULE_1__["Docking"].centerAll);
        }
        // Sub text 2
        if (config.subText2Looser instanceof pixi_js__WEBPACK_IMPORTED_MODULE_0__["Container"]) {
            _this.subText2 = config.subText2Looser;
        }
        else {
            _this.subText2 = new _gdk_core_pixi__WEBPACK_IMPORTED_MODULE_1__["TextArea"]("", config.subText2Looser);
            _this.subText2.docking = new _gdk_core_pixi__WEBPACK_IMPORTED_MODULE_1__["Docking"](_gdk_core_pixi__WEBPACK_IMPORTED_MODULE_1__["Docking"].centerAll);
        }
        // Amount
        _this._amount = new _gdk_core_pixi__WEBPACK_IMPORTED_MODULE_1__["TextArea"]("", config.amountStyle);
        _this._amount.docking = new _gdk_core_pixi__WEBPACK_IMPORTED_MODULE_1__["Docking"](_gdk_core_pixi__WEBPACK_IMPORTED_MODULE_1__["Docking"].centerAll);
        // Sounds
        config.sounds = config.sounds || {};
        if (typeof config.sounds.loser === "string") {
            _this._loseSound = _gdk_core__WEBPACK_IMPORTED_MODULE_2__["Loader"].get(config.sounds.loser);
        }
        else if (config.sounds.loser instanceof howler__WEBPACK_IMPORTED_MODULE_4__["Howl"]) {
            _this._loseSound = config.sounds.loser;
        }
        if (typeof config.sounds.winner === "string") {
            _this._winSound = _gdk_core__WEBPACK_IMPORTED_MODULE_2__["Loader"].get(config.sounds.winner);
        }
        else if (config.sounds.winner instanceof howler__WEBPACK_IMPORTED_MODULE_4__["Howl"]) {
            _this._winSound = config.sounds.winner;
        }
        // Misc.
        _this.config = config;
        _this.docking = new _gdk_core_pixi__WEBPACK_IMPORTED_MODULE_1__["Docking"](_gdk_core_pixi__WEBPACK_IMPORTED_MODULE_1__["Docking"].centerAll);
        _this.dockingBounds = new _gdk_core_pixi__WEBPACK_IMPORTED_MODULE_1__["DockingBounds"](_this.background.width, _this.background.height);
        _this.visible = false;
        return _this;
    }
    /**
     * onShow
     * @param box
     * @param done
     */
    ScratchStage.prototype.onShow = function (box, done) {
        var _this = this;
        var _a, _b;
        var duration = 3.4;
        if (box.amount.value === 0) {
            // Looser
            this.subText2.visible = true;
            this._amount.visible = false;
            if (this.config.backgroundTexture.loser) {
                this.background = pixi_js__WEBPACK_IMPORTED_MODULE_0__["Sprite"].fromFrame(this.config.backgroundTexture.loser);
                this.background.docking = new _gdk_core_pixi__WEBPACK_IMPORTED_MODULE_1__["Docking"](_gdk_core_pixi__WEBPACK_IMPORTED_MODULE_1__["Docking"].centerAll);
            }
            if (this.mainText instanceof _gdk_core_pixi__WEBPACK_IMPORTED_MODULE_1__["TextArea"]) {
                this.mainText.text = this.config.looserTexts.mainText;
                this.mainText.styles = this.config.mainTextLooser;
            }
            if (this.subText1 instanceof _gdk_core_pixi__WEBPACK_IMPORTED_MODULE_1__["TextArea"]) {
                this.subText1.text = this.config.looserTexts.subText1;
                this.subText1.styles = this.config.subText1Looser;
            }
            if (this.subText2 instanceof _gdk_core_pixi__WEBPACK_IMPORTED_MODULE_1__["TextArea"]) {
                this.subText2.text = this.config.looserTexts.subText2;
                this.subText2.styles = this.config.subText2Looser;
            }
            if (this._loseSound) {
                this._loseSound.play();
            }
            duration = (_a = this.config.looserDuration) !== null && _a !== void 0 ? _a : 3.4;
        }
        else {
            // Winner
            this.subText2.visible = false;
            this._amount.visible = true;
            this._amount.text = _gdk_core__WEBPACK_IMPORTED_MODULE_2__["Numeral"].currency(new _gdk_core__WEBPACK_IMPORTED_MODULE_2__["Amount"](box.amount.value), {
                minimumFractionDigits: (_b = this.config.minimumFractionDigits) !== null && _b !== void 0 ? _b : 2,
            });
            if (this.config.backgroundTexture.winner) {
                this.background = pixi_js__WEBPACK_IMPORTED_MODULE_0__["Sprite"].fromFrame(this.config.backgroundTexture.winner);
                this.background.docking = new _gdk_core_pixi__WEBPACK_IMPORTED_MODULE_1__["Docking"](_gdk_core_pixi__WEBPACK_IMPORTED_MODULE_1__["Docking"].centerAll);
            }
            // Set text
            if (this.mainText instanceof _gdk_core_pixi__WEBPACK_IMPORTED_MODULE_1__["TextArea"]) {
                this.mainText.text = this.config.winningThresholds[0].mainText;
            }
            if (this.subText1 instanceof _gdk_core_pixi__WEBPACK_IMPORTED_MODULE_1__["TextArea"]) {
                this.subText1.text = this.config.winningThresholds[0].subText1;
            }
            this.config.winningThresholds.forEach(function (t) {
                var _a;
                if (box.amount.value >= t.amount) {
                    if (_this.mainText instanceof _gdk_core_pixi__WEBPACK_IMPORTED_MODULE_1__["TextArea"]) {
                        _this.mainText.text = t.mainText;
                    }
                    if (_this.subText1 instanceof _gdk_core_pixi__WEBPACK_IMPORTED_MODULE_1__["TextArea"]) {
                        _this.subText1.text = t.subText1;
                    }
                    duration = (_a = t.duration) !== null && _a !== void 0 ? _a : duration;
                }
            });
            // Set styles
            if (this.mainText instanceof _gdk_core_pixi__WEBPACK_IMPORTED_MODULE_1__["TextArea"]) {
                this.mainText.styles = this.config.mainTextWinner;
            }
            else {
                this.mainText = this.config.mainTextWinner;
            }
            if (this.subText1 instanceof _gdk_core_pixi__WEBPACK_IMPORTED_MODULE_1__["TextArea"]) {
                this.subText1.styles = this.config.subText1Winner;
            }
            else {
                this.subText1 = this.config.subText1Winner;
            }
            if (this._winSound) {
                this._winSound.play();
            }
        }
        // Add children
        this.addChild(this.background);
        this.addChild(this.mainText);
        this.addChild(this.subText1);
        this.addChild(this.subText2);
        this.addChild(this._amount);
        // Set positions of texts
        this.mainText.docking.y = -this.subText1.height * 1.5;
        this.subText2.docking.y = this.subText1.height;
        this._amount.docking.y = this.subText1.height * 1.5;
        this.scaleXY = 0;
        // Show popup and hide it after 2 seconds
        gsap__WEBPACK_IMPORTED_MODULE_3__["TweenMax"].to(this, 0.7, {
            scaleXY: 1,
            ease: gsap__WEBPACK_IMPORTED_MODULE_3__["Back"].easeOut.config(1.7),
            onComplete: function () {
                box.emit(_resultBox__WEBPACK_IMPORTED_MODULE_6__["EResultBoxEvents"].StageHasEntered, _this);
                if (_this.config.disappears === false) {
                    done(true);
                    return;
                }
                gsap__WEBPACK_IMPORTED_MODULE_3__["TweenMax"].to(_this, 0.7, {
                    delay: duration - 1.4,
                    scaleXY: 0,
                    ease: gsap__WEBPACK_IMPORTED_MODULE_3__["Back"].easeIn.config(1.7),
                    onStart: function () {
                        box.emit(_resultBox__WEBPACK_IMPORTED_MODULE_6__["EResultBoxEvents"].StageWillExit, _this);
                    },
                    onComplete: function () {
                        done(true);
                    },
                });
            },
        });
    };
    /**
     * Hide the stage
     * @param progressive: If true, stage is hidden in 0.3s, otherwise in 0s.
     */
    ScratchStage.prototype.onHide = function (progressive) {
        if (this.config.disappears === false) {
            return Promise.resolve();
        }
        return _super.prototype.onHide.call(this, progressive);
    };
    return ScratchStage;
}(_resultStage__WEBPACK_IMPORTED_MODULE_5__["ResultStage"]));



/***/ }),

/***/ "./src/game/ui/result/spineStage.ts":
/*!******************************************!*\
  !*** ./src/game/ui/result/spineStage.ts ***!
  \******************************************/
/*! exports provided: SpineStage */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "SpineStage", function() { return SpineStage; });
/* harmony import */ var _gdk_core_pixi__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @gdk/core-pixi */ "@gdk/core-pixi");
/* harmony import */ var _gdk_core_pixi__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_gdk_core_pixi__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var _gdk_core__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @gdk/core */ "@gdk/core");
/* harmony import */ var _gdk_core__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(_gdk_core__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var _resultStage__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./resultStage */ "./src/game/ui/result/resultStage.ts");
var __extends = (undefined && undefined.__extends) || (function () {
    var extendStatics = function (d, b) {
        extendStatics = Object.setPrototypeOf ||
            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||
            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };
        return extendStatics(d, b);
    };
    return function (d, b) {
        if (typeof b !== "function" && b !== null)
            throw new TypeError("Class extends value " + String(b) + " is not a constructor or null");
        extendStatics(d, b);
        function __() { this.constructor = d; }
        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
    };
})();
var __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};
var __generator = (undefined && undefined.__generator) || function (thisArg, body) {
    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;
    return g = { next: verb(0), "throw": verb(1), "return": verb(2) }, typeof Symbol === "function" && (g[Symbol.iterator] = function() { return this; }), g;
    function verb(n) { return function (v) { return step([n, v]); }; }
    function step(op) {
        if (f) throw new TypeError("Generator is already executing.");
        while (g && (g = 0, op[0] && (_ = 0)), _) try {
            if (f = 1, y && (t = op[0] & 2 ? y["return"] : op[0] ? y["throw"] || ((t = y["return"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;
            if (y = 0, t) op = [op[0] & 2, t.value];
            switch (op[0]) {
                case 0: case 1: t = op; break;
                case 4: _.label++; return { value: op[1], done: false };
                case 5: _.label++; y = op[1]; op = [0]; continue;
                case 7: op = _.ops.pop(); _.trys.pop(); continue;
                default:
                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }
                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }
                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }
                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }
                    if (t[2]) _.ops.pop();
                    _.trys.pop(); continue;
            }
            op = body.call(thisArg, _);
        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }
        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };
    }
};



var SpineStage = /** @class */ (function (_super) {
    __extends(SpineStage, _super);
    /* LIFECYCLE */
    /**
     * @constructor
     * @param config Configuration of the stage
     */
    function SpineStage(config) {
        var _this = _super.call(this) || this;
        _this.config = config;
        _this.reset();
        return _this;
    }
    /**
     * onShow
     * @param box
     * @param done
     */
    SpineStage.prototype.onShow = function (box, done) {
        return __awaiter(this, void 0, void 0, function () {
            var isWin, i, thresholdWinAmount, thresholdText, enterAnimation;
            var _this = this;
            return __generator(this, function (_a) {
                isWin = box.amount.value > 0;
                if (isWin) {
                    this.config.winAmountText.text = _gdk_core__WEBPACK_IMPORTED_MODULE_1__["Numeral"].currency(box.amount, {
                        minimumFractionDigits: 2,
                    });
                    for (i = this.config.thresholdsWinAmount.length - 1; i >= 0; i--) {
                        thresholdWinAmount = this.config.thresholdsWinAmount[i];
                        thresholdText = this.config.thresholdsTexts[i];
                        if (thresholdText && box.amount.value >= thresholdWinAmount) {
                            this.config.winMainText.text = thresholdText.mainText;
                            this.config.winSubText.text = thresholdText.subText;
                            break;
                        }
                    }
                }
                else {
                    this.config.loseMainText.text = this.config.looserTexts.mainText;
                    this.config.loseSubText.text = this.config.looserTexts.subText;
                }
                enterAnimation = isWin
                    ? this.config.winSpineTimeline.playDirect(this.config.winEnterAnimationName)
                    : this.config.loseSpineTimeline.playDirect(this.config.loseEnterAnimationName);
                enterAnimation
                    .then(function () { return Object(_gdk_core_pixi__WEBPACK_IMPORTED_MODULE_0__["pDelayedCall"])(isWin ? _this.config.winnerDuration : _this.config.loserDuration); })
                    .then(function () {
                    return isWin
                        ? _this.config.winSpineTimeline.playDirect(_this.config.winExitAnimationName)
                        : _this.config.loseSpineTimeline.playDirect(_this.config.loseExitAnimationName);
                })
                    .then(function () {
                    done(true);
                });
                this.config.winSpineTimeline.visible = isWin;
                this.config.loseSpineTimeline.visible = !isWin;
                return [2 /*return*/];
            });
        });
    };
    /* PUBLIC METHODS */
    /**
     * Reset the stage
     */
    SpineStage.prototype.reset = function () {
        this.config.winSpineTimeline.visible = false;
        this.config.loseSpineTimeline.visible = false;
    };
    return SpineStage;
}(_resultStage__WEBPACK_IMPORTED_MODULE_2__["ResultStage"]));



/***/ }),

/***/ "./src/game/ui/result/textResultStage.ts":
/*!***********************************************!*\
  !*** ./src/game/ui/result/textResultStage.ts ***!
  \***********************************************/
/*! exports provided: TextResultStage */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "TextResultStage", function() { return TextResultStage; });
/* harmony import */ var pixi_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! pixi.js */ "pixi.js");
/* harmony import */ var pixi_js__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(pixi_js__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var _gdk_core_pixi__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @gdk/core-pixi */ "@gdk/core-pixi");
/* harmony import */ var _gdk_core_pixi__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(_gdk_core_pixi__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var _gdk_core__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @gdk/core */ "@gdk/core");
/* harmony import */ var _gdk_core__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(_gdk_core__WEBPACK_IMPORTED_MODULE_2__);
/* harmony import */ var gsap__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! gsap */ "gsap");
/* harmony import */ var gsap__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(gsap__WEBPACK_IMPORTED_MODULE_3__);
/* harmony import */ var howler__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! howler */ "howler");
/* harmony import */ var howler__WEBPACK_IMPORTED_MODULE_4___default = /*#__PURE__*/__webpack_require__.n(howler__WEBPACK_IMPORTED_MODULE_4__);
/* harmony import */ var _resultStage__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./resultStage */ "./src/game/ui/result/resultStage.ts");
/* harmony import */ var _resultBox__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./resultBox */ "./src/game/ui/result/resultBox.ts");
var __extends = (undefined && undefined.__extends) || (function () {
    var extendStatics = function (d, b) {
        extendStatics = Object.setPrototypeOf ||
            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||
            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };
        return extendStatics(d, b);
    };
    return function (d, b) {
        if (typeof b !== "function" && b !== null)
            throw new TypeError("Class extends value " + String(b) + " is not a constructor or null");
        extendStatics(d, b);
        function __() { this.constructor = d; }
        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
    };
})();







var TextResultStage = /** @class */ (function (_super) {
    __extends(TextResultStage, _super);
    /**
     * Constructor
     */
    function TextResultStage(config) {
        var _this = _super.call(this) || this;
        // Main text
        if (config.mainTextLooser instanceof pixi_js__WEBPACK_IMPORTED_MODULE_0__["Container"]) {
            _this.mainText = config.mainTextLooser;
        }
        else {
            _this.mainText = new _gdk_core_pixi__WEBPACK_IMPORTED_MODULE_1__["TextArea"]("", config.mainTextLooser, { align: _gdk_core_pixi__WEBPACK_IMPORTED_MODULE_1__["EAlign"].Center });
            _this.mainText.docking = new _gdk_core_pixi__WEBPACK_IMPORTED_MODULE_1__["Docking"](_gdk_core_pixi__WEBPACK_IMPORTED_MODULE_1__["Docking"].centerAll);
        }
        // Sub text 1
        if (config.subText1Looser instanceof pixi_js__WEBPACK_IMPORTED_MODULE_0__["Container"]) {
            _this.subText1 = config.subText1Looser;
        }
        else {
            _this.subText1 = new _gdk_core_pixi__WEBPACK_IMPORTED_MODULE_1__["TextArea"]("", config.subText1Looser, { align: _gdk_core_pixi__WEBPACK_IMPORTED_MODULE_1__["EAlign"].Center });
            _this.subText1.docking = new _gdk_core_pixi__WEBPACK_IMPORTED_MODULE_1__["Docking"](_gdk_core_pixi__WEBPACK_IMPORTED_MODULE_1__["Docking"].centerAll);
        }
        // Sub text 2
        if (config.subText2Looser instanceof pixi_js__WEBPACK_IMPORTED_MODULE_0__["Container"]) {
            _this.subText2 = config.subText2Looser;
        }
        else {
            _this.subText2 = new _gdk_core_pixi__WEBPACK_IMPORTED_MODULE_1__["TextArea"]("", config.subText2Looser, { align: _gdk_core_pixi__WEBPACK_IMPORTED_MODULE_1__["EAlign"].Center });
            _this.subText2.docking = new _gdk_core_pixi__WEBPACK_IMPORTED_MODULE_1__["Docking"](_gdk_core_pixi__WEBPACK_IMPORTED_MODULE_1__["Docking"].centerAll);
        }
        // Sounds
        config.sounds = config.sounds || {};
        if (typeof config.sounds.loser === "string") {
            _this._loseSound = _gdk_core__WEBPACK_IMPORTED_MODULE_2__["Loader"].get(config.sounds.loser);
        }
        else if (config.sounds.loser instanceof howler__WEBPACK_IMPORTED_MODULE_4__["Howl"]) {
            _this._loseSound = config.sounds.loser;
        }
        if (typeof config.sounds.winner === "string") {
            _this._winSound = _gdk_core__WEBPACK_IMPORTED_MODULE_2__["Loader"].get(config.sounds.winner);
        }
        else if (config.sounds.winner instanceof howler__WEBPACK_IMPORTED_MODULE_4__["Howl"]) {
            _this._winSound = config.sounds.winner;
        }
        // Misc.
        _this.config = config;
        _this.dockAsPoint = true;
        _this.visible = false;
        return _this;
    }
    /**
     * On show the result box
     * @param box the result box reference
     * @param done the callback to call when stage animation done
     */
    TextResultStage.prototype.onShow = function (box, done) {
        var _this = this;
        var animated = true;
        var duration = 2;
        // Set texts
        if (box.amount.value === 0) {
            this.subText2.visible = true;
            // Looser
            if (this.mainText instanceof _gdk_core_pixi__WEBPACK_IMPORTED_MODULE_1__["TextArea"]) {
                this.mainText.freeze();
                this.mainText.keepCanvasReference = true;
                this.mainText.text = this.config.looserTexts.mainText;
                this.mainText.styles = this.config.mainTextLooser;
                this.mainText.unfreeze();
            }
            if (this.subText1 instanceof _gdk_core_pixi__WEBPACK_IMPORTED_MODULE_1__["TextArea"]) {
                this.subText1.freeze();
                this.subText1.keepCanvasReference = true;
                this.subText1.text = this.config.looserTexts.subText1;
                this.subText1.styles = this.config.subText1Looser;
                this.subText1.unfreeze();
            }
            if (this.subText2 instanceof _gdk_core_pixi__WEBPACK_IMPORTED_MODULE_1__["TextArea"]) {
                this.subText2.freeze();
                this.subText2.keepCanvasReference = true;
                this.subText2.text = this.config.looserTexts.subText2;
                this.subText2.styles = this.config.subText2Looser;
                this.subText2.unfreeze();
            }
            if (this._loseSound) {
                this._loseSound.play();
            }
            duration = this.config.looserDuration;
        }
        else {
            // Winner
            this.subText2.visible = false;
            // Set text
            if (this.mainText instanceof _gdk_core_pixi__WEBPACK_IMPORTED_MODULE_1__["TextArea"]) {
                this.mainText.freeze();
                this.mainText.keepCanvasReference = true;
                this.mainText.text = this.config.winningThresholds[0].mainText;
            }
            if (this.subText1 instanceof _gdk_core_pixi__WEBPACK_IMPORTED_MODULE_1__["TextArea"]) {
                this.subText1.freeze();
                this.subText1.text = this.config.winningThresholds[0].subText1;
            }
            this.config.winningThresholds.forEach(function (t) {
                var _a, _b;
                if (box.amount.value >= t.amount) {
                    if (_this.mainText instanceof _gdk_core_pixi__WEBPACK_IMPORTED_MODULE_1__["TextArea"]) {
                        _this.mainText.text = t.mainText;
                    }
                    if (_this.subText1 instanceof _gdk_core_pixi__WEBPACK_IMPORTED_MODULE_1__["TextArea"]) {
                        _this.subText1.text = t.subText1;
                    }
                    duration = (_a = t.duration) !== null && _a !== void 0 ? _a : 2;
                    animated = (_b = t.animated) !== null && _b !== void 0 ? _b : true;
                }
            });
            // Set styles
            if (this.mainText instanceof _gdk_core_pixi__WEBPACK_IMPORTED_MODULE_1__["TextArea"]) {
                this.mainText.styles = this.config.mainTextWinner;
                this.mainText.unfreeze();
            }
            else {
                this.mainText = this.config.mainTextWinner;
            }
            if (this.subText1 instanceof _gdk_core_pixi__WEBPACK_IMPORTED_MODULE_1__["TextArea"]) {
                this.subText1.styles = this.config.subText1Winner;
                this.subText1.unfreeze();
            }
            else {
                this.subText1 = this.config.subText1Winner;
            }
            if (this._winSound) {
                this._winSound.play();
            }
        }
        // Add children
        this.addChild(this.mainText);
        this.addChild(this.subText1);
        this.addChild(this.subText2);
        // Set texts scale to 1.0
        this.mainText.scaleXY = 1;
        this.subText2.scaleXY = 1;
        this.subText1.scaleXY = 1;
        // Set positions of texts
        this.mainText.docking.y = -this.subText1.height;
        this.subText1.docking.y = 0;
        this.subText2.docking.y = this.subText1.height;
        // Pivot of texts
        this.mainText.pivot.x = this.mainText.width / 2;
        this.mainText.pivot.y = this.mainText.height / 2;
        this.subText1.pivot.x = this.subText1.width / 2;
        this.subText1.pivot.y = this.subText1.height / 2;
        this.subText2.pivot.x = this.subText2.width / 2;
        this.subText2.pivot.y = this.subText2.height / 2;
        if (!animated) {
            this.mainText.docking.y -= 50;
            this.subText1.docking.y -= 50;
            this.subText2.docking.y -= 50;
            done(false, false);
            return;
        }
        this.animate(box, duration, done);
    };
    TextResultStage.prototype.animate = function (box, duration, done) {
        var _this = this;
        // Reset texts scale
        this.mainText.scaleXY = 0;
        this.subText2.scaleXY = 0;
        this.subText1.scaleXY = 0;
        // ScaleXY from 0 to 1
        gsap__WEBPACK_IMPORTED_MODULE_3__["TweenMax"].to(this.mainText, 0.25 * duration, {
            scaleXY: 1,
            onComplete: function () {
                if (_this.mainText instanceof _gdk_core_pixi__WEBPACK_IMPORTED_MODULE_1__["TextArea"]) {
                    _this.mainText.keepCanvasReference = false;
                }
            },
        });
        gsap__WEBPACK_IMPORTED_MODULE_3__["TweenMax"].to(this.subText1, 0.25 * duration, {
            delay: 0.25 * duration,
            scaleXY: 1,
            onComplete: function () {
                if (_this.subText1 instanceof _gdk_core_pixi__WEBPACK_IMPORTED_MODULE_1__["TextArea"]) {
                    _this.subText1.keepCanvasReference = false;
                }
            },
        });
        gsap__WEBPACK_IMPORTED_MODULE_3__["TweenMax"].to(box.particleSystem, duration, {
            scaleXY: 1,
        });
        gsap__WEBPACK_IMPORTED_MODULE_3__["TweenMax"].to(this.subText2, 0.25 * duration, {
            delay: 0.25 * duration,
            scaleXY: 1,
            onComplete: function () {
                if (_this.subText2 instanceof _gdk_core_pixi__WEBPACK_IMPORTED_MODULE_1__["TextArea"]) {
                    _this.subText2.keepCanvasReference = false;
                }
                box.emit(_resultBox__WEBPACK_IMPORTED_MODULE_6__["EResultBoxEvents"].StageHasEntered, _this);
                gsap__WEBPACK_IMPORTED_MODULE_3__["TweenMax"].to(box.particleSystem, 0.25 * duration, {
                    delay: 0.25 * duration,
                    scaleXY: 0,
                });
                if (box.amount.value === 0 && _this.config.looserTexts.disappears === false) {
                    done(true, false);
                    return;
                }
                // ScaleXY from 1 to 0
                gsap__WEBPACK_IMPORTED_MODULE_3__["TweenMax"].to(_this.mainText, 0.25 * duration, {
                    ease: gsap__WEBPACK_IMPORTED_MODULE_3__["Back"].easeIn.config(1.7),
                    delay: 0.25 * duration,
                    scaleXY: 0,
                });
                gsap__WEBPACK_IMPORTED_MODULE_3__["TweenMax"].to(_this.subText1, 0.25 * duration, {
                    ease: gsap__WEBPACK_IMPORTED_MODULE_3__["Back"].easeIn.config(1.7),
                    delay: 0.25 * duration,
                    scaleXY: 0,
                });
                gsap__WEBPACK_IMPORTED_MODULE_3__["TweenMax"].to(_this.subText2, 0.25 * duration, {
                    ease: gsap__WEBPACK_IMPORTED_MODULE_3__["Back"].easeIn.config(1.7),
                    delay: 0.25 * duration,
                    scaleXY: 0,
                    onStart: function () {
                        box.emit(_resultBox__WEBPACK_IMPORTED_MODULE_6__["EResultBoxEvents"].StageWillExit, _this);
                    },
                    onComplete: function () {
                        _this.removeChild(box.particleSystem);
                        done(box.amount.value === 0, true);
                    },
                });
            },
        });
    };
    return TextResultStage;
}(_resultStage__WEBPACK_IMPORTED_MODULE_5__["ResultStage"]));



/***/ }),

/***/ "./src/game/ui/rules/agreement.ts":
/*!****************************************!*\
  !*** ./src/game/ui/rules/agreement.ts ***!
  \****************************************/
/*! exports provided: AgreementSlide */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "AgreementSlide", function() { return AgreementSlide; });
/* harmony import */ var pixi_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! pixi.js */ "pixi.js");
/* harmony import */ var pixi_js__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(pixi_js__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var i18next__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! i18next */ "i18next");
/* harmony import */ var i18next__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(i18next__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var _gdk_core__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @gdk/core */ "@gdk/core");
/* harmony import */ var _gdk_core__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(_gdk_core__WEBPACK_IMPORTED_MODULE_2__);
/* harmony import */ var _gdk_core_pixi__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @gdk/core-pixi */ "@gdk/core-pixi");
/* harmony import */ var _gdk_core_pixi__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(_gdk_core_pixi__WEBPACK_IMPORTED_MODULE_3__);
/* harmony import */ var _index__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./index */ "./src/game/ui/rules/index.ts");
/* harmony import */ var _textSlide__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./textSlide */ "./src/game/ui/rules/textSlide.ts");
var __extends = (undefined && undefined.__extends) || (function () {
    var extendStatics = function (d, b) {
        extendStatics = Object.setPrototypeOf ||
            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||
            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };
        return extendStatics(d, b);
    };
    return function (d, b) {
        if (typeof b !== "function" && b !== null)
            throw new TypeError("Class extends value " + String(b) + " is not a constructor or null");
        extendStatics(d, b);
        function __() { this.constructor = d; }
        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
    };
})();






var AgreementSlide = /** @class */ (function (_super) {
    __extends(AgreementSlide, _super);
    /**
     * Constructor
     * @param com communication trigger
     * @param style slide style
     */
    function AgreementSlide(com, style) {
        var _this = _super.call(this, style) || this;
        /**
         * If the agreement slide should be auto-configured in the .configure method. True by default.
         */
        _this.autoConfigure = true;
        /**
         * The com trigger reference used to open general rules and game rules
         */
        _this.com = null;
        // Private members
        _this._gameRulePadding = {};
        _this._generalRulePadding = {};
        _this.com = com;
        _this.setName("rules:agreement");
        // OK Button
        _this.okButton =
            style.okButtonStyle instanceof _gdk_core_pixi__WEBPACK_IMPORTED_MODULE_3__["Button"]
                ? style.okButtonStyle
                : new _gdk_core_pixi__WEBPACK_IMPORTED_MODULE_3__["Button"](style.okButtonStyle).setName("rules:ok");
        _this.okButton.doNotExport = true;
        _this.okButton.docking = new _gdk_core_pixi__WEBPACK_IMPORTED_MODULE_3__["Docking"](_gdk_core_pixi__WEBPACK_IMPORTED_MODULE_3__["Docking"].bottomRight);
        // Links
        _this.generalRule =
            style.generalRuleStyle instanceof _gdk_core_pixi__WEBPACK_IMPORTED_MODULE_3__["TextField"]
                ? style.generalRuleStyle
                : new _gdk_core_pixi__WEBPACK_IMPORTED_MODULE_3__["TextField"](i18next__WEBPACK_IMPORTED_MODULE_1___default.a.t("rules.agreement.generalRule"), style.generalRuleStyle || style.text.style).setName("rules:agreement:generalRules");
        _this.generalRule.docking = new _gdk_core_pixi__WEBPACK_IMPORTED_MODULE_3__["Docking"](_gdk_core_pixi__WEBPACK_IMPORTED_MODULE_3__["Docking"].centerAll);
        _this.generalRule.interactive = true;
        _this.addChild(_this.generalRule);
        _this._generalRulePadding = _gdk_core__WEBPACK_IMPORTED_MODULE_2__["Tools"].assign(_this._generalRulePadding, style.generalRulePadding);
        _this.gameRule =
            style.gameRuleStyle instanceof _gdk_core_pixi__WEBPACK_IMPORTED_MODULE_3__["TextField"]
                ? style.gameRuleStyle
                : new _gdk_core_pixi__WEBPACK_IMPORTED_MODULE_3__["TextField"](i18next__WEBPACK_IMPORTED_MODULE_1___default.a.t("rules.agreement.gameRule"), style.gameRuleStyle || style.text.style).setName("rules:agreement:gameRules");
        _this.gameRule.docking = new _gdk_core_pixi__WEBPACK_IMPORTED_MODULE_3__["Docking"](_gdk_core_pixi__WEBPACK_IMPORTED_MODULE_3__["Docking"].centerAll);
        _this.gameRule.interactive = true;
        _this.addChild(_this.gameRule);
        _this._gameRulePadding = _gdk_core__WEBPACK_IMPORTED_MODULE_2__["Tools"].assign(_this._gameRulePadding, style.gameRulePadding);
        _this.generalRule.on("link", function () { return _this.com.trigger("GLOBAL_RULES"); });
        _this.gameRule.on("link", function () { return _this.com.trigger("GAME_RULES"); });
        return _this;
    }
    /**
     * Configures the slide in the given popup
     * @param rules the popup containing the slide
     */
    AgreementSlide.prototype.configure = function (rules) {
        // Add ok button which is not visible right now
        this.okButton.visible = false;
        rules.addChild(this.okButton);
        if (!this.autoConfigure) {
            return;
        }
        // Keep default behavior
        _super.prototype.configure.call(this, rules);
        // handle text padding layout
        if (this.layout === _index__WEBPACK_IMPORTED_MODULE_4__["ELayout"].TextPadding) {
            delete this.gameRule.docking;
            if (this._gameRulePadding.left !== undefined || this._gameRulePadding.right !== undefined) {
                this.gameRule.x = Object(_textSlide__WEBPACK_IMPORTED_MODULE_5__["getSlideStylePaddingValue"])(this._gameRulePadding.left, this);
                this.gameRule.width =
                    this.dockingBounds.width -
                        (Object(_textSlide__WEBPACK_IMPORTED_MODULE_5__["getSlideStylePaddingValue"])(this._gameRulePadding.right, this) - this.gameRule.x);
            }
            if (this._gameRulePadding.top !== undefined || this._gameRulePadding.bottom !== undefined) {
                this.gameRule.y = Object(_textSlide__WEBPACK_IMPORTED_MODULE_5__["getSlideStylePaddingValue"])(this._gameRulePadding.top, this);
                this.gameRule.height =
                    this.dockingBounds.height -
                        (Object(_textSlide__WEBPACK_IMPORTED_MODULE_5__["getSlideStylePaddingValue"])(this._gameRulePadding.bottom, this) - this.gameRule.y);
            }
            delete this.generalRule.docking;
            if (this._generalRulePadding.left !== undefined ||
                this._generalRulePadding.right !== undefined) {
                this.generalRule.x = Object(_textSlide__WEBPACK_IMPORTED_MODULE_5__["getSlideStylePaddingValue"])(this._generalRulePadding.left, this);
                this.generalRule.width =
                    this.dockingBounds.width -
                        (Object(_textSlide__WEBPACK_IMPORTED_MODULE_5__["getSlideStylePaddingValue"])(this._generalRulePadding.right, this) - this.gameRule.x);
            }
            if (this._generalRulePadding.top !== undefined ||
                this._generalRulePadding.bottom !== undefined) {
                this.generalRule.y = Object(_textSlide__WEBPACK_IMPORTED_MODULE_5__["getSlideStylePaddingValue"])(this._generalRulePadding.top, this);
                this.generalRule.height =
                    this.dockingBounds.height -
                        (Object(_textSlide__WEBPACK_IMPORTED_MODULE_5__["getSlideStylePaddingValue"])(this._generalRulePadding.bottom, this) - this.gameRule.y);
            }
            return;
        }
        // Reposition text
        this.text.docking.y = -this.generalRule.height / 2;
        // Place links
        this.generalRule.docking.y = this.text.height / 2;
        this.generalRule.docking.x = -this.dockingBounds.width / 2 + this.generalRule.width + 25;
        this.gameRule.docking.y = this.text.height / 2;
        this.gameRule.docking.x = this.dockingBounds.width / 2 - this.gameRule.width - 25;
    };
    /**
     * Called when showing the slide in the rules popup
     * @param rules the popup containing the slide
     */
    AgreementSlide.prototype.onShow = function (rules) {
        _super.prototype.onShow.call(this, rules);
        this.okButton.visible = true;
        rules.addChild(this.okButton);
        rules.nextButton.visible = false;
        rules.popup.closeButton.visible = false;
    };
    /**
     * Called when hiding the slide in the rules popup
     * @param rules the popup containing the slide
     */
    AgreementSlide.prototype.onHide = function (rules) {
        this.okButton.visible = false;
        rules.nextButton.visible = true;
        this.visible = false;
        rules.popup.closeButton.visible = true;
    };
    /**
     * On destroy the slide
     * @param rules the popup containing the slide
     */
    AgreementSlide.prototype.onDestroy = function (rules) {
        rules.removeChild(this.okButton);
        rules.nextButton.visible = true;
    };
    /**
     * Exports the agreement slide
     */
    AgreementSlide.prototype.export = function () {
        this.children.forEach(function (c) { return (c.doNotExport = true); });
        return _gdk_core__WEBPACK_IMPORTED_MODULE_2__["Tools"].assign(_gdk_core_pixi__WEBPACK_IMPORTED_MODULE_3__["ContainerExporter"].exportContainer(this), {
            type: "rules.AgreementSlide",
            hasBullet: this.hasBullet,
            agreement: {
                okButtonStyle: this.okButton.export(),
                generalRuleStyle: this.generalRule.export(),
                gameRuleStyle: this.gameRule.export(),
                text: this.text.export(),
                title: this.title.export(),
            },
        });
    };
    /**
     * Creates a new agremment slide. Function used by project loader
     * @param config the serialized data
     * @param baseUrl the base url of the loader
     */
    AgreementSlide.parse = function (config, baseUrl) {
        var slide = new AgreementSlide(null, {
            // Minimal configuration
            okButtonStyle: {
                clickedTexture: pixi_js__WEBPACK_IMPORTED_MODULE_0__["Texture"].WHITE,
                idleTexture: pixi_js__WEBPACK_IMPORTED_MODULE_0__["Texture"].WHITE,
                overTexture: pixi_js__WEBPACK_IMPORTED_MODULE_0__["Texture"].WHITE,
                disabledTexture: pixi_js__WEBPACK_IMPORTED_MODULE_0__["Texture"].WHITE,
            },
            text: {
                style: config.agreement.text.styles,
            },
        });
        slide.autoConfigure = false;
        _gdk_core_pixi__WEBPACK_IMPORTED_MODULE_3__["Button"].parse(config.agreement.okButtonStyle, baseUrl, slide.okButton);
        _gdk_core_pixi__WEBPACK_IMPORTED_MODULE_3__["ContainerImporter"].import(config.agreement.title, baseUrl, slide.title);
        _gdk_core_pixi__WEBPACK_IMPORTED_MODULE_3__["ContainerImporter"].import(config.agreement.text, baseUrl, slide.text);
        _gdk_core_pixi__WEBPACK_IMPORTED_MODULE_3__["ContainerImporter"].import(config.agreement.generalRuleStyle, baseUrl, slide.generalRule);
        _gdk_core_pixi__WEBPACK_IMPORTED_MODULE_3__["ContainerImporter"].import(config.agreement.gameRuleStyle, baseUrl, slide.gameRule);
        _gdk_core_pixi__WEBPACK_IMPORTED_MODULE_3__["ContainerImporter"].importContainer(config, baseUrl, slide);
        if (config.hasBullet !== undefined) {
            slide.hasBullet = config.hasBullet;
        }
        return slide;
    };
    return AgreementSlide;
}(_index__WEBPACK_IMPORTED_MODULE_4__["TextSlide"]));



/***/ }),

/***/ "./src/game/ui/rules/baseSlide.ts":
/*!****************************************!*\
  !*** ./src/game/ui/rules/baseSlide.ts ***!
  \****************************************/
/*! exports provided: BaseSlide */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "BaseSlide", function() { return BaseSlide; });
/* harmony import */ var _gdk_core_pixi__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @gdk/core-pixi */ "@gdk/core-pixi");
/* harmony import */ var _gdk_core_pixi__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_gdk_core_pixi__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var _gdk_core__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @gdk/core */ "@gdk/core");
/* harmony import */ var _gdk_core__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(_gdk_core__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var _slide__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./slide */ "./src/game/ui/rules/slide.ts");
var __extends = (undefined && undefined.__extends) || (function () {
    var extendStatics = function (d, b) {
        extendStatics = Object.setPrototypeOf ||
            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||
            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };
        return extendStatics(d, b);
    };
    return function (d, b) {
        if (typeof b !== "function" && b !== null)
            throw new TypeError("Class extends value " + String(b) + " is not a constructor or null");
        extendStatics(d, b);
        function __() { this.constructor = d; }
        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
    };
})();



var BaseSlide = /** @class */ (function (_super) {
    __extends(BaseSlide, _super);
    /**
     * Constructor
     */
    function BaseSlide() {
        // PIXI.Container
        return _super.call(this) || this;
    }
    /**
     * Configures the slide in the given popup
     * @param rules the popup containing the slide
     */
    BaseSlide.prototype.configure = function (rules) {
        // Misc.
        this.dockingBounds = new _gdk_core_pixi__WEBPACK_IMPORTED_MODULE_0__["DockingBounds"](rules.dockingBounds.width, rules.dockingBounds.height);
    };
    /**
     * Called when showing the slide in the rules popup
     * @param rules the popup containing the slide
     */
    BaseSlide.prototype.onShow = function (rules) {
        _super.prototype.onShow.call(this, rules);
    };
    /**
     * Called when hiding the slide in the rules popup
     * @param rules the popup containing the slide
     */
    BaseSlide.prototype.onHide = function (rules) {
        _super.prototype.onHide.call(this, rules);
    };
    /**
     * Exports the base slide
     */
    BaseSlide.prototype.export = function () {
        return _gdk_core__WEBPACK_IMPORTED_MODULE_1__["Tools"].assign(_gdk_core_pixi__WEBPACK_IMPORTED_MODULE_0__["ContainerExporter"].exportContainer(this), {
            type: "rules.BaseSlide",
            hasBullet: this.hasBullet,
        });
    };
    /**
     * Creates a new base slide. Function used by project loader
     * @param config the JSON representation of the save slide.
     * @param baseUrl the base Url where to find other assets if needed to be loaded incrementally.
     */
    BaseSlide.parse = function (config, baseUrl) {
        var slide = new BaseSlide();
        if (config.hasBullet !== undefined) {
            slide.hasBullet = config.hasBullet;
        }
        return slide;
    };
    return BaseSlide;
}(_slide__WEBPACK_IMPORTED_MODULE_2__["Slide"]));



/***/ }),

/***/ "./src/game/ui/rules/index.ts":
/*!************************************!*\
  !*** ./src/game/ui/rules/index.ts ***!
  \************************************/
/*! exports provided: Rules, Slide, TextSlide, ELayout, BaseSlide, AgreementSlide */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _rules__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./rules */ "./src/game/ui/rules/rules.ts");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "Rules", function() { return _rules__WEBPACK_IMPORTED_MODULE_0__["Rules"]; });

/* harmony import */ var _slide__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./slide */ "./src/game/ui/rules/slide.ts");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "Slide", function() { return _slide__WEBPACK_IMPORTED_MODULE_1__["Slide"]; });

/* harmony import */ var _textSlide__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./textSlide */ "./src/game/ui/rules/textSlide.ts");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "TextSlide", function() { return _textSlide__WEBPACK_IMPORTED_MODULE_2__["TextSlide"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "ELayout", function() { return _textSlide__WEBPACK_IMPORTED_MODULE_2__["ELayout"]; });

/* harmony import */ var _baseSlide__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./baseSlide */ "./src/game/ui/rules/baseSlide.ts");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "BaseSlide", function() { return _baseSlide__WEBPACK_IMPORTED_MODULE_3__["BaseSlide"]; });

/* harmony import */ var _agreement__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./agreement */ "./src/game/ui/rules/agreement.ts");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "AgreementSlide", function() { return _agreement__WEBPACK_IMPORTED_MODULE_4__["AgreementSlide"]; });








/***/ }),

/***/ "./src/game/ui/rules/rules.ts":
/*!************************************!*\
  !*** ./src/game/ui/rules/rules.ts ***!
  \************************************/
/*! exports provided: Rules */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Rules", function() { return Rules; });
/* harmony import */ var pixi_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! pixi.js */ "pixi.js");
/* harmony import */ var pixi_js__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(pixi_js__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var _gdk_core_pixi__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @gdk/core-pixi */ "@gdk/core-pixi");
/* harmony import */ var _gdk_core_pixi__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(_gdk_core_pixi__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var _gdk_core__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @gdk/core */ "@gdk/core");
/* harmony import */ var _gdk_core__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(_gdk_core__WEBPACK_IMPORTED_MODULE_2__);
var __extends = (undefined && undefined.__extends) || (function () {
    var extendStatics = function (d, b) {
        extendStatics = Object.setPrototypeOf ||
            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||
            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };
        return extendStatics(d, b);
    };
    return function (d, b) {
        if (typeof b !== "function" && b !== null)
            throw new TypeError("Class extends value " + String(b) + " is not a constructor or null");
        extendStatics(d, b);
        function __() { this.constructor = d; }
        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
    };
})();
var __values = (undefined && undefined.__values) || function(o) {
    var s = typeof Symbol === "function" && Symbol.iterator, m = s && o[s], i = 0;
    if (m) return m.call(o);
    if (o && typeof o.length === "number") return {
        next: function () {
            if (o && i >= o.length) o = void 0;
            return { value: o && o[i++], done: !o };
        }
    };
    throw new TypeError(s ? "Object is not iterable." : "Symbol.iterator is not defined.");
};



var Rules = /** @class */ (function (_super) {
    __extends(Rules, _super);
    /**
     * Constructor
     */
    function Rules(config) {
        var _this = 
        // PIXI.Container
        _super.call(this) || this;
        _this.loop = false;
        // Protected members
        _this._slides = [];
        _this._currentSlide = null;
        _this.currentBullet = null;
        _this.containerToListen = null;
        /**
         * Listen to touchstart event
         * @param ev: The interaction event data
         */
        _this._onTouchStart = function (ev) {
            _this.touchStartPosition = ev.data.getLocalPosition(_this);
            _this.touchStartTime = Date.now();
        };
        /**
         * Listen to touchend event
         * @param ev: The interaction event data
         */
        _this._onTouchEnd = function (ev) {
            if (_this.touchStartPosition) {
                // DraggEvent disturb "touchstart" propagation, sometimes start is null
                _this.touchEndPosition = ev.data.getLocalPosition(_this);
                var dx = Math.abs(_this.touchStartPosition.x - _this.touchEndPosition.x);
                var dt = Date.now() - _this.touchStartTime;
                var pixelsPerSecond = (1000 * dx) / dt;
                if (pixelsPerSecond > 500) {
                    if (_this.touchStartPosition.x > _this.touchEndPosition.x) {
                        _this.next();
                    }
                    else {
                        _this.previous();
                    }
                }
            }
        };
        // Popup
        if (config.popup instanceof _gdk_core_pixi__WEBPACK_IMPORTED_MODULE_1__["Popup"]) {
            _this.popup = config.popup;
        }
        else {
            _this.popup = new _gdk_core_pixi__WEBPACK_IMPORTED_MODULE_1__["Popup"](config.popup);
        }
        // tracking: closeButton must always be named the same way
        _this.popup.closeButton.setName("rules:close");
        _this.popup.interactive = true;
        _this.popup.doNotExport = true;
        _this.popup.docking = new _gdk_core_pixi__WEBPACK_IMPORTED_MODULE_1__["Docking"](_gdk_core_pixi__WEBPACK_IMPORTED_MODULE_1__["Docking"].centerAll);
        // Next button
        if (config.nextButton instanceof _gdk_core_pixi__WEBPACK_IMPORTED_MODULE_1__["Button"]) {
            _this.nextButton = config.nextButton;
        }
        else {
            _this.nextButton = new _gdk_core_pixi__WEBPACK_IMPORTED_MODULE_1__["Button"](config.nextButton);
        }
        _this.nextButton.doNotExport = true;
        _this.nextButton.docking = new _gdk_core_pixi__WEBPACK_IMPORTED_MODULE_1__["Docking"](_gdk_core_pixi__WEBPACK_IMPORTED_MODULE_1__["Docking"].bottomRight);
        // tracking: nextButon must always be named the same way
        _this.nextButton.setName("rules:next");
        // Previous button
        if (config.previousButton instanceof _gdk_core_pixi__WEBPACK_IMPORTED_MODULE_1__["Button"]) {
            _this.previousButton = config.previousButton;
        }
        else {
            _this.previousButton = new _gdk_core_pixi__WEBPACK_IMPORTED_MODULE_1__["Button"](config.previousButton);
        }
        _this.previousButton.doNotExport = true;
        _this.previousButton.docking = new _gdk_core_pixi__WEBPACK_IMPORTED_MODULE_1__["Docking"](_gdk_core_pixi__WEBPACK_IMPORTED_MODULE_1__["Docking"].bottomLeft);
        _this.previousButton.scaleX = -1;
        // tracking: nextButon must always be named the same way
        _this.previousButton.setName("rules:previous");
        // Bullet
        _this.idleBulletTexture =
            typeof config.bulletPoint.idle === "string"
                ? pixi_js__WEBPACK_IMPORTED_MODULE_0__["Texture"].fromFrame(config.bulletPoint.idle)
                : config.bulletPoint.idle;
        _this.activeBulletTexture =
            typeof config.bulletPoint.active === "string"
                ? pixi_js__WEBPACK_IMPORTED_MODULE_0__["Texture"].fromFrame(config.bulletPoint.active)
                : config.bulletPoint.active;
        _this.bullet = new pixi_js__WEBPACK_IMPORTED_MODULE_0__["Container"]();
        _this.bullet.name = "Bullets";
        _this.bullet.doNotExport = true;
        _this.bullet.docking = new _gdk_core_pixi__WEBPACK_IMPORTED_MODULE_1__["Docking"](_gdk_core_pixi__WEBPACK_IMPORTED_MODULE_1__["Docking"].bottomCenterHorizontal);
        _this.bullet.dockingBounds = new _gdk_core_pixi__WEBPACK_IMPORTED_MODULE_1__["DockingBounds"](0, _this.idleBulletTexture.height);
        _this.bullet.docking.y = -48; // Default vertical position according to the guidelines. Can be overrided
        // Children
        _this.addChild(_this.popup);
        _this.addChild(_this.nextButton);
        _this.addChild(_this.previousButton);
        _this.addChild(_this.bullet);
        // Misc.
        _this.config = config;
        _this.dockingBounds = new _gdk_core_pixi__WEBPACK_IMPORTED_MODULE_1__["DockingBounds"](_this.popup.background.width, _this.popup.background.height);
        // Finish
        _this._bindEvents();
        return _this;
    }
    Object.defineProperty(Rules.prototype, "slides", {
        /**
         * Returns the slides
         */
        get: function () {
            return this._slides;
        },
        enumerable: false,
        configurable: true
    });
    Object.defineProperty(Rules.prototype, "currentSlide", {
        /**
         * Returns the current slide
         */
        get: function () {
            return this._currentSlide;
        },
        /**
         * Sets the current slide
         */
        set: function (slide) {
            if (slide === this._currentSlide) {
                return;
            }
            if (this._currentSlide) {
                this._currentSlide.onHide(this);
            }
            this._currentSlide = slide;
            this._currentSlide.onShow(this);
            // Update bullet
            this.currentBullet.texture = this.idleBulletTexture;
            var index = this._slides.indexOf(this._currentSlide);
            this.currentBullet = this.bullet.children[index];
            this.currentBullet.texture = this.activeBulletTexture;
            // Next and previous buttons
            this.previousButton.visible = index > 0 && this.slides.length > 1;
            this.nextButton.visible = index < this.slides.length - 1 && this.slides.length > 1;
        },
        enumerable: false,
        configurable: true
    });
    /**
     * Adds a slide to the rules popup
     * @param slide the slide to add (can be a custom slide extending Slide)
     */
    Rules.prototype.addSlide = function (slide) {
        if (slide.configure) {
            slide.configure(this);
        }
        this.addChild(slide);
        this._slides.push(slide);
        if (!this._currentSlide) {
            this._currentSlide = slide;
        }
        if (this._slides.length >= 1) {
            slide.visible = false;
        }
        // Add a bullet when precised
        if (slide.hasBullet) {
            this._addBullet();
        }
        // Always add close and next buttons in front of all slides.
        this.addChild(this.previousButton);
        this.addChild(this.nextButton);
    };
    /**
     * Removes the given slide from the rules popup
     * @param slide the slide to remove
     */
    Rules.prototype.removeSlide = function (slide) {
        // Destroy
        if (slide.onDestroy) {
            slide.onDestroy(this);
        }
        this.removeChild(slide);
        var index = this._slides.indexOf(slide);
        if (index !== -1) {
            this._slides.splice(index, 1);
        }
        if (slide === this._currentSlide) {
            this._currentSlide = this._slides[index > this._slides.length ? this._slides.length : index];
            if (this._currentSlide) {
                this._currentSlide.onShow(this);
            }
        }
        // Remove bullet
        if (slide.hasBullet && this.bullet.children.length > 0) {
            this.bullet.children[0].destroy();
            this.bullet.children.forEach(function (c, i) { return (c.x = c.texture.width * i); });
        }
    };
    /**
     * Returns a slide identified by the given name
     * @param name the name of the slide to find
     */
    Rules.prototype.getSlideByName = function (name) {
        var e_1, _a;
        try {
            for (var _b = __values(this.slides), _c = _b.next(); !_c.done; _c = _b.next()) {
                var s = _c.value;
                if (s.name === name) {
                    return s;
                }
            }
        }
        catch (e_1_1) { e_1 = { error: e_1_1 }; }
        finally {
            try {
                if (_c && !_c.done && (_a = _b.return)) _a.call(_b);
            }
            finally { if (e_1) throw e_1.error; }
        }
        return null;
    };
    /**
     * Removes all the slides from the rules component
     */
    Rules.prototype.removeAllSlides = function () {
        while (this._slides.length > 0) {
            this.removeSlide(this._slides[0]);
        }
        this._currentSlide = null;
        // Some slides can hide the close button. Force is to visible
        this.popup.closeButton.visible = true;
    };
    /**
     * Resets the rules component (rollback to first slide)
     */
    Rules.prototype.reset = function () {
        var _this = this;
        // Current slide
        if (this._currentSlide) {
            this._currentSlide.onHide(this);
        }
        this._currentSlide = this._slides[0];
        this._currentSlide.onShow(this);
        // Buttons visibility
        if (this._slides.length > 1) {
            this.previousButton.visible = this.loop;
            this.nextButton.visible = true;
        }
        else {
            this.previousButton.visible = false;
            this.nextButton.visible = false;
        }
        // Bullets
        if (this.bullet.children.length > 0) {
            this.bullet.children.forEach(function (c) { return (c.texture = _this.idleBulletTexture); });
            this.currentBullet = this.bullet.children[0];
            this.currentBullet.texture = this.activeBulletTexture;
        }
        // Reset closeButton to initial texture
        // (on mobile, button keeps hoverTexture when multiple opening/closing of the popup)
        this.popup.closeButton.enabled = true;
        // Always add close and next buttons in front of all slides.
        this.addChild(this.previousButton);
        this.addChild(this.nextButton);
    };
    /**
     * Show the popup with the added slides
     * @param loopMode a tag to set the loop mode through slides
     */
    Rules.prototype.show = function (loopMode) {
        if (loopMode === void 0) { loopMode = false; }
        this.alpha = 1;
        this.loop = loopMode;
        this.reset();
    };
    /**
     * Switch to the specified slide by its index and returns the instance of the next slide
     * @param index The index slide
     * @return the specified slide
     */
    Rules.prototype.changeSlideByIndex = function (index) {
        var currentIndex = this._slides.indexOf(this._currentSlide);
        var isNext = currentIndex + 1 === index;
        var isPrevious = currentIndex - 1 === index;
        if (index < 0) {
            if (!this.loop) {
                return;
            }
            index = this._slides.length - ((Math.abs(index) - 1) % this._slides.length);
        }
        if (index >= this._slides.length) {
            if (!this.loop) {
                return;
            }
            index = index % this._slides.length;
        }
        this._currentSlide.onHide(this);
        this.currentBullet.texture = this.idleBulletTexture;
        this._currentSlide = this._slides[index];
        // Update bullet, next and pervious buttons visibility according to slide index and loop state
        this.previousButton.visible = index > 0 || this.loop;
        this.nextButton.visible = index < this._slides.length - 1 || this.loop;
        if (this._currentSlide.hasBullet) {
            this._updateBulletsTexture(index);
        }
        else {
            this.bullet.visible = false;
        }
        this._currentSlide.onShow(this);
        if (this.onChangeSlide) {
            this.onChangeSlide();
        }
        if (isNext && this.onNext) {
            this.onNext();
        }
        if (isPrevious && this.onPrevious) {
            this.onPrevious();
        }
        return this._currentSlide;
    };
    /**
     * Switches to the next slide and returns the instance of the next slide
     * @return: the next slide
     */
    Rules.prototype.next = function () {
        var index = this._slides.indexOf(this._currentSlide) + 1;
        return this.changeSlideByIndex(index);
    };
    /**
     * Switches to the previous slides and returns the instance of the previous slide
     * @return: the next slide
     */
    Rules.prototype.previous = function () {
        var index = this._slides.indexOf(this._currentSlide) - 1;
        return this.changeSlideByIndex(index);
    };
    /**
     * Closes the rules popup
     */
    Rules.prototype.close = function () {
        if (this.onClose) {
            this.onClose();
        }
    };
    /**
     * Add a bullet point
     */
    Rules.prototype._addBullet = function () {
        var bulletChild = new pixi_js__WEBPACK_IMPORTED_MODULE_0__["Sprite"](this.idleBulletTexture);
        this.bullet.addChild(bulletChild);
        this.bullet.children.forEach(function (c, index) { return (c.x = c.texture.width * index); });
        this.bullet.dockingBounds.width = this.bullet.children.length * this.idleBulletTexture.width;
        if (!this.currentBullet) {
            this.currentBullet = bulletChild;
        }
        // Configure bullet visibility when showing one slide
        this.bullet.visible = this._slides.length > 1;
        this.bullet.pivot.set(0, bulletChild.height / 2);
    };
    /**
     * show bullets while updating its texture
     * @param currentIndex the index of the bullet to be activated
     */
    Rules.prototype._updateBulletsTexture = function (currentIndex) {
        if (this.bullet.children.length > 1) {
            this.bullet.visible = true;
            this.currentBullet = this.bullet.children[currentIndex];
            this.currentBullet.texture = this.activeBulletTexture;
        }
    };
    // Binds the events
    Rules.prototype._bindEvents = function () {
        var _this = this;
        // Close popup
        this.popup.closeButton.on("pointertap", function (e) {
            if (Object(_gdk_core_pixi__WEBPACK_IMPORTED_MODULE_1__["isLeftPointerTap"])(e)) {
                _this.close();
            }
        });
        // Next & previous buttons
        this.nextButton.on("pointertap", function (e) {
            if (Object(_gdk_core_pixi__WEBPACK_IMPORTED_MODULE_1__["isLeftPointerTap"])(e)) {
                _this.next();
            }
        });
        this.previousButton.on("pointertap", function (e) {
            if (Object(_gdk_core_pixi__WEBPACK_IMPORTED_MODULE_1__["isLeftPointerTap"])(e)) {
                _this.previous();
            }
        });
        this.addSwipeListenerToContainer(this.popup);
    };
    /**
     * Add a container to listen for swipe event
     * @param nextContainerToListen: The container to listen
     */
    Rules.prototype.addSwipeListenerToContainer = function (nextContainerToListen) {
        if (nextContainerToListen === void 0) { nextContainerToListen = null; }
        if (this.containerToListen) {
            this.containerToListen.removeListener("touchstart", this._onTouchStart);
            this.containerToListen.removeListener("touchend", this._onTouchEnd);
        }
        this.containerToListen = nextContainerToListen || this.popup;
        this.containerToListen.addListener("touchstart", this._onTouchStart);
        this.containerToListen.addListener("touchend", this._onTouchEnd);
    };
    /**
     * Export the rules component
     */
    Rules.prototype.export = function () {
        // Configure slides
        var slides = [];
        this.slides.forEach(function (s) {
            // Export slide if supported
            if (s.export) {
                s.doNotExport = false;
                slides.push(s.export());
            }
            // Stop export
            s.doNotExport = true;
        });
        // Configure bullets
        this.bullet.children.forEach(function (c) { return (c.doNotExport = true); });
        return _gdk_core__WEBPACK_IMPORTED_MODULE_2__["Tools"].assign(_gdk_core_pixi__WEBPACK_IMPORTED_MODULE_1__["ContainerExporter"].exportContainer(this), {
            type: "rules.Rules",
            popup: this.popup.export(),
            nextButton: this.nextButton.export(),
            previousButton: this.previousButton.export(),
            bulletPoint: {
                config: _gdk_core_pixi__WEBPACK_IMPORTED_MODULE_1__["ContainerExporter"].exportContainer(this.bullet, true),
                idle: _gdk_core_pixi__WEBPACK_IMPORTED_MODULE_1__["TextureExporter"].exportTexture(this.idleBulletTexture),
                active: _gdk_core_pixi__WEBPACK_IMPORTED_MODULE_1__["TextureExporter"].exportTexture(this.activeBulletTexture),
            },
            slides: slides,
        });
    };
    /**
     * Parses the rules component
     * @param config the serialized data
     * @param baseUrl the base url of the loader
     */
    Rules.parse = function (config, baseUrl, rules) {
        // Rules
        if (!rules) {
            rules = new Rules({
                popup: new _gdk_core_pixi__WEBPACK_IMPORTED_MODULE_1__["Popup"](),
                nextButton: new _gdk_core_pixi__WEBPACK_IMPORTED_MODULE_1__["Button"]({}, config.nextButton.textStyle, config.nextButton.text),
                previousButton: new _gdk_core_pixi__WEBPACK_IMPORTED_MODULE_1__["Button"]({}, config.previousButton.textStyle, config.previousButton.text),
                bulletPoint: {
                    idle: pixi_js__WEBPACK_IMPORTED_MODULE_0__["Texture"].WHITE,
                    active: pixi_js__WEBPACK_IMPORTED_MODULE_0__["Texture"].WHITE,
                },
            });
        }
        _gdk_core_pixi__WEBPACK_IMPORTED_MODULE_1__["Popup"].parse(config.popup, baseUrl, rules.popup);
        _gdk_core_pixi__WEBPACK_IMPORTED_MODULE_1__["Button"].parse(config.nextButton, baseUrl, rules.nextButton);
        _gdk_core_pixi__WEBPACK_IMPORTED_MODULE_1__["Button"].parse(config.previousButton, baseUrl, rules.previousButton);
        rules.idleBulletTexture = _gdk_core_pixi__WEBPACK_IMPORTED_MODULE_1__["TextureImporter"].importTexture(config.bulletPoint.idle, baseUrl, rules, "idleBulletTexture");
        rules.activeBulletTexture = _gdk_core_pixi__WEBPACK_IMPORTED_MODULE_1__["TextureImporter"].importTexture(config.bulletPoint.active, baseUrl, rules, "activeBulletTexture");
        if (config.bulletPoint.config) {
            _gdk_core_pixi__WEBPACK_IMPORTED_MODULE_1__["ContainerImporter"].importContainer(config.bulletPoint.config, baseUrl, rules.bullet);
        }
        // Docking bounds
        rules.dockingBounds = rules.popup.dockingBounds.clone();
        // Slides
        config.slides.forEach(function (s) {
            var slide = _gdk_core_pixi__WEBPACK_IMPORTED_MODULE_1__["ContainerImporter"].import(s, baseUrl);
            rules.addSlide(slide);
        });
        // Reset
        if (rules.slides.length > 0) {
            rules.reset();
        }
        return rules;
    };
    return Rules;
}(pixi_js__WEBPACK_IMPORTED_MODULE_0__["Container"]));



/***/ }),

/***/ "./src/game/ui/rules/slide.ts":
/*!************************************!*\
  !*** ./src/game/ui/rules/slide.ts ***!
  \************************************/
/*! exports provided: Slide */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Slide", function() { return Slide; });
/* harmony import */ var pixi_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! pixi.js */ "pixi.js");
/* harmony import */ var pixi_js__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(pixi_js__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var _gdk_core__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @gdk/core */ "@gdk/core");
/* harmony import */ var _gdk_core__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(_gdk_core__WEBPACK_IMPORTED_MODULE_1__);
var __extends = (undefined && undefined.__extends) || (function () {
    var extendStatics = function (d, b) {
        extendStatics = Object.setPrototypeOf ||
            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||
            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };
        return extendStatics(d, b);
    };
    return function (d, b) {
        if (typeof b !== "function" && b !== null)
            throw new TypeError("Class extends value " + String(b) + " is not a constructor or null");
        extendStatics(d, b);
        function __() { this.constructor = d; }
        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
    };
})();


var Slide = /** @class */ (function (_super) {
    __extends(Slide, _super);
    /**
     * Constructor
     */
    function Slide() {
        var _this = 
        // PIXI.Container
        _super.call(this) || this;
        // Public members
        _this.hasBullet = true;
        return _this;
    }
    /**
     * Configures the slide in the given popup
     * @param rules the popup containing the slide
     */
    Slide.prototype.configure = function (rules) {
        // Empty. Can be overriden
    };
    /**
     * Called when showing the slide in the rules popup
     */
    Slide.prototype.onShow = function (rules) {
        if (this.visible) {
            return;
        }
        this.visible = true;
        _gdk_core__WEBPACK_IMPORTED_MODULE_1__["tracker"].track(new _gdk_core__WEBPACK_IMPORTED_MODULE_1__["SlideEvent"](this.getName(), _gdk_core__WEBPACK_IMPORTED_MODULE_1__["ESlideEvent"].Show));
    };
    /**
     * Called when hiding the slide in the rules popup
     */
    Slide.prototype.onHide = function (rules) {
        if (!this.visible) {
            return;
        }
        _gdk_core__WEBPACK_IMPORTED_MODULE_1__["tracker"].track(new _gdk_core__WEBPACK_IMPORTED_MODULE_1__["SlideEvent"](this.getName(), _gdk_core__WEBPACK_IMPORTED_MODULE_1__["ESlideEvent"].Hide));
        this.visible = false;
    };
    /**
     * On destroy the slide
     */
    Slide.prototype.onDestroy = function (rules) {
        return;
    };
    return Slide;
}(pixi_js__WEBPACK_IMPORTED_MODULE_0__["Container"]));



/***/ }),

/***/ "./src/game/ui/rules/textSlide.ts":
/*!****************************************!*\
  !*** ./src/game/ui/rules/textSlide.ts ***!
  \****************************************/
/*! exports provided: ELayout, getSlideStylePaddingValue, TextSlide */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ELayout", function() { return ELayout; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "getSlideStylePaddingValue", function() { return getSlideStylePaddingValue; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "TextSlide", function() { return TextSlide; });
/* harmony import */ var pixi_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! pixi.js */ "pixi.js");
/* harmony import */ var pixi_js__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(pixi_js__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var _gdk_core_pixi__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @gdk/core-pixi */ "@gdk/core-pixi");
/* harmony import */ var _gdk_core_pixi__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(_gdk_core_pixi__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var _gdk_core__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @gdk/core */ "@gdk/core");
/* harmony import */ var _gdk_core__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(_gdk_core__WEBPACK_IMPORTED_MODULE_2__);
/* harmony import */ var _slide__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./slide */ "./src/game/ui/rules/slide.ts");
var __extends = (undefined && undefined.__extends) || (function () {
    var extendStatics = function (d, b) {
        extendStatics = Object.setPrototypeOf ||
            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||
            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };
        return extendStatics(d, b);
    };
    return function (d, b) {
        if (typeof b !== "function" && b !== null)
            throw new TypeError("Class extends value " + String(b) + " is not a constructor or null");
        extendStatics(d, b);
        function __() { this.constructor = d; }
        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
    };
})();




var ELayout;
(function (ELayout) {
    ELayout[ELayout["TextLeft"] = 0] = "TextLeft";
    ELayout[ELayout["TextTop"] = 1] = "TextTop";
    ELayout[ELayout["TextPadding"] = 2] = "TextPadding";
})(ELayout || (ELayout = {}));
var getSlideStylePaddingValue = function (value, slide) {
    switch (typeof value) {
        case "number":
            return value;
        case "function":
            return value(slide);
        default:
            return 0;
    }
};
var TextSlide = /** @class */ (function (_super) {
    __extends(TextSlide, _super);
    /**
     * Constructor
     * @param config: the slide's style
     */
    function TextSlide(config) {
        if (config === void 0) { config = {}; }
        var _this = 
        // PIXI.Container
        _super.call(this) || this;
        // Protected members
        _this.textPadding = {};
        _this.titlePadding = {};
        // Setup slide's configuration (style)
        _this.config = config;
        return _this;
    }
    Object.defineProperty(TextSlide.prototype, "config", {
        /**
         * Sets the slide text style (config)
         */
        set: function (config) {
            // Title
            if (this.title) {
                this.title.destroy();
            }
            config.title = config.title || {};
            if (typeof config.title === "string") {
                // Title is a sprite texture name
                this.title = pixi_js__WEBPACK_IMPORTED_MODULE_0__["Sprite"].fromFrame(config.title);
            }
            else if (config.title instanceof pixi_js__WEBPACK_IMPORTED_MODULE_0__["Sprite"]) {
                // Title is a sprite
                this.title = config.title;
            }
            else {
                // Title is a text field
                this.title = new _gdk_core_pixi__WEBPACK_IMPORTED_MODULE_1__["TextArea"](config.title.text || "", config.title.style || {
                    default: {
                        fontName: "Arial",
                    },
                }, {
                    align: config.title.align === undefined ? _gdk_core_pixi__WEBPACK_IMPORTED_MODULE_1__["EAlign"].Center : config.title.align,
                });
                this.title.wordWrap = true;
                this.titlePadding = _gdk_core__WEBPACK_IMPORTED_MODULE_2__["Tools"].assign(this.titlePadding, config.title.padding);
            }
            this.title.name = "title";
            this.title.docking = new _gdk_core_pixi__WEBPACK_IMPORTED_MODULE_1__["Docking"](_gdk_core_pixi__WEBPACK_IMPORTED_MODULE_1__["Docking"].centerHorizontal);
            this.addChild(this.title);
            // Text-field
            if (this.text) {
                this.text.destroy();
            }
            config.text = config.text || {};
            this.text = new _gdk_core_pixi__WEBPACK_IMPORTED_MODULE_1__["TextArea"](config.text.text || "", config.text.style || {
                default: {
                    fontName: "Arial",
                },
            }, {
                align: config.text.align === undefined ? _gdk_core_pixi__WEBPACK_IMPORTED_MODULE_1__["EAlign"].Center : config.text.align,
            });
            this.text.name = "text";
            this.text.wordWrap = true;
            this.text.docking = new _gdk_core_pixi__WEBPACK_IMPORTED_MODULE_1__["Docking"](_gdk_core_pixi__WEBPACK_IMPORTED_MODULE_1__["Docking"].centerAll);
            this.addChild(this.text);
            this.textPadding = _gdk_core__WEBPACK_IMPORTED_MODULE_2__["Tools"].assign(this.textPadding, config.text.padding);
            // Image
            if (this.image) {
                this.image.destroy();
            }
            if (config.image) {
                this.image = typeof config.image === "string" ? pixi_js__WEBPACK_IMPORTED_MODULE_0__["Sprite"].fromFrame(config.image) : config.image;
                this.image.docking = new _gdk_core_pixi__WEBPACK_IMPORTED_MODULE_1__["Docking"](_gdk_core_pixi__WEBPACK_IMPORTED_MODULE_1__["Docking"].centerAll);
                this.addChild(this.image);
            }
            this.layout = config.layout || ELayout.TextLeft;
            if (config.hasBullet !== undefined) {
                this.hasBullet = config.hasBullet;
            }
        },
        enumerable: false,
        configurable: true
    });
    /**
     * Configures the slide in the given popup
     * @param popup the popup containing the slide
     */
    TextSlide.prototype.configure = function (rules) {
        // Misc.
        this.dockingBounds = new _gdk_core_pixi__WEBPACK_IMPORTED_MODULE_1__["DockingBounds"](rules.dockingBounds.width, rules.dockingBounds.height);
        // Title
        this.title.y = 15;
        switch (this.layout) {
            case ELayout.TextLeft:
                // Image
                if (this.image) {
                    this.image.docking.x = this.dockingBounds.width / 4;
                }
                // Text
                this.text.docking.x = this.image ? -this.dockingBounds.width / 4 + 20 : 0;
                this.text.width = this.image
                    ? this.dockingBounds.width / 2 - 20
                    : this.dockingBounds.width - 40;
                break;
            case ELayout.TextTop:
                // both text and image are centered horizontally
                // image is set bellow the text
                this.text.width = Math.min(this.text.width, this.dockingBounds.width - 40);
                this.text.docking.y = -this.dockingBounds.height / 4 + 10;
                if (this.image) {
                    this.image.docking.y = this.dockingBounds.height / 4 - 40;
                }
                break;
            case ELayout.TextPadding:
                // apply padding on title and remove docking;
                delete this.title.docking;
                if (this.titlePadding.left !== undefined || this.titlePadding.right !== undefined) {
                    this.title.x = getSlideStylePaddingValue(this.titlePadding.left, this);
                    this.title.width =
                        this.dockingBounds.width -
                            (getSlideStylePaddingValue(this.titlePadding.right, this) + this.title.x);
                }
                if (this.titlePadding.top !== undefined || this.titlePadding.bottom !== undefined) {
                    this.title.y = getSlideStylePaddingValue(this.titlePadding.top, this);
                    this.title.height =
                        this.dockingBounds.height -
                            (getSlideStylePaddingValue(this.titlePadding.bottom, this) + this.title.y);
                }
                // apply padding on text (center all);
                delete this.text.docking;
                if (this.textPadding.left !== undefined || this.titlePadding.right !== undefined) {
                    this.text.x = getSlideStylePaddingValue(this.textPadding.left, this);
                    this.text.width =
                        this.dockingBounds.width -
                            (getSlideStylePaddingValue(this.textPadding.right, this) + this.text.x);
                }
                if (this.textPadding.top !== undefined || this.textPadding.bottom !== undefined) {
                    this.text.y = getSlideStylePaddingValue(this.textPadding.top, this);
                    this.text.height =
                        this.dockingBounds.height -
                            (getSlideStylePaddingValue(this.textPadding.bottom, this) + this.text.y);
                }
                break;
        }
    };
    /**
     * Called when showing the slide in the rules popup
     */
    TextSlide.prototype.onShow = function (rules) {
        _super.prototype.onShow.call(this, rules);
    };
    /**
     * Called when hiding the slide in the rules popup
     */
    TextSlide.prototype.onHide = function (rules) {
        _super.prototype.onHide.call(this, rules);
    };
    return TextSlide;
}(_slide__WEBPACK_IMPORTED_MODULE_3__["Slide"]));



/***/ }),

/***/ "./src/game/wizz/index.ts":
/*!********************************!*\
  !*** ./src/game/wizz/index.ts ***!
  \********************************/
/*! exports provided: EAvatarStatus */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "EAvatarStatus", function() { return EAvatarStatus; });
var EAvatarStatus;
(function (EAvatarStatus) {
    EAvatarStatus[EAvatarStatus["quit"] = 0] = "quit";
    EAvatarStatus[EAvatarStatus["pending"] = 1] = "pending";
    EAvatarStatus[EAvatarStatus["ready"] = 2] = "ready";
    EAvatarStatus[EAvatarStatus["none"] = 3] = "none";
})(EAvatarStatus || (EAvatarStatus = {}));


/***/ }),

/***/ "./src/index.ts":
/*!**********************!*\
  !*** ./src/index.ts ***!
  \**********************/
/*! exports provided: Com, Popin, EPopinLevel, PopinButtonAction, PopinLinkTarget, EMessageType, MessageManager, AbstractGame, EGameEvents, Express, Ticket, ETicketMode, ETicketStatus, EBetResponseAction, Action, MotorsModel, MotorsSession, ESessionMode, Multipass, MultipassSession, MultipassNotifications, EMultipassGameState, EMultipassNotificationType, TweenUtils, Rules, Slide, TextSlide, ELayout, BaseSlide, AgreementSlide, Home, ResultBox, EResultBoxEvents, ResultStage, ScratchStage, TextResultStage, AmountResultStage, Timer, CrossSell, EAvatarStatus, Inactivity, Carousel, ProjectLoader, BehaviorCodeExtension, AdaptativeVisualIdentity, EVisualIdentityEvent, EVisualIdentityAction, MessagePopin, EGameStates, DSPopinsContainer, VERSION */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "VERSION", function() { return VERSION; });
/* harmony import */ var _com__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./com */ "./src/com/index.ts");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "Com", function() { return _com__WEBPACK_IMPORTED_MODULE_0__["Com"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "Popin", function() { return _com__WEBPACK_IMPORTED_MODULE_0__["Popin"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "EPopinLevel", function() { return _com__WEBPACK_IMPORTED_MODULE_0__["EPopinLevel"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "PopinButtonAction", function() { return _com__WEBPACK_IMPORTED_MODULE_0__["PopinButtonAction"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "PopinLinkTarget", function() { return _com__WEBPACK_IMPORTED_MODULE_0__["PopinLinkTarget"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "EMessageType", function() { return _com__WEBPACK_IMPORTED_MODULE_0__["EMessageType"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "MessageManager", function() { return _com__WEBPACK_IMPORTED_MODULE_0__["MessageManager"]; });

/* harmony import */ var _game__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./game */ "./src/game/index.ts");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "AbstractGame", function() { return _game__WEBPACK_IMPORTED_MODULE_1__["AbstractGame"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "EGameEvents", function() { return _game__WEBPACK_IMPORTED_MODULE_1__["EGameEvents"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "Express", function() { return _game__WEBPACK_IMPORTED_MODULE_1__["Express"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "Ticket", function() { return _game__WEBPACK_IMPORTED_MODULE_1__["Ticket"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "ETicketMode", function() { return _game__WEBPACK_IMPORTED_MODULE_1__["ETicketMode"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "ETicketStatus", function() { return _game__WEBPACK_IMPORTED_MODULE_1__["ETicketStatus"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "EBetResponseAction", function() { return _game__WEBPACK_IMPORTED_MODULE_1__["EBetResponseAction"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "Action", function() { return _game__WEBPACK_IMPORTED_MODULE_1__["Action"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "MotorsModel", function() { return _game__WEBPACK_IMPORTED_MODULE_1__["MotorsModel"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "MotorsSession", function() { return _game__WEBPACK_IMPORTED_MODULE_1__["MotorsSession"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "ESessionMode", function() { return _game__WEBPACK_IMPORTED_MODULE_1__["ESessionMode"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "Multipass", function() { return _game__WEBPACK_IMPORTED_MODULE_1__["Multipass"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "MultipassSession", function() { return _game__WEBPACK_IMPORTED_MODULE_1__["MultipassSession"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "MultipassNotifications", function() { return _game__WEBPACK_IMPORTED_MODULE_1__["MultipassNotifications"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "EMultipassGameState", function() { return _game__WEBPACK_IMPORTED_MODULE_1__["EMultipassGameState"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "EMultipassNotificationType", function() { return _game__WEBPACK_IMPORTED_MODULE_1__["EMultipassNotificationType"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "TweenUtils", function() { return _game__WEBPACK_IMPORTED_MODULE_1__["TweenUtils"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "Rules", function() { return _game__WEBPACK_IMPORTED_MODULE_1__["Rules"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "Slide", function() { return _game__WEBPACK_IMPORTED_MODULE_1__["Slide"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "TextSlide", function() { return _game__WEBPACK_IMPORTED_MODULE_1__["TextSlide"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "ELayout", function() { return _game__WEBPACK_IMPORTED_MODULE_1__["ELayout"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "BaseSlide", function() { return _game__WEBPACK_IMPORTED_MODULE_1__["BaseSlide"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "AgreementSlide", function() { return _game__WEBPACK_IMPORTED_MODULE_1__["AgreementSlide"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "Home", function() { return _game__WEBPACK_IMPORTED_MODULE_1__["Home"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "ResultBox", function() { return _game__WEBPACK_IMPORTED_MODULE_1__["ResultBox"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "EResultBoxEvents", function() { return _game__WEBPACK_IMPORTED_MODULE_1__["EResultBoxEvents"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "ResultStage", function() { return _game__WEBPACK_IMPORTED_MODULE_1__["ResultStage"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "ScratchStage", function() { return _game__WEBPACK_IMPORTED_MODULE_1__["ScratchStage"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "TextResultStage", function() { return _game__WEBPACK_IMPORTED_MODULE_1__["TextResultStage"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "AmountResultStage", function() { return _game__WEBPACK_IMPORTED_MODULE_1__["AmountResultStage"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "Timer", function() { return _game__WEBPACK_IMPORTED_MODULE_1__["Timer"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "CrossSell", function() { return _game__WEBPACK_IMPORTED_MODULE_1__["CrossSell"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "EAvatarStatus", function() { return _game__WEBPACK_IMPORTED_MODULE_1__["EAvatarStatus"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "Inactivity", function() { return _game__WEBPACK_IMPORTED_MODULE_1__["Inactivity"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "Carousel", function() { return _game__WEBPACK_IMPORTED_MODULE_1__["Carousel"]; });

/* harmony import */ var _loading__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./loading */ "./src/loading/index.ts");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "ProjectLoader", function() { return _loading__WEBPACK_IMPORTED_MODULE_2__["ProjectLoader"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "BehaviorCodeExtension", function() { return _loading__WEBPACK_IMPORTED_MODULE_2__["BehaviorCodeExtension"]; });

/* harmony import */ var _adaptativeVisualIdentity__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./adaptativeVisualIdentity */ "./src/adaptativeVisualIdentity/index.ts");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "AdaptativeVisualIdentity", function() { return _adaptativeVisualIdentity__WEBPACK_IMPORTED_MODULE_3__["AdaptativeVisualIdentity"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "EVisualIdentityEvent", function() { return _adaptativeVisualIdentity__WEBPACK_IMPORTED_MODULE_3__["EVisualIdentityEvent"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "EVisualIdentityAction", function() { return _adaptativeVisualIdentity__WEBPACK_IMPORTED_MODULE_3__["EVisualIdentityAction"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "MessagePopin", function() { return _adaptativeVisualIdentity__WEBPACK_IMPORTED_MODULE_3__["MessagePopin"]; });

/* harmony import */ var _ds__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./ds */ "./src/ds/index.ts");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "EGameStates", function() { return _ds__WEBPACK_IMPORTED_MODULE_4__["EGameStates"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "DSPopinsContainer", function() { return _ds__WEBPACK_IMPORTED_MODULE_4__["DSPopinsContainer"]; });






var VERSION = "3.6.4";


/***/ }),

/***/ "./src/loading/extensions/behaviorCode.ts":
/*!************************************************!*\
  !*** ./src/loading/extensions/behaviorCode.ts ***!
  \************************************************/
/*! exports provided: BehaviorCodeExtension */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "BehaviorCodeExtension", function() { return BehaviorCodeExtension; });
/* harmony import */ var _gdk_core__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @gdk/core */ "@gdk/core");
/* harmony import */ var _gdk_core__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_gdk_core__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var _gdk_core_pixi__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @gdk/core-pixi */ "@gdk/core-pixi");
/* harmony import */ var _gdk_core_pixi__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(_gdk_core_pixi__WEBPACK_IMPORTED_MODULE_1__);


// Template
var template = "\nvar require = SystemJS.amdRequire;\nvar exports = {};\n{{code}}\nSystemJS.set(\"{{id}}\", SystemJS.newModule(exports));\n";
var BehaviorCodeExtension = /** @class */ (function () {
    function BehaviorCodeExtension() {
    }
    /**
     * Applies the behavior code extension on the given container
     * @param game the game reference containing the behavior scripts
     * @param project the project JSON reference
     * @param container the container having scripts attached
     */
    BehaviorCodeExtension.apply = function (game, project, container) {
        var data = project.metadata[this.id];
        if (!data) {
            return;
        }
        var references = container.metadata[this.id];
        if (!references) {
            return;
        }
        // Apply all references
        var instances = [];
        references.forEach(function (r) {
            if (!r.active) {
                return;
            }
            var script = data.scripts.find(function (s) { return s.id === r.id; });
            if (!script) {
                return;
            }
            // Inject script
            _gdk_core__WEBPACK_IMPORTED_MODULE_0__["Tools"].injectScript(template.replace("{{id}}", script.id).replace("{{code}}", script.compiledCode), script.name, "scripts");
            // Get constructor then instantiate
            var exports = _gdk_core__WEBPACK_IMPORTED_MODULE_0__["Tools"].getScript(script.id);
            instances.push(new exports.default(container, _gdk_core_pixi__WEBPACK_IMPORTED_MODULE_1__["AssetStore"]));
            // The container is ready
            container.emit("ready");
        });
        // Register the update event
        game.application.emitter.on("beforeRender", function () { return container.emit("update"); });
    };
    /**
     * The id of the behavior code extension
     */
    BehaviorCodeExtension.id = "behaviorCode";
    return BehaviorCodeExtension;
}());



/***/ }),

/***/ "./src/loading/index.ts":
/*!******************************!*\
  !*** ./src/loading/index.ts ***!
  \******************************/
/*! exports provided: ProjectLoader, BehaviorCodeExtension */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _projectLoader__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./projectLoader */ "./src/loading/projectLoader.ts");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "ProjectLoader", function() { return _projectLoader__WEBPACK_IMPORTED_MODULE_0__["ProjectLoader"]; });

/* harmony import */ var _extensions_behaviorCode__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./extensions/behaviorCode */ "./src/loading/extensions/behaviorCode.ts");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "BehaviorCodeExtension", function() { return _extensions_behaviorCode__WEBPACK_IMPORTED_MODULE_1__["BehaviorCodeExtension"]; });






/***/ }),

/***/ "./src/loading/projectLoader.ts":
/*!**************************************!*\
  !*** ./src/loading/projectLoader.ts ***!
  \**************************************/
/*! exports provided: ProjectLoader */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ProjectLoader", function() { return ProjectLoader; });
/* harmony import */ var _gdk_core_pixi__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @gdk/core-pixi */ "@gdk/core-pixi");
/* harmony import */ var _gdk_core_pixi__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_gdk_core_pixi__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var ___WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../ */ "./src/index.ts");
/* harmony import */ var ___WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! . */ "./src/loading/index.ts");
/* eslint-disable import/no-duplicates */






var ProjectLoader = /** @class */ (function () {
    function ProjectLoader() {
    }
    /**
     * Load the given project
     * @param game the game reference, typically a GamePixi
     * @param project the project's configuration
     * @param baseUrl the base url of the loader
     * @param viewMap the viewmap to map views with states
     */
    ProjectLoader.load = function (game, project, baseUrl, viewMap) {
        var _this = this;
        if (viewMap === void 0) { viewMap = {}; }
        // Assets
        _gdk_core_pixi__WEBPACK_IMPORTED_MODULE_0__["AssetStore"].parse(project.assets, baseUrl);
        // Customize container creator
        _gdk_core_pixi__WEBPACK_IMPORTED_MODULE_0__["ContainerImporter"].customContainerCreator = function (config, container) {
            return _this.customContainerLoader(config, baseUrl, container, project);
        };
        // Custom customizer is now commented as it is not used for instance
        _gdk_core_pixi__WEBPACK_IMPORTED_MODULE_0__["ContainerImporter"].customContainerCustomizer = function (config, container) {
            _this.customContainerCustomizer(game, config, container, baseUrl, project);
        };
        // Import project
        _gdk_core_pixi__WEBPACK_IMPORTED_MODULE_0__["ProjectImporter"].importProject(game, project, baseUrl, viewMap);
    };
    /**
     * Function that customizes the given container according to its metadatas
     * @param config the container's configuration
     * @param container the currently customized container
     * @param baseUrl the base url of the loader
     * @param project the project JSON data (source data)
     */
    ProjectLoader.customContainerCustomizer = function (game, config, container, baseUrl, project) {
        if (!container.metadata) {
            return;
        }
        if (project.metadata) {
            // Behavior code extension requires metadatas on game (scripts collection)
            ___WEBPACK_IMPORTED_MODULE_2__["BehaviorCodeExtension"].apply(game, project, container);
        }
    };
    /**
     * Custom loader for loading custom containers like ui.TextField etc.
     * @param config the container's configuration
     * @param baseUrl the base url of the loader
     * @param container the currently created container
     * @param project the project JSON data (source data)
     */
    ProjectLoader.customContainerLoader = function (config, baseUrl, container, project) {
        var split = config.type.split(".");
        if (split.length === 1) {
            return null;
        }
        var c = null;
        // Create
        switch (split[0]) {
            case "ui":
                c = _gdk_core_pixi__WEBPACK_IMPORTED_MODULE_0__[split[1]].parse(config, baseUrl, container, project);
                break;
            case "result":
                c = ___WEBPACK_IMPORTED_MODULE_1__[split[1]].parse(config, baseUrl);
                break;
            case "rules":
                c = ___WEBPACK_IMPORTED_MODULE_1__[split[1]].parse(config, baseUrl, container, project);
                break;
            case "spine":
                c = _gdk_core_pixi__WEBPACK_IMPORTED_MODULE_0__[split[1]].parse(config, baseUrl);
                break;
            case "proton":
                c = _gdk_core_pixi__WEBPACK_IMPORTED_MODULE_0__[split[1]].parse(config, baseUrl);
                break;
            default:
                break;
        }
        // Return
        return c;
    };
    return ProjectLoader;
}());



/***/ }),

/***/ "@falcon/bridge":
/*!*************************!*\
  !*** external "falcon" ***!
  \*************************/
/*! no static exports found */
/***/ (function(module, exports) {

module.exports = require("falcon");

/***/ }),

/***/ "@gdk/core":
/*!****************************!*\
  !*** external "@gdk/core" ***!
  \****************************/
/*! no static exports found */
/***/ (function(module, exports) {

module.exports = require("@gdk/core");

/***/ }),

/***/ "@gdk/core-pixi":
/*!*********************************!*\
  !*** external "@gdk/core-pixi" ***!
  \*********************************/
/*! no static exports found */
/***/ (function(module, exports) {

module.exports = require("@gdk/core-pixi");

/***/ }),

/***/ "gsap":
/*!***********************!*\
  !*** external "gsap" ***!
  \***********************/
/*! no static exports found */
/***/ (function(module, exports) {

module.exports = require("gsap");

/***/ }),

/***/ "howler":
/*!*************************!*\
  !*** external "howler" ***!
  \*************************/
/*! no static exports found */
/***/ (function(module, exports) {

module.exports = require("howler");

/***/ }),

/***/ "i18next":
/*!**************************!*\
  !*** external "i18next" ***!
  \**************************/
/*! no static exports found */
/***/ (function(module, exports) {

module.exports = require("i18next");

/***/ }),

/***/ "pixi.js":
/*!**************************!*\
  !*** external "pixi.js" ***!
  \**************************/
/*! no static exports found */
/***/ (function(module, exports) {

module.exports = require("pixi.js");

/***/ })

/******/ });
//# sourceMappingURL=gamekit.bundle.js.map