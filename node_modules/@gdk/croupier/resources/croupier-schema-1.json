{
	"$schema": "http://json-schema.org/draft-07/schema#",
	"type": "object",
	"title": "variant-model",
	"version": "1",
	"description": "Schema describing the model of a game variant",
	"definitions": {
		"Id": {
			"type": "integer",
			"title": "id",
			"description": "Id as a number used to easily identify an object (rank, ticket)",
			"minimum": 0
		},
		"Description": {
			"type": "string",
			"title": "Product description",
			"description": "Text used to describe the current product",
			"maxLength": 8192
		},
		"Version": {
			"type": "integer",
			"description": "Semver versionning"
		},
		"RankWinFactor": {
			"type": "object",
			"title": "Win factor",
			"description": "Composed of a numerator and a denominator it represent the win factor for a rank given the formula win = stake*factor.num/factor.den. Be carefull that win must always be an integer.",
			"properties": {
				"numerator": {
					"type": "integer",
					"title": "Factor numerator",
					"description": "Win factor numerator",
					"minimum": 0,
					"maximum": 1000000000
				},
				"denominator": {
					"type": "integer",
					"title": "Factor denominator",
					"description": "Win factor denominator",
					"minimum": 1,
					"maximum": 1000000000
				}
			},
			"required": ["numerator", "denominator"]
		},
		"Quantity": {
			"type": "integer",
			"description": "Quantity",
			"minimum": 0
		},
		"TicketMetadatas": {
			"type": "object",
			"title": "Ticket metadata",
			"description": "User defined metadata",
			"properties": {
				"shape": {
					"type": "string"
				}
			},
			"additionalProperties": {
				"anyOf": [
					{
						"type": "string"
					},
					{
						"type": "boolean"
					},
					{
						"type": "number"
					}
				]
			},
			"required": ["shape"]
		},
		"TicketCustomDatas": {
			"type": "object",
			"title": "Ticket custom datas",
			"description": "User defined private datas",
			"properties": {}
		},
		"Ticket": {
			"type": "object",
			"title": "Ticket description",
			"description": "Information relative to a ticket",
			"properties": {
				"id": {
					"type": "number"
				},
				"symbol": {
					"type": "string"
				},
				"quantity": {
					"$ref": "#/definitions/Quantity"
				},
				"metadatas": {
					"$ref": "#/definitions/TicketMetadatas"
				},
				"customdatas": {
					"$ref": "#/definitions/TicketCustomDatas"
				},
				"bonus": {
					"type": "boolean"
				},
				"tv": {
					"type": "boolean"
				},
				"extra": {
					"type": "boolean"
				}
			},
			"required": ["symbol", "quantity"],
			"additionalProperties": false
		},
		"Rank": {
			"type": "object",
			"title": "Rank description",
			"description": "Information relative to a rank",
			"properties": {
				"id": {
					"$ref": "#/definitions/Id"
				},
				"factor": {
					"$ref": "#/definitions/RankWinFactor"
				},
				"renewal": {
					"type": ["number", "null"],
					"description": "optionnal rank renewal, a new pool will be generated each time the number of ticket for this rank reach less than this number"
				},
				"tickets": {
					"type": "array",
					"items": {
						"$ref": "#/definitions/Ticket"
					},
					"minItems": 0,
					"uniqueItems": true
				},
				"quantity": {
					"$ref": "#/definitions/Quantity"
				},
				"prizeType": {
					"type": ["string"]
				},
				"prizeDescription": {
					"type": ["string"]
				}
			},
			"required": ["id", "factor", "tickets"],
			"additionalProperties": false
		}
	},
	"properties": {
		"schemaVersion": {
			"$ref": "#/definitions/Version"
		},
		"productName": {
			"type": "string"
		},
		"productVersion": {
			"type": "string"
		},
		"version": {
			"$ref": "#/definitions/Version"
		},
		"masterGameCode": {
			"type": "string",
			"description": "Name of the master game this dealer is made for."
		},
		"code": {
			"type": "string",
			"description": "Internal ITG engine game code"
		},
		"description": {
			"$ref": "#/definitions/Description"
		},
		"baseStake": {
			"type": "integer",
			"description": "smaller stake value threshold. Every stake which is a multiple of this value is allowed as a betValue"
		},
		"renewal": {
			"type": "integer"
		},
		"ranks": {
			"type": "array",
			"items": {
				"$ref": "#/definitions/Rank"
			},
			"minItems": 1,
			"uniqueItems": true
		},
		"seed": {
			"type": "string"
		}
	},
	"additionalProperties": true,
	"required": [
		"productName",
		"productVersion",
		"masterGameCode",
		"code",
		"version",
		"description",
		"schemaVersion",
		"baseStake",
		"renewal",
		"ranks"
	]
}
